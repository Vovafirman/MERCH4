<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="icon" type="image/svg+xml" href="favicoin/fovicoin.svg">
    <link rel="shortcut icon" type="image/svg+xml" href="favicoin/fovicoin.svg">
    <title>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å - –¶–µ–Ω—Ç—Ä –ö–∏–Ω–æ‚Ñ¢ v2.6 (–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ê)</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∏—Ç—å –≤ <head> –ü–ï–†–ï–î –Ω–∞—à–∏–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö: admin.html, catalog.html, product.html -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
      // –í–°–¢–ê–í–¨ –°–Æ–î–ê —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è:
      const SUPABASE_URL  = "https://YOUR_PROJECT_ID.supabase.co";
      const SUPABASE_ANON = "YOUR_PUBLIC_ANON_KEY";

      window.supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="init-products.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ —Ç–æ–≤–∞—Ä—ã –≤ localStorage
            const existingProducts = localStorage.getItem('products');
            if (!existingProducts) {
                console.log('–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ localStorage, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º...');
                // –ï—Å–ª–∏ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ—Ç, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏—Ö
                if (typeof testProducts !== 'undefined') {
                    localStorage.setItem('products', JSON.stringify(testProducts));
                    console.log('–¢–æ–≤–∞—Ä—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã:', testProducts.length, '—à—Ç.');
                } else {
                    console.error('testProducts –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã!');
                }
            } else {
                console.log('–¢–æ–≤–∞—Ä—ã —É–∂–µ –µ—Å—Ç—å –≤ localStorage');
            }
        });

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ Chart.js
        window.addEventListener('load', function() {
            if (typeof Chart === 'undefined') {
                console.error('Chart.js –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω! –ü–æ–ø—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π CDN...');
                // –ü–æ–ø—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π CDN
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js';
                script.onload = function() {
                    console.log('Chart.js –∑–∞–≥—Ä—É–∂–µ–Ω —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ CDN');
                };
                script.onerror = function() {
                    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å Chart.js');
                };
                document.head.appendChild(script);
            } else {
                console.log('Chart.js —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω');
            }
        });
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Local IBM Plex Mono font faces */
        @font-face { font-family: 'IBM Plex Mono'; src: url('—à—Ä–∏—Ñ—Ç/IBMPlexMono-SemiBold.ttf') format('truetype'); font-weight: 600; font-style: normal; font-display: swap; }

        body {
            font-family: 'IBM Plex Mono', monospace;
            background: #1a1a1a;
            color: #ffffff;
            min-height: 100vh;
        }

        /* Force IBM Plex Mono everywhere */
        html, body, input, button, select, textarea, a, span, div, p, h1, h2, h3, h4, h5, h6 {
            font-family: 'IBM Plex Mono', monospace !important;
        }

        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .login-section {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #1a1a1a;
        }

        .login-form {
            background: #2a2a2a;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 400px;
        }

        .login-form h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #ffffff;
            font-size: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #cccccc;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #444;
            border-radius: 5px;
            background: #333;
            color: #ffffff;
            font-size: 16px;
        }

        .form-group input:focus {
            outline: none;
            border-color: #666;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background: #000000;
            color: #ffffff;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .login-btn:hover {
            background: #333;
        }

        .error-message {
            color: #ff6b6b;
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
        }

        .admin-panel {
            display: none;
            min-height: 100vh;
        }

        .admin-header {
            background: #000000;
            padding: 20px 0;
            margin-bottom: 40px;
        }

        .admin-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .admin-title {
            font-size: 24px;
            font-weight: bold;
        }

        .logout-btn {
            background: #ff6b6b;
            color: #ffffff;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .logout-btn:hover {
            background: #ff5252;
        }

        .admin-tabs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .tab-button {
            background: #2a2a2a;
            border: 2px solid #444;
            border-radius: 10px;
            padding: 30px 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #ffffff;
            position: relative;
        }

        .tab-button .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4444;
            color: #ffffff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .tab-button:hover {
            background: #333;
            border-color: #666;
            transform: translateY(-2px);
        }

        .tab-content {
            display: none;
            margin-top: 40px;
        }

        .tab-content.active {
            display: block;
        }

        .tab-content h3 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
        }

        .content-placeholder {
            text-align: center;
            color: #888;
            font-size: 16px;
            padding: 40px;
            background: #2a2a2a;
            border-radius: 10px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
        .chart-controls {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            color: #cccccc;
            font-size: 14px;
            font-weight: bold;
        }

        .control-group select {
            padding: 8px 12px;
            border: 1px solid #444;
            border-radius: 5px;
            background: #333;
            color: #ffffff;
            font-size: 14px;
            cursor: pointer;
        }

        .control-group select:focus {
            outline: none;
            border-color: #666;
        }

        .category-checkboxes {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .category-checkboxes label {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #cccccc;
            font-size: 14px;
            font-weight: normal;
            cursor: pointer;
        }

        .category-checkboxes input[type="checkbox"] {
            width: auto;
            margin: 0;
            cursor: pointer;
        }

        .chart-container {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .export-section {
            text-align: center;
        }

        .export-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: #ffffff;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .export-btn:hover {
            background: linear-gradient(135deg, #45a049, #4CAF50);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .export-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(76, 175, 80, 0.3);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞–º–∏ */
        .products-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .add-product-btn, .refresh-products-btn {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: #ffffff;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .add-product-btn:hover, .refresh-products-btn:hover {
            background: linear-gradient(135deg, #0056b3, #007bff);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }

        .product-form-container {
            background: #2a2a2a;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid #444;
        }

        .product-form h4 {
            color: #ffffff;
            margin-bottom: 20px;
            font-size: 20px;
            text-align: center;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #cccccc;
            font-size: 14px;
            font-weight: bold;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #444;
            border-radius: 5px;
            background: #333;
            color: #ffffff;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 60px;
        }

        .form-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        .save-product-btn, .cancel-product-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .save-product-btn {
            background: linear-gradient(135deg, #28a745, #1e7e34);
            color: #ffffff;
        }

        .save-product-btn:hover {
            background: linear-gradient(135deg, #1e7e34, #28a745);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .cancel-product-btn {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: #ffffff;
        }

        .cancel-product-btn:hover {
            background: linear-gradient(135deg, #c82333, #dc3545);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }

        .products-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .product-item {
            background: #333;
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid #007bff;
            transition: transform 0.3s ease;
        }

        .product-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .product-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .product-info h4 {
            color: #ffffff;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .product-info p {
            color: #cccccc;
            margin: 3px 0;
            font-size: 14px;
        }

        .product-actions {
            display: flex;
            gap: 8px;
        }

        .edit-product-btn, .delete-product-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .edit-product-btn {
            background: #ffc107;
            color: #000;
        }

        .edit-product-btn:hover {
            background: #e0a800;
            transform: translateY(-1px);
        }

        .delete-product-btn {
            background: #dc3545;
            color: #ffffff;
        }

        .delete-product-btn:hover {
            background: #c82333;
            transform: translateY(-1px);
        }

        .product-details {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #444;
        }

        .product-details h5 {
            color: #ffffff;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .product-details p {
            color: #cccccc;
            margin: 5px 0;
            font-size: 13px;
        }

        .product-images {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .product-image-preview {
            width: 100px;
            height: 100px;
            background: #444;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #999;
            border: 1px solid #555;
            overflow: hidden;
        }

        .product-image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 4px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ —Ü–≤–µ—Ç–æ–≤ */
        .options-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 10px;
        }

        .option-btn {
            padding: 8px 16px;
            border: 1px solid #555;
            background: #333;
            color: #ffffff;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            min-width: 60px;
            text-align: center;
        }

        .option-btn:hover {
            background: #555;
            border-color: #777;
        }

        .option-btn.selected {
            background: #007bff;
            border-color: #007bff;
            color: #ffffff;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π */
        .image-upload-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 15px;
        }

        .image-upload-block {
            border: 2px dashed #555;
            border-radius: 10px;
            padding: 15px;
            background: #2a2a2a;
        }

        .image-upload-block label {
            display: block;
            margin-bottom: 10px;
            color: #cccccc;
            font-size: 14px;
            font-weight: bold;
        }

        .image-upload-area {
            position: relative;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #444;
            border-radius: 5px;
            background: #333;
        }

        .image-upload-area:hover {
            background: #444;
            border-color: #666;
        }

        .upload-placeholder {
            text-align: center;
            color: #cccccc;
        }

        .upload-icon {
            font-size: 24px;
            display: block;
            margin-bottom: 5px;
        }

        .image-preview {
            margin-top: 10px;
            min-height: 80px;
            border-radius: 5px;
            overflow: hidden;
            border: 1px solid #555;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-preview img {
            width: 100%;
            height: 80px;
            object-fit: cover;
        }

        .image-preview .remove-image {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-preview .remove-image:hover {
            background: #c82333;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∑–∞–∫–∞–∑–æ–≤ */
        .orders-container {
            background: #2a2a2a;
            border-radius: 10px;
            padding: 20px;
        }

        .orders-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: #333;
            border: 1px solid #555;
            color: #ffffff;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            background: #444;
            border-color: #666;
        }

        .filter-btn.active {
            background: #007bff;
            border-color: #007bff;
        }

        .orders-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .order-item {
            background: #333;
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid #007bff;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .order-info h4 {
            color: #ffffff;
            margin-bottom: 5px;
            font-size: 18px;
        }

        .order-info p {
            color: #cccccc;
            margin: 3px 0;
            font-size: 14px;
        }

        .order-status-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-end;
        }

        .status-select {
            padding: 8px 12px;
            border: 1px solid #444;
            border-radius: 5px;
            background: #333;
            color: #ffffff;
            font-size: 14px;
            cursor: pointer;
        }

        .status-select:focus {
            outline: none;
            border-color: #666;
        }

        .tracking-section {
            display: none;
            margin-top: 10px;
            padding: 15px;
            background: #444;
            border-radius: 5px;
            position: relative;
        }

        .tracking-section.show {
            display: block;
        }

        .tracking-section.collapsed {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
        }

        .tracking-inputs {
            width: 100%;
        }

        .expand-btn {
            background: #666;
            color: #ffffff;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }

        .expand-btn:hover {
            background: #888;
        }

        .user-profile-info {
            margin-top: 15px;
            padding: 15px;
            background: #444;
            border-radius: 5px;
        }

        .user-profile-info h5 {
            color: #ffffff;
            margin-bottom: 10px;
            font-size: 14px;
            text-transform: uppercase;
        }

        .user-profile-info p {
            color: #cccccc;
            margin: 5px 0;
            font-size: 12px;
        }

        .tracking-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #555;
            border-radius: 5px;
            background: #333;
            color: #ffffff;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .tracking-input:focus {
            outline: none;
            border-color: #666;
        }

        .confirm-btn {
            background: #28a745;
            color: #ffffff;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .confirm-btn:hover {
            background: #218838;
        }

        .expand-btn {
            background: #007bff;
            color: #ffffff;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            transition: background 0.3s;
        }

        .expand-btn:hover {
            background: #0056b3;
        }

        .tracking-section.collapsed .tracking-inputs {
            display: none;
        }

        .tracking-section.show .expand-btn {
            display: none;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
            padding: 20px 0;
        }

        .pagination-btn {
            padding: 8px 12px;
            background: #444;
            color: #ffffff;
            border: 1px solid #666;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .pagination-btn:hover {
            background: #666;
        }

        .pagination-btn.active {
            background: #007bff;
            border-color: #007bff;
        }

        .pagination-btn:disabled {
            background: #333;
            color: #666;
            cursor: not-allowed;
        }

        /* ===== –°–¢–ò–õ–ò –î–õ–Ø –û–¢–ß–ï–¢–û–í (–ì–õ–û–ë–ê–õ–¨–ù–´–ï) ===== */
        .reports-container {
            background: #2a2a2a;
            border-radius: 10px;
            padding: 20px;
        }

        .reports-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .reports-export {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
            width: 100%;
            clear: both;
        }

        .export-btn {
            background: #28a745;
            border: 1px solid #28a745;
            color: #ffffff;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .export-btn:hover {
            background: #218838;
            border-color: #218838;
        }

        .reports-table-container {
            background: #333;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 20px;
            max-width: 100%;
            border: 3px solid #555555;
            padding: 10px;
        }

        .reports-table {
            width: 100%;
            min-width: 800px;
            border-collapse: collapse;
            font-size: 14px;
            border: 2px solid #666666;
            table-layout: auto;
        }

        .reports-table th {
            background: #444;
            color: #ffffff;
            padding: 14px 14px;
            text-align: left;
            font-weight: 600;
            border: 2px solid #888888;
            white-space: nowrap;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .reports-table th:last-child {}

        .reports-table td {
            padding: 12px 14px;
            border: 2px solid #666666;
            color: #e0e0e0;
            vertical-align: top;
            background: #2b2b2b;
            word-wrap: break-word;
            white-space: normal;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .reports-table td:last-child {
            border-right: none;
        }

        .reports-table tbody tr:hover {
            background: #3a3a3a;
        }

        .reports-table tbody tr:nth-child(odd) td { 
            background: #2b2b2b; 
            border: 2px solid #666666;
        }
        .reports-table tbody tr:nth-child(even) td { 
            background: #262626; 
            border: 2px solid #666666;
        }
        .reports-table tbody tr:hover td { 
            background: #333; 
            border: 2px solid #888888;
        }

        /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª —Å–ø—Ä–∞–≤–∞ */
        .reports-table td.num, .reports-table th.num { text-align: right; white-space: nowrap; }
        .reports-table td.small { color: #a0a0a0; font-size: 12px; }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ */
        .promocodes-container, .discounts-container {
            background: #2a2a2a;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .promocodes-filters, .discounts-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .promocodes-actions, .discounts-actions {
            margin-bottom: 20px;
        }

        .add-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: background 0.3s;
        }

        .add-btn:hover {
            background: #45a049;
        }



        .promocodes-table-container, .discounts-table-container {
            overflow-x: auto;
            background: #333;
            border-radius: 8px;
            padding: 10px;
        }

        .promocodes-table, .discounts-table {
            width: 100%;
            border-collapse: collapse;
            background: #333;
            color: #ffffff;
            font-size: 14px;
        }

        .promocodes-table th, .discounts-table th {
            background: #444;
            color: #ffffff;
            padding: 12px 8px;
            text-align: left;
            font-weight: bold;
            border-bottom: 2px solid #555;
            font-size: 14px;
        }

        .promocodes-table td, .discounts-table td {
            padding: 12px 8px;
            border-bottom: 1px solid #444;
            vertical-align: middle;
        }

        .promocodes-table tbody tr:nth-child(even) td,
        .discounts-table tbody tr:nth-child(even) td {
            background: #3a3a3a;
        }

        .promocodes-table tbody tr:hover td,
        .discounts-table tbody tr:hover td {
            background: #555;
        }

        .status-active {
            color: #4CAF50;
            font-weight: bold;
        }

        .status-expired {
            color: #f44336;
            font-weight: bold;
        }

        .action-btn {
            background: #666;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            margin: 2px;
            transition: background 0.3s;
        }

        .action-btn:hover {
            background: #888;
        }

        .action-btn.delete {
            background: #f44336;
        }

        .action-btn.delete:hover {
            background: #d32f2f;
        }

        .action-btn.edit {
            background: #2196F3;
        }

        .action-btn.edit:hover {
            background: #1976D2;
        }

        .reports-summary {
            background: #444;
            border-radius: 8px;
            padding: 20px;
            color: #ffffff;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .reports-summary h4 {
            margin-bottom: 15px;
            color: #ffffff;
            font-size: 18px;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .summary-stat {
            background: #555;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }

        .summary-stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 5px;
        }

        .summary-stat-label {
            font-size: 14px;
            color: #cccccc;
        }

        .order-items {
            margin-top: 15px;
        }

        .order-item-detail {
            display: flex;
            gap: 15px;
            padding: 10px 0;
            border-bottom: 1px solid #444;
        }

        .order-item-detail:last-child {
            border-bottom: none;
        }

        .item-image {
            width: 60px;
            height: 80px;
            background: #555;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            border-radius: 5px;
        }

        .item-number {
            font-size: 18px;
            color: #ffffff;
        }

        .item-details {
            flex: 1;
        }

        .item-name {
            color: #ffffff;
            font-size: 16px;
            margin-bottom: 5px;
        }

        .item-info {
            color: #cccccc;
            font-size: 14px;
            margin: 2px 0;
        }

        @media (max-width: 768px) {
            .admin-tabs {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .tab-button {
                padding: 20px 15px;
                font-size: 16px;
            }

            .login-form {
                margin: 20px;
                padding: 30px 20px;
            }

            .category-checkboxes {
                flex-direction: column;
                gap: 10px;
            }

            .chart-container {
                min-height: 300px;
                padding: 15px;
            }

            .chart-controls {
                padding: 15px;
            }

            .order-header {
                flex-direction: column;
                gap: 15px;
            }

            .order-status-controls {
                align-items: stretch;
            }

            .orders-filters {
                flex-direction: column;
                gap: 8px;
            }

            .filter-btn {
                width: 100%;
                text-align: center;
            }

            /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –æ–±—Ä–∞—â–µ–Ω–∏–π - —Ç–æ—á–Ω—ã–µ –∫–æ–ø–∏–∏ —Å—Ç–∏–ª–µ–π –∑–∞–∫–∞–∑–æ–≤ */
            .appeal-count {
                background: #ff4444;
                color: white;
                border-radius: 50%;
                padding: 2px 6px;
                font-size: 12px;
                margin-left: 8px;
                min-width: 20px;
                display: inline-block;
                text-align: center;
            }

            .appeal-item {
                background: #333;
                border-radius: 8px;
                padding: 20px;
                border-left: 4px solid #007bff;
            }

            .appeal-header {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 15px;
            }

            .appeal-info h4 {
                color: #ffffff;
                margin-bottom: 5px;
                font-size: 18px;
            }

            .appeal-info p {
                color: #cccccc;
                margin: 3px 0;
                font-size: 14px;
            }

            .appeal-status-controls {
                display: flex;
                flex-direction: column;
                gap: 10px;
                align-items: flex-end;
            }

            .appeal-message {
                background: #444;
                border: 1px solid #555;
                border-radius: 5px;
                padding: 15px;
                color: #cccccc;
                font-size: 14px;
                line-height: 1.5;
                margin-top: 15px;
            }

            .no-appeals {
                text-align: center;
                color: #888;
                font-size: 16px;
                padding: 40px;
            }

            /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤ */
            .reports-container {
                background: #2a2a2a;
                border-radius: 10px;
                padding: 20px;
            }

            .reports-filters {
                display: flex;
                gap: 10px;
                margin-bottom: 20px;
                flex-wrap: wrap;
                align-items: center;
            }

            .reports-export {
                display: flex;
                justify-content: flex-end;
                margin-top: 20px;
                width: 100%;
                clear: both; /* —á—Ç–æ–±—ã –Ω–µ –Ω–∞–ø–æ–ª–∑–∞–ª–æ –Ω–∞ —Å–≤–æ–¥–∫—É, –µ—Å–ª–∏ –≤ –Ω–µ–π –µ—Å—Ç—å –ø–ª–∞–≤–∞—é—â–∏–µ –±–ª–æ–∫–∏ */
            }

            .export-btn {
                background: #28a745;
                border: 1px solid #28a745;
                color: #ffffff;
                padding: 12px 24px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 16px;
                transition: all 0.3s ease;
                font-weight: 600;
            }

            .export-btn:hover {
                background: #218838;
                border-color: #218838;
            }

            .reports-table-container {
                background: #333;
                border-radius: 8px;
                overflow-x: auto;
                margin-bottom: 20px;
                max-width: 100%;
                border: 3px solid #555555;
                padding: 10px;
            }

            .reports-table {
                width: 100%;
                min-width: 800px;
                border-collapse: collapse;
                font-size: 14px;
                border: 2px solid #666666;
                table-layout: auto;
            }

            .reports-table th {
                background: #444;
                color: #ffffff;
                padding: 14px 14px;
                text-align: left;
                font-weight: 600;
                border: 2px solid #888888;
                white-space: nowrap;
                position: sticky;
                top: 0;
                z-index: 10;
            }

            .reports-table th:last-child {}

            .reports-table td {
                padding: 12px 14px;
                border: 2px solid #666666;
                color: #e0e0e0;
                vertical-align: top;
                background: #2b2b2b;
                word-wrap: break-word;
                white-space: normal;
                max-width: 200px;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .reports-table td:last-child {
                border-right: none;
            }

            .reports-table tbody tr:hover {
                background: #3a3a3a;
            }

            .reports-table tbody tr:nth-child(odd) td { 
                background: #2b2b2b; 
                border: 2px solid #666666;
            }
            .reports-table tbody tr:nth-child(even) td { 
                background: #262626; 
                border: 2px solid #666666;
            }
            .reports-table tbody tr:hover td { 
                background: #333; 
                border: 2px solid #888888;
            }

            /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª —Å–ø—Ä–∞–≤–∞ */
            .reports-table td.num, .reports-table th.num { text-align: right; white-space: nowrap; }
            .reports-table td.small { color: #a0a0a0; font-size: 12px; }

            .reports-summary {
                background: #444;
                border-radius: 8px;
                padding: 20px;
                color: #ffffff;
                margin-top: 20px;
                margin-bottom: 20px; /* —á—Ç–æ–±—ã –∫–Ω–æ–ø–∫–∞ –≤—ã–≥—Ä—É–∑–∫–∏ –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª–∞ —Å–≤–æ–¥–∫—É */
            }

            .reports-summary h4 {
                margin-bottom: 15px;
                color: #ffffff;
                font-size: 18px;
            }

            .summary-stats {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
            }

            .summary-stat {
                background: #555;
                padding: 15px;
                border-radius: 5px;
                text-align: center;
            }

            .summary-stat-value {
                font-size: 24px;
                font-weight: bold;
                color: #4CAF50;
                margin-bottom: 5px;
            }

            .summary-stat-label {
                font-size: 14px;
                color: #cccccc;
            }
        }
    </style>
</head>
<body>
    <!-- –°–µ–∫—Ü–∏—è –≤—Ö–æ–¥–∞ -->
    <div class="login-section" id="loginSection">
        <div class="login-form">
            <h2>–í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">–õ–æ–≥–∏–Ω:</label>
                    <input type="text" id="username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="password">–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <button type="submit" class="login-btn">–í–æ–π—Ç–∏</button>
            </form>
            <div class="error-message" id="errorMessage"></div>
            <div style="margin-top: 20px; text-align: center;">
                <button type="button" onclick="resetAuth()" style="background: #ff4444; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; font-size: 12px; margin-right: 10px;">
                    üîÑ –°–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤—Ö–æ–¥–∞
                </button>
                <button type="button" onclick="forceLogin()" style="background: #4CAF50; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; font-size: 12px;">
                    üöÄ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤—Ö–æ–¥
                </button>
            </div>
        </div>
    </div>

    <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <div class="admin-header-content">
                <div class="admin-title">–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å - –¶–µ–Ω—Ç—Ä –ö–∏–Ω–æ‚Ñ¢</div>
                <button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏</button>
            </div>
        </div>

        <div class="admin-container">
            <!-- –í–∫–ª–∞–¥–∫–∏ -->
            <div class="admin-tabs">
                <div class="tab-button" onclick="showTab('statistics')">
                    –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                </div>
                <div class="tab-button" onclick="showTab('orders')" id="ordersTab">
                    –ó–∞–∫–∞–∑—ã
                    <div class="notification-badge" id="ordersNotification" style="display: none;">0</div>
                </div>
                <div class="tab-button" onclick="showTab('products')">
                    –¢–æ–≤–∞—Ä—ã
                </div>
                <div class="tab-button" onclick="showTab('content')">
                    –ö–æ–Ω—Ç–µ–Ω—Ç
                </div>
                <div class="tab-button" onclick="showTab('appeals')" id="appealsTab">
                    <span>–û–±—Ä–∞—â–µ–Ω–∏—è</span>
                    <span class="notification-badge" id="appealsNotification" style="display: none;">0</span>
                </div>
                <div class="tab-button" onclick="showTab('reports')">
                    –û—Ç—á–µ—Ç—ã
                </div>
                <div class="tab-button" onclick="showTab('promocodes')">
                    –ü—Ä–æ–º–æ–∫–æ–¥—ã
                </div>
                <div class="tab-button" onclick="showTab('discounts')">
                    –°–∫–∏–¥–∫–∏
                </div>
            </div>

            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
            <div class="tab-content active" id="statistics">
                <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                
                <!-- –ö–æ–Ω—Ç—Ä–æ–ª—ã –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ -->
                <div class="chart-controls">
                    <div class="control-group">
                        <label>–ü–µ—Ä–∏–æ–¥:</label>
                        <select id="periodSelect" onchange="updateChart()">
                            <option value="1">1 –¥–µ–Ω—å</option>
                            <option value="3">3 –¥–Ω—è</option>
                            <option value="7">7 –¥–Ω–µ–π</option>
                            <option value="30" selected>–ú–µ—Å—è—Ü</option>
                            <option value="90">3 –º–µ—Å—è—Ü–∞</option>
                            <option value="180">6 –º–µ—Å—è—Ü–µ–≤</option>
                            <option value="365">12 –º–µ—Å—è—Ü–µ–≤</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏:</label>
                        <div class="category-checkboxes">
                            <label><input type="checkbox" value="visits" checked onchange="updateChart()"> –ü–æ—Å–µ—â–µ–Ω–∏—è —Å–∞–π—Ç–∞</label>
                            <label><input type="checkbox" value="orders" onchange="updateChart()"> –û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã</label>
                            <label><input type="checkbox" value="catalog" onchange="updateChart()"> –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∫–∞—Ç–∞–ª–æ–≥</label>
                            <label><input type="checkbox" value="newArrivals" onchange="updateChart()"> –ü–µ—Ä–µ—Ö–æ–¥ –≤ –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è</label>
                            <label><input type="checkbox" value="kinoshlep" onchange="updateChart()"> –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Å—ã–ª–∫—É: –ö–ò–ù–û–®–õ–ï–ü</label>
                            <label><input type="checkbox" value="registrations" onchange="updateChart()"> –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–≤—à–∏–µ—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</label>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <button onclick="forceInitChart()" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                            üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫
                        </button>
                    </div>
                </div>

                <!-- –ì—Ä–∞—Ñ–∏–∫ -->
                <div class="chart-container">
                    <canvas id="statisticsChart"></canvas>
                </div>

                <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã–≥—Ä—É–∑–∫–∏ -->
                <div class="export-section">
                    <button class="export-btn" onclick="exportStatistics()">
                        üìä –í—ã–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (Excel)
                    </button>
                    <button class="export-btn" onclick="exportStatisticsHTML()" style="margin-left: 10px;">
                        üñ®Ô∏è –í—ã–≥—Ä—É–∑–∏—Ç—å HTML –æ—Ç—á—ë—Ç
                    </button>
                </div>
            </div>

            <div class="tab-content" id="orders">
                <h3>–ó–∞–∫–∞–∑—ã</h3>
                <div class="orders-container">
                    <!-- –§–∏–ª—å—Ç—Ä—ã –∑–∞–∫–∞–∑–æ–≤ -->
                    <div class="orders-filters">
                        <button class="filter-btn active" data-filter="all" onclick="filterOrders('all')">
                            –í—Å–µ –∑–∞–∫–∞–∑—ã
                        </button>
                        <button class="filter-btn" data-filter="–í —Å–±–æ—Ä–∫–µ" onclick="filterOrders('–í —Å–±–æ—Ä–∫–µ')">
                            –ó–∞–∫–∞–∑—ã –≤ —Å–±–æ—Ä–∫–µ
                        </button>
                        <button class="filter-btn" data-filter="–û—Ç–ø—Ä–∞–≤–ª–µ–Ω" onclick="filterOrders('–û—Ç–ø—Ä–∞–≤–ª–µ–Ω')">
                            –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
                        </button>
                        <button class="filter-btn" data-filter="–î–æ—Å—Ç–∞–≤–ª–µ–Ω" onclick="filterOrders('–î–æ—Å—Ç–∞–≤–ª–µ–Ω')">
                            –î–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
                        </button>
                    </div>
                    <div class="orders-list" id="ordersList">
                        <!-- –ó–∞–∫–∞–∑—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                    </div>
                    <div class="pagination" id="ordersPagination">
                        <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>

            <div class="tab-content" id="products">
                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h3>
                
                <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
                <div class="products-controls">
                    <button class="add-product-btn" onclick="showAddProductForm()">
                        ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä
                    </button>
                </div>

                <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
                <div class="product-form-container" id="productFormContainer" style="display: none;">
                    <div class="product-form">
                        <h4 id="productFormTitle">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h4>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>ID —Ç–æ–≤–∞—Ä–∞:</label>
                                <input type="number" id="productId" placeholder="–£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID">
                            </div>
                            <div class="form-group">
                                <label>–ê—Ä—Ç–∏–∫—É–ª:</label>
                                <input type="text" id="productArticle" placeholder="–ê—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:</label>
                            <input type="text" id="productName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞">
                        </div>

                        <div class="form-group">
                            <label>–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                            <textarea id="productDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" rows="3"></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>–¶–µ–Ω–∞ (‚ÇΩ):</label>
                                <input type="number" id="productPrice" placeholder="–¶–µ–Ω–∞">
                            </div>
                                                    <div class="form-group">
                            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è (–º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ):</label>
                            <div class="category-checkboxes">
                                <label><input type="checkbox" value="–º—É–∂—Å–∫–∞—è"> –ú—É–∂—Å–∫–∞—è</label>
                                <label><input type="checkbox" value="–∂–µ–Ω—Å–∫–∞—è"> –ñ–µ–Ω—Å–∫–∞—è</label>
                                <label><input type="checkbox" value="–Ω–∞—Å—Ç–æ–ª—å–Ω—ã–µ –∏–≥—Ä—ã"> –ù–∞—Å—Ç–æ–ª—å–Ω—ã–µ –∏–≥—Ä—ã</label>
                                <label><input type="checkbox" value="–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã"> –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</label>
                            </div>
                            <input type="hidden" id="productCategory" value="">
                        </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>–ú–∞—Ç–µ—Ä–∏–∞–ª:</label>
                                <input type="text" id="productMaterial" placeholder="–ú–∞—Ç–µ—Ä–∏–∞–ª">
                            </div>
                            <div class="form-group">
                                <label>–°–µ–∑–æ–Ω:</label>
                                <input type="text" id="productSeason" placeholder="–°–µ–∑–æ–Ω">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>–°—Ç–∏–ª—å:</label>
                                <input type="text" id="productStyle" placeholder="–°—Ç–∏–ª—å">
                            </div>
                            <div class="form-group">
                                <label>–°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å:</label>
                                <input type="text" id="productCountry" placeholder="–°—Ç—Ä–∞–Ω–∞">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>–†–∞–∑–º–µ—Ä—ã:</label>
                            <div class="options-buttons" id="sizesContainer">
                                <button type="button" class="option-btn" data-value="ONESIZE">ONESIZE</button>
                                <button type="button" class="option-btn" data-value="XS">XS</button>
                                <button type="button" class="option-btn" data-value="S">S</button>
                                <button type="button" class="option-btn" data-value="M">M</button>
                                <button type="button" class="option-btn" data-value="L">L</button>
                                <button type="button" class="option-btn" data-value="XL">XL</button>
                                <button type="button" class="option-btn" data-value="XXL">XXL</button>
                            </div>
                            <input type="hidden" id="productSizes" value="">
                        </div>

                        <div class="form-group">
                            <label>–¶–≤–µ—Ç–∞:</label>
                            <div class="options-buttons" id="colorsContainer">
                                <button type="button" class="option-btn" data-value="–ß–µ—Ä–Ω—ã–π">–ß–µ—Ä–Ω—ã–π</button>
                                <button type="button" class="option-btn" data-value="–ë–µ–ª—ã–π">–ë–µ–ª—ã–π</button>
                                <button type="button" class="option-btn" data-value="–ú–æ–ª–æ—á–Ω—ã–π">–ú–æ–ª–æ—á–Ω—ã–π</button>
                                <button type="button" class="option-btn" data-value="–°–µ—Ä—ã–π">–°–µ—Ä—ã–π</button>
                                <button type="button" class="option-btn" data-value="–ö—Ä–∞—Å–Ω—ã–π">–ö—Ä–∞—Å–Ω—ã–π</button>
                                <button type="button" class="option-btn" data-value="–ó–µ–ª–µ–Ω—ã–π">–ó–µ–ª–µ–Ω—ã–π</button>
                                <button type="button" class="option-btn" data-value="–ñ–µ–ª—Ç—ã–π">–ñ–µ–ª—Ç—ã–π</button>
                                <button type="button" class="option-btn" data-value="–§–∏–æ–ª–µ—Ç–æ–≤—ã–π">–§–∏–æ–ª–µ—Ç–æ–≤—ã–π</button>
                                <button type="button" class="option-btn" data-value="–ë–µ–∂–µ–≤—ã–π">–ë–µ–∂–µ–≤—ã–π</button>
                                <button type="button" class="option-btn" data-value="–†–æ–∑–æ–≤—ã–π">–†–æ–∑–æ–≤—ã–π</button>
                            </div>
                            <input type="hidden" id="productColors" value="">
                        </div>

                        <div class="form-group">
                            <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ (4 —Ñ–æ—Ç–æ):</label>
                            <div class="image-upload-grid">
                                <div class="image-upload-block">
                                    <label>–§–æ—Ç–æ 1:</label>
                                    <div class="image-upload-area" id="imageUploadArea1">
                                        <input type="file" id="imageUpload1" accept="image/*" style="display: none;">
                                        <div class="upload-placeholder">
                                            <span class="upload-icon">üì∑</span>
                                            <p>–§–æ—Ç–æ 1</p>
                                            <p style="font-size: 12px; color: #666; margin-top: 5px;">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: 350√ó500px</p>
                                        </div>
                                    </div>
                                    <div class="image-preview" id="imagePreview1"></div>
                                </div>
                                <div class="image-upload-block">
                                    <label>–§–æ—Ç–æ 2:</label>
                                    <div class="image-upload-area" id="imageUploadArea2">
                                        <input type="file" id="imageUpload2" accept="image/*" style="display: none;">
                                        <div class="upload-placeholder">
                                            <span class="upload-icon">üì∑</span>
                                            <p>–§–æ—Ç–æ 2</p>
                                            <p style="font-size: 12px; color: #666; margin-top: 5px;">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: 350√ó500px</p>
                                        </div>
                                    </div>
                                    <div class="image-preview" id="imagePreview2"></div>
                                </div>
                                <div class="image-upload-block">
                                    <label>–§–æ—Ç–æ 3:</label>
                                    <div class="image-upload-area" id="imageUploadArea3">
                                        <input type="file" id="imageUpload3" accept="image/*" style="display: none;">
                                        <div class="upload-placeholder">
                                            <span class="upload-icon">üì∑</span>
                                            <p>–§–æ—Ç–æ 3</p>
                                            <p style="font-size: 12px; color: #666; margin-top: 5px;">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: 350√ó500px</p>
                                        </div>
                                    </div>
                                    <div class="image-preview" id="imagePreview3"></div>
                                </div>
                                <div class="image-upload-block">
                                    <label>–§–æ—Ç–æ 4:</label>
                                    <div class="image-upload-area" id="imageUploadArea4">
                                        <input type="file" id="imageUpload4" accept="image/*" style="display: none;">
                                        <div class="upload-placeholder">
                                            <span class="upload-icon">üì∑</span>
                                            <p>–§–æ—Ç–æ 4</p>
                                            <p style="font-size: 12px; color: #666; margin-top: 5px;">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: 350√ó500px</p>
                                        </div>
                                    </div>
                                    <div class="image-preview" id="imagePreview4"></div>
                                </div>
                            </div>
                            <input type="hidden" id="productImages" value="">
                        </div>

                        <div class="form-group">
                            <label>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å—Ç–∏—Ä–∫–µ:</label>
                            <textarea id="productWashing" placeholder="–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å—Ç–∏—Ä–∫–µ" rows="2"></textarea>
                        </div>

                        <div class="form-group">
                            <label>–°–æ—Å—Ç–∞–≤:</label>
                            <textarea id="productComposition" placeholder="–°–æ—Å—Ç–∞–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–∞" rows="2"></textarea>
                        </div>

                        <div class="form-group">
                            <label>–£—Ö–æ–¥:</label>
                            <textarea id="productCare" placeholder="–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Ö–æ–¥—É" rows="2"></textarea>
                        </div>

                        <div class="form-buttons">
                            <button class="save-product-btn" onclick="saveProduct()">
                                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä
                            </button>
                            <button class="cancel-product-btn" onclick="hideProductForm()">
                                ‚ùå –û—Ç–º–µ–Ω–∞
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ -->
                <div class="products-list" id="productsList">
                    <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                </div>
            </div>

            <div class="tab-content" id="content">
                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</h3>
                <div class="content-container">
                    <div class="content-header">
                        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —É–¥–∞–ª–µ–Ω -->
                    </div>
                    
                    <!-- –§–∏–ª—å—Ç—Ä—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
                    <div class="content-filters" style="display: flex !important; gap: 10px !important; margin-bottom: 100px !important; flex-wrap: nowrap !important; align-items: center !important; justify-content: center !important; overflow-x: auto !important; padding: 10px 0 !important;">
                        <button class="filter-btn active" data-filter="main" onclick="filterContent('main')" style="background: #2a2a2a !important; border: 2px solid #444 !important; color: #ffffff !important; padding: 12px 15px !important; border-radius: 8px !important; cursor: pointer !important; font-size: 12px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 0.5px !important; min-width: 120px !important; text-align: center !important; white-space: nowrap !important; flex-shrink: 0 !important;">
                            –ì–õ–ê–í–ù–ê–Ø –°–¢–†–ê–ù–ò–¶–ê
                        </button>
                        <button class="filter-btn" data-filter="new-arrivals" onclick="filterContent('new-arrivals')" style="background: #2a2a2a !important; border: 2px solid #444 !important; color: #ffffff !important; padding: 12px 15px !important; border-radius: 8px !important; cursor: pointer !important; font-size: 12px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 0.5px !important; min-width: 120px !important; text-align: center !important; white-space: nowrap !important; flex-shrink: 0 !important;">
                            –ù–û–í–´–ï –ü–û–°–¢–£–ü–õ–ï–ù–ò–Ø
                        </button>
                        <button class="filter-btn" data-filter="catalog" onclick="filterContent('catalog')" style="background: #2a2a2a !important; border: 2px solid #444 !important; color: #ffffff !important; padding: 12px 15px !important; border-radius: 8px !important; cursor: pointer !important; font-size: 12px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 0.5px !important; min-width: 120px !important; text-align: center !important; white-space: nowrap !important; flex-shrink: 0 !important;">
                            –ö–ê–¢–ê–õ–û–ì
                        </button>
                        <button class="filter-btn" data-filter="about" onclick="filterContent('about')" style="background: #2a2a2a !important; border: 2px solid #444 !important; color: #ffffff !important; padding: 12px 15px !important; border-radius: 8px !important; cursor: pointer !important; font-size: 12px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 0.5px !important; min-width: 120px !important; text-align: center !important; white-space: nowrap !important; flex-shrink: 0 !important;">
                            –û –ù–ê–°
                        </button>
                        <button class="filter-btn" data-filter="help" onclick="filterContent('help')" style="background: #2a2a2a !important; border: 2px solid #444 !important; color: #ffffff !important; padding: 12px 15px !important; border-radius: 8px !important; cursor: pointer !important; font-size: 12px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 0.5px !important; min-width: 120px !important; text-align: center !important; white-space: nowrap !important; flex-shrink: 0 !important;">
                            –ü–û–ú–û–©–¨
                        </button>
                        <button class="filter-btn" data-filter="transitions" onclick="filterContent('transitions')" style="background: #2a2a2a !important; border: 2px solid #444 !important; color: #ffffff !important; padding: 12px 15px !important; border-radius: 8px !important; cursor: pointer !important; font-size: 12px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 0.5px !important; min-width: 120px !important; text-align: center !important; white-space: nowrap !important; flex-shrink: 0 !important;">
                            –ü–ï–†–ï–•–û–î–´
                        </button>
                    </div>
                    
                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
                    <div class="content-section" id="mainContent" style="display: block;">
                        <div class="content-buttons">
                            <button class="content-btn" onclick="openContentModal('main', 'banner1')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –ë–ê–ù–ï–† 1
                            </button>
                            <button class="content-btn" onclick="openContentModal('main', 'banner2')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –ë–ê–ù–ï–† 2
                            </button>
                            <button class="content-btn" onclick="openContentModal('main', 'banner3')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –ë–ê–ù–ï–† 3
                            </button>
                            <button class="content-btn" onclick="openContentModal('main', 'banner4')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –ë–ê–ù–ï–† 4 –ù–ò–ñ–ù–ò–ô
                            </button>
                        </div>
                    </div>

                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π -->
                    <div class="content-section" id="new-arrivalsContent" style="display: none;">
                        <div class="content-buttons">
                            <button class="content-btn" onclick="openContentModal('new-arrivals', 'product1')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –¢–û–í–ê–† 1
                            </button>
                            <button class="content-btn" onclick="openContentModal('new-arrivals', 'product2')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –¢–û–í–ê–† 2
                            </button>
                            <button class="content-btn" onclick="openContentModal('new-arrivals', 'product3')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –¢–û–í–ê–† 3
                            </button>
                            <button class="content-btn" onclick="openContentModal('new-arrivals', 'product4')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –¢–û–í–ê–† 4
                            </button>
                        </div>
                    </div>

                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ -->
                    <div class="content-section" id="catalogContent" style="display: none;">
                        <div class="content-buttons">
                            <button class="content-btn" onclick="openContentModal('catalog', 'hero')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –ë–ê–ù–ï–† –ö–ê–¢–ê–õ–û–ì–ê
                            </button>
                        </div>
                    </div>

                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –æ –Ω–∞—Å -->
                    <div class="content-section" id="aboutContent" style="display: none;">
                        <div class="content-buttons">
                            <button class="content-btn" onclick="openContentModal('about', 'hero')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –ë–ê–ù–ï–† –û –ù–ê–°
                            </button>
                        </div>
                    </div>

                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø–æ–º–æ—â–∏ -->
                    <div class="content-section" id="helpContent" style="display: none;">
                        <div class="content-buttons">
                            <button class="content-btn" onclick="openContentModal('help', 'hero')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –ë–ê–ù–ï–† –ü–û–ú–û–©–ò
                            </button>
                        </div>
                    </div>

                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ -->
                    <div class="content-section" id="transitionsContent" style="display: none;">
                        <div class="content-buttons">
                            <button class="content-btn" onclick="openContentModal('transitions', 'block1')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –ë–õ–û–ö 1
                            </button>
                            <button class="content-btn" onclick="openContentModal('transitions', 'block2')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –ë–õ–û–ö 2
                            </button>
                            <button class="content-btn" onclick="openContentModal('transitions', 'block3')" style="background: #2a2a2a !important; color: #ffffff !important; border: 2px solid #444 !important; padding: 30px 20px !important; border-radius: 10px !important; cursor: pointer !important; font-size: 18px !important; font-weight: bold !important; transition: all 0.3s ease !important; text-transform: uppercase !important; letter-spacing: 1px !important; min-height: 80px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; width: 100% !important; margin-bottom: 15px !important;">
                                –ë–õ–û–ö 3
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="appeals">
                <h3>–û–±—Ä–∞—â–µ–Ω–∏—è</h3>
                <div class="orders-container">
                    <!-- –§–∏–ª—å—Ç—Ä—ã –æ–±—Ä–∞—â–µ–Ω–∏–π -->
                    <div class="orders-filters">
                        <button class="filter-btn active" data-filter="new" onclick="filterAppeals('new')">
                            –ù–æ–≤—ã–µ –∑–∞—è–≤–∫–∏
                            <span class="appeal-count" id="newCount">0</span>
                        </button>
                        <button class="filter-btn" data-filter="processed" onclick="filterAppeals('processed')">
                            –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ
                            <span class="appeal-count" id="processedCount">0</span>
                        </button>
                    </div>
                    <div class="orders-list" id="appealsList">
                        <!-- –û–±—Ä–∞—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>

            <div class="tab-content" id="reports">
                <h3>–û—Ç—á–µ—Ç—ã</h3>
                <div class="reports-container">
                    <!-- –§–∏–ª—å—Ç—Ä—ã –æ—Ç—á–µ—Ç–æ–≤ -->
                    <div class="reports-filters">
                        <button class="filter-btn active" data-filter="1" onclick="filterReports('1')">
                            1 –¥–µ–Ω—å
                        </button>
                        <button class="filter-btn" data-filter="7" onclick="filterReports('7')">
                            –ù–µ–¥–µ–ª—è
                        </button>
                        <button class="filter-btn" data-filter="30" onclick="filterReports('30')">
                            –ú–µ—Å—è—Ü
                        </button>
                        <button class="filter-btn" data-filter="365" onclick="filterReports('365')">
                            –ì–æ–¥
                        </button>
                    </div>
                    
                    <!-- –¢–∞–±–ª–∏—Ü–∞ –æ—Ç—á–µ—Ç–æ–≤ -->
                    <div class="reports-table-container">
                        <table class="reports-table" id="reportsTable">
                            <thead>
                                <tr>
                                    <th>–î–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏</th>
                                    <th>–¢–æ–≤–∞—Ä—ã –≤ –∑–∞–∫–∞–∑–µ</th>
                                    <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                    <th>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å</th>
                                    <th class="num">–î–æ—Å—Ç–∞–≤–∫–∞</th>
                                    <th>–ü—Ä–æ–º–æ–∫–æ–¥</th>
                                    <th class="num">–ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞</th>
                                </tr>
                            </thead>
                            <tbody id="reportsTableBody">
                                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </tbody>
                        </table>
            </div>
                    
                    <!-- –°–≤–æ–¥–∫–∞ -->
                    <div class="reports-summary" id="reportsSummary">
                        <!-- –°–≤–æ–¥–∫–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã–≥—Ä—É–∑–∫–∏ -->
                    <div class="reports-export">
                        <button class="export-btn" onclick="exportToExcel()">
                            üìä –í—ã–≥—Ä—É–∑–∏—Ç—å HTML –æ—Ç—á–µ—Ç
                        </button>
                        <button class="export-btn" onclick="exportToExcelFormat()" style="margin-left: 10px;">
                            üìà –í—ã–≥—Ä—É–∑–∏—Ç—å Excel
                        </button>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="promocodes">
                <h3>–ü—Ä–æ–º–æ–∫–æ–¥—ã</h3>
                <div class="promocodes-container">
                    <!-- –§–∏–ª—å—Ç—Ä—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ -->
                    <div class="promocodes-filters">
                        <button class="filter-btn active" data-filter="all" onclick="filterPromocodes('all')">
                            –í—Å–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã
                        </button>
                        <button class="filter-btn" data-filter="active" onclick="filterPromocodes('active')">
                            –ê–∫—Ç–∏–≤–Ω—ã–µ
                        </button>
                        <button class="filter-btn" data-filter="expired" onclick="filterPromocodes('expired')">
                            –ò—Å—Ç–µ–∫—à–∏–µ
                        </button>
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–º–æ–∫–æ–¥–∞ -->
                    <div class="promocodes-actions" style="display: flex; justify-content: flex-end;">
                        <button class="add-btn" onclick="openPromocodeModal()">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥
                        </button>
                    </div>
                    
                    <!-- –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ -->
                    <div class="promocodes-table-container">
                        <table class="promocodes-table" id="promocodesTable">
                            <thead>
                                <tr>
                                    <th>–ö–æ–¥</th>
                                    <th>–¢–∏–ø</th>
                                    <th>–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                                    <th>–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</th>
                                    <th>–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è</th>
                                    <th>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="promocodesTableBody">
                                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="discounts">
                <h3>–°–∫–∏–¥–∫–∏</h3>
                <div class="discounts-container">
                    <!-- –§–∏–ª—å—Ç—Ä—ã —Å–∫–∏–¥–æ–∫ -->
                    <div class="discounts-filters">
                        <button class="filter-btn active" data-filter="all" onclick="filterDiscounts('all')">
                            –í—Å–µ —Å–∫–∏–¥–∫–∏
                        </button>
                        <button class="filter-btn" data-filter="active" onclick="filterDiscounts('active')">
                            –ê–∫—Ç–∏–≤–Ω—ã–µ
                        </button>
                        <button class="filter-btn" data-filter="expired" onclick="filterDiscounts('expired')">
                            –ò—Å—Ç–µ–∫—à–∏–µ
                        </button>
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π —Å–∫–∏–¥–∫–∏ -->
                    <div class="discounts-actions" style="display: flex; justify-content: flex-end;">
                        <button class="add-btn" onclick="openDiscountModal()">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–∫–∏–¥–∫—É
                        </button>
                    </div>
                    
                    <!-- –¢–∞–±–ª–∏—Ü–∞ —Å–∫–∏–¥–æ–∫ -->
                    <div class="discounts-table-container">
                        <table class="discounts-table" id="discountsTable">
                            <thead>
                                <tr>
                                    <th>–¢–æ–≤–∞—Ä</th>
                                    <th>–¢–∏–ø</th>
                                    <th>–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                                    <th>–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</th>
                                    <th>–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="discountsTableBody">
                                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
        const adminUsers = [
            {
                login: 'centerkino',
                password: 'kinocenter2025'
            },
            {
                login: 'vladimir_firman',
                password: 'vova_krut'
            },
            {
                login: 'admin_kino',
                password: 'admin_ory'
            }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω –ª–∏ Chart.js
            if (typeof Chart === 'undefined') {
                console.error('Chart.js –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω!');
                return;
            }

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ localStorage (–æ–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ)
            localStorage.setItem('adminUsers', JSON.stringify(adminUsers));

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä localStorage
            checkStorageSize();
            
            // –û—á–∏—â–∞–µ–º –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            cleanCorruptedImages();

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            initStatistics();
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
            if (!localStorage.getItem('statisticsData') || Object.keys(JSON.parse(localStorage.getItem('statisticsData') || '{}')).length === 0) {
                generateTestData();
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            const isLoggedIn = localStorage.getItem('adminLoggedIn');
            if (isLoggedIn === 'true') {
                showAdminPanel();
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–∫–∞–∑–∞—Ö
                initOrderNotifications();
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –æ–±—Ä–∞—â–µ–Ω–∏–π
                initAppeals();
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –æ—Ç—á–µ—Ç–æ–≤
                initReports();
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
                initPromocodes();
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É —Å–∫–∏–¥–æ–∫
                initDiscounts();
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                login();
            });
        });

        // –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–∞—è
        function login() {
            // –ü—Ä–æ—Å—Ç–æ –≤—Ö–æ–¥–∏–º –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫
                localStorage.setItem('adminLoggedIn', 'true');
            localStorage.setItem('adminUser', 'admin');
                showAdminPanel();
            console.log('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω (–±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫)');
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–∫–∞–∑–∞—Ö
                initOrderNotifications();
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –æ–±—Ä–∞—â–µ–Ω–∏–π
                initAppeals();
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –æ—Ç—á–µ—Ç–æ–≤
                initReports();
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
                initPromocodes();
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É —Å–∫–∏–¥–æ–∫
                initDiscounts();
        }

        // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞
        function logout() {
            localStorage.removeItem('adminLoggedIn');
            localStorage.removeItem('adminUser');
            showLoginSection();
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
        function resetAuth() {
            localStorage.removeItem('adminLoggedIn');
            localStorage.removeItem('adminUser');
            localStorage.removeItem('adminUsers');
            alert('–î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å–±—Ä–æ—à–µ–Ω—ã! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞.');
            location.reload();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
        function forceLogin() {
            localStorage.setItem('adminUsers', JSON.stringify(adminUsers));
            localStorage.setItem('adminLoggedIn', 'true');
            localStorage.setItem('adminUser', 'centerkino');
            showAdminPanel();
            alert('–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω!');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
        function showAdminPanel() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'block';
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–µ–∫—Ü–∏—é –≤—Ö–æ–¥–∞
        function showLoginSection() {
            document.getElementById('loginSection').style.display = 'flex';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('loginForm').reset();
            document.getElementById('errorMessage').textContent = '';
        }



        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        let statisticsChart = null;
        let statisticsData = {};

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function initStatistics() {
            // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
            if (!localStorage.getItem('statisticsData')) {
                const initialData = {
                    visits: {},
                    orders: {},
                    catalog: {},
                    newArrivals: {},
                    kinoshlep: {},
                    registrations: {}
                };
                localStorage.setItem('statisticsData', JSON.stringify(initialData));
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            statisticsData = JSON.parse(localStorage.getItem('statisticsData') || '{}');
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
            setInterval(updateChartData, 120000);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function recordStatistic(type) {
            const today = new Date().toISOString().split('T')[0];
            
            if (!statisticsData[type]) {
                statisticsData[type] = {};
            }
            
            if (!statisticsData[type][today]) {
                statisticsData[type][today] = 0;
            }
            
            statisticsData[type][today]++;
            localStorage.setItem('statisticsData', JSON.stringify(statisticsData));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫ –µ—Å–ª–∏ –æ–Ω –æ—Ç–∫—Ä—ã—Ç
            if (statisticsChart) {
                updateChartData();
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ—Å–µ—â–µ–Ω–∏–π (—Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ IP) - —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
        function adminRecordVisit() {
            const today = new Date().toISOString().split('T')[0];
            const visitorId = adminGenerateVisitorId();
            
            if (!statisticsData.visits) {
                statisticsData.visits = {};
            }
            
            if (!statisticsData.visits[today]) {
                statisticsData.visits[today] = new Set();
            }
            
            // –ï—Å–ª–∏ —ç—Ç–æ Set, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –æ–±—ã—á–Ω—ã–π –æ–±—ä–µ–∫—Ç
            if (statisticsData.visits[today] instanceof Set) {
                statisticsData.visits[today].add(visitorId);
            } else {
                // –ï—Å–ª–∏ —ç—Ç–æ —á–∏—Å–ª–æ, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π Set
                statisticsData.visits[today] = new Set([visitorId]);
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ –º–∞—Å—Å–∏–≤ –¥–ª—è localStorage
            const visitsArray = Array.from(statisticsData.visits[today]);
            localStorage.setItem('statisticsData', JSON.stringify(statisticsData));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫ –µ—Å–ª–∏ –æ–Ω –æ—Ç–∫—Ä—ã—Ç
            if (statisticsChart) {
                updateChartData();
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è - —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
        function adminGenerateVisitorId() {
            const userAgent = navigator.userAgent;
            const screenRes = `${screen.width}x${screen.height}`;
            const timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            const language = navigator.language;
            
            // –°–æ–∑–¥–∞–µ–º —Ö–µ—à –∏–∑ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –±—Ä–∞—É–∑–µ—Ä–∞
            const hash = btoa(`${userAgent}-${screenRes}-${timeZone}-${language}`).slice(0, 16);
            return hash;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
        function initStatisticsChart() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞...');
            
            const ctx = document.getElementById('statisticsChart');
            if (!ctx) {
                console.error('Canvas —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω –ª–∏ Chart.js
            if (typeof Chart === 'undefined') {
                console.error('Chart.js –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω!');
                return;
            }

            // –£–Ω–∏—á—Ç–æ–∂–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≥—Ä–∞—Ñ–∏–∫ –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            if (statisticsChart) {
                statisticsChart.destroy();
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            statisticsData = JSON.parse(localStorage.getItem('statisticsData') || '{}');
            console.log('–î–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', statisticsData);

            const data = generateChartData();
            console.log('–î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞:', data);
            
            try {
                statisticsChart = new Chart(ctx, {
                    type: 'line',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#ffffff'
                                }
                            },
                            title: {
                                display: true,
                                text: '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π –∏ –¥–µ–π—Å—Ç–≤–∏–π',
                                color: '#ffffff',
                                font: {
                                    size: 16
                                }
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: '–î–Ω–∏',
                                    color: '#ffffff'
                                },
                                ticks: {
                                    color: '#ffffff'
                                },
                                grid: {
                                    color: '#444'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ',
                                    color: '#ffffff'
                                },
                                ticks: {
                                    color: '#ffffff',
                                    beginAtZero: true,
                                    min: 0,
                                    stepSize: 1,
                                    callback: function(value) {
                                        return Math.floor(value);
                                    }
                                },
                                grid: {
                                    color: '#444'
                                },
                                beginAtZero: true
                            }
                        }
                    }
                });
                console.log('–ì—Ä–∞—Ñ–∏–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞:', error);
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
        function generateChartData() {
            const period = parseInt(document.getElementById('periodSelect').value);
            const selectedCategories = getSelectedCategories();
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞—Ç—ã –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
            const dates = [];
            const today = new Date();
            
            for (let i = period - 1; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                dates.push(date.toISOString().split('T')[0]);
            }

            const datasets = [];
            const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40'];

            selectedCategories.forEach((category, index) => {
                const data = dates.map(date => {
                    let value = 0;
                    
                    if (statisticsData[category] && statisticsData[category][date]) {
                        if (category === 'visits') {
                            // –î–ª—è –ø–æ—Å–µ—â–µ–Ω–∏–π —Å—á–∏—Ç–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π
                            const visitsData = statisticsData[category][date];
                            if (Array.isArray(visitsData)) {
                                value = visitsData.length;
                            } else if (typeof visitsData === 'number') {
                                value = visitsData;
                            }
                        } else {
                            value = statisticsData[category][date];
                        }
                    }
                    
                    return Math.max(0, value); // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –º–µ–Ω—å—à–µ 0
                });

                datasets.push({
                    label: getCategoryLabel(category),
                    data: data,
                    borderColor: colors[index % colors.length],
                    backgroundColor: colors[index % colors.length] + '20',
                    borderWidth: 2,
                    fill: false,
                    tension: 0.4
                });
            });

            return {
                labels: dates.map(date => {
                    const d = new Date(date);
                    return d.toLocaleDateString('ru-RU', { day: '2-digit', month: '2-digit' });
                }),
                datasets: datasets
            };
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        function getSelectedCategories() {
            const checkboxes = document.querySelectorAll('.category-checkboxes input[type="checkbox"]:checked');
            return Array.from(checkboxes).map(cb => cb.value);
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function getCategoryLabel(category) {
            const labels = {
                visits: '–ü–æ—Å–µ—â–µ–Ω–∏—è —Å–∞–π—Ç–∞',
                orders: '–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã',
                catalog: '–ü–µ—Ä–µ—Ö–æ–¥ –≤ –∫–∞—Ç–∞–ª–æ–≥',
                newArrivals: '–ü–µ—Ä–µ—Ö–æ–¥ –≤ –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è',
                kinoshlep: '–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Å—ã–ª–∫—É: –ö–ò–ù–û–®–õ–ï–ü',
                registrations: '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–≤—à–∏–µ—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏'
            };
            return labels[category] || category;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–∞
        function updateChartData() {
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
            statisticsData = JSON.parse(localStorage.getItem('statisticsData') || '{}');
            
            if (statisticsChart) {
                const newData = generateChartData();
                statisticsChart.data = newData;
                statisticsChart.update('none'); // –û–±–Ω–æ–≤–ª—è–µ–º –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function updateChart() {
            updateChartData();
        }

        // –≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ Excel —Ñ–æ—Ä–º–∞—Ç
        function exportStatistics() {
            const period = parseInt(document.getElementById('periodSelect').value);
            const selectedCategories = getSelectedCategories();
            
            if (selectedCategories.length === 0) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞');
                return;
            }

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
            const dates = [];
            const today = new Date();
            
            for (let i = period - 1; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                dates.push(date.toISOString().split('T')[0]);
            }

            // –°–æ–∑–¥–∞–µ–º Excel-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π HTML —Ñ–∞–π–ª –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            selectedCategories.forEach(category => {
                const categoryLabel = getCategoryLabel(category);
                
                // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è Excel
                const excelData = [];
                
                // –ó–∞–≥–æ–ª–æ–≤–∫–∏
                excelData.push([
                    '–ö–∞—Ç–µ–≥–æ—Ä–∏—è',
                    '–î–∞—Ç–∞',
                    '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ'
                ]);
                
                // –î–∞–Ω–Ω—ã–µ
                dates.forEach(date => {
                    let value = 0;
                    
                    if (statisticsData[category] && statisticsData[category][date]) {
                        if (category === 'visits') {
                            // –î–ª—è –ø–æ—Å–µ—â–µ–Ω–∏–π —Å—á–∏—Ç–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π
                            const visitsData = statisticsData[category][date];
                            if (Array.isArray(visitsData)) {
                                value = visitsData.length;
                            } else if (typeof visitsData === 'number') {
                                value = visitsData;
                            }
                        } else {
                            value = statisticsData[category][date];
                        }
                    }
                    
                    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –¥–ª—è Excel (DD.MM.YYYY)
                    const orderDate = new Date(date);
                    const formattedDate = `${orderDate.getDate().toString().padStart(2, '0')}.${(orderDate.getMonth() + 1).toString().padStart(2, '0')}.${orderDate.getFullYear()}`;
                    
                    excelData.push([
                        categoryLabel,
                        formattedDate,
                        Math.max(0, value)
                    ]);
                });

                // –°–æ–∑–¥–∞–µ–º HTML —Ç–∞–±–ª–∏—Ü—É –¥–ª—è Excel —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
                const htmlContent = `
<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - ${categoryLabel}</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            font-family: Arial, sans-serif;
            font-size: 12px;
        }
        th {
            background-color: #4472C4;
            color: white;
            font-weight: bold;
            text-align: center;
            padding: 8px;
            border: 1px solid #000000;
        }
        td {
            padding: 6px;
            border: 1px solid #000000;
            text-align: left;
            vertical-align: top;
        }
        .number {
            text-align: right;
            mso-number-format: "#,##0";
        }
        .date {
            text-align: center;
            mso-number-format: "dd.mm.yyyy";
        }
        .category {
            text-align: left;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <table>
        <thead>
            <tr>
                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                <th>–î–∞—Ç–∞</th>
                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
            </tr>
        </thead>
        <tbody>
            ${excelData.slice(1).map(row => `
                <tr>
                    <td class="category">${row[0]}</td>
                    <td class="date">${row[1]}</td>
                    <td class="number">${row[2]}</td>
                </tr>
            `).join('')}
        </tbody>
    </table>
</body>
</html>`;

                // –°–æ–∑–¥–∞–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
                const currentDate = new Date().toLocaleDateString('ru-RU').replace(/\./g, '-');
                const fileName = `—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞_${categoryLabel}_${currentDate}.xls`;
                
                const blob = new Blob([htmlContent], { type: 'application/vnd.ms-excel;charset=utf-8' });
                const link = document.createElement('a');
                
                if (link.download !== undefined) {
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', fileName);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    setTimeout(() => {
                        URL.revokeObjectURL(url);
                    }, 100);
                } else {
                    // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                    window.open('data:application/vnd.ms-excel;charset=utf-8,' + encodeURIComponent(htmlContent));
                }
            });
        }

        // –≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ –∫—Ä–∞—Å–∏–≤—ã–π HTML –æ—Ç—á—ë—Ç (–ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –ø–µ—Ä–∏–æ–¥—É)
        function exportStatisticsHTML() {
            const period = parseInt(document.getElementById('periodSelect').value);
            const selectedCategories = getSelectedCategories();

            if (selectedCategories.length === 0) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞');
                return;
            }

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ –¥–∞—Ç
            const dates = [];
            const today = new Date();
            for (let i = period - 1; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                dates.push(date);
            }

            // –°—Ç—Ä–æ–∏–º HTML
            const periodTextMap = { '1':'1 –¥–µ–Ω—å', '3':'3 –¥–Ω—è', '7':'7 –¥–Ω–µ–π', '30':'–ú–µ—Å—è—Ü', '90':'3 –º–µ—Å—è—Ü–∞', '180':'6 –º–µ—Å—è—Ü–µ–≤', '365':'12 –º–µ—Å—è—Ü–µ–≤' };
            const periodText = periodTextMap[String(period)] || `${period} –¥–Ω–µ–π`;
            const nowStr = new Date().toLocaleString('ru-RU');

            let tablesHTML = '';
            selectedCategories.forEach(category => {
                const label = getCategoryLabel(category);
                let rows = '';
                dates.forEach(d => {
                    const key = d.toISOString().split('T')[0];
                    let value = 0;
                    if (statisticsData[category] && statisticsData[category][key]) {
                        if (category === 'visits') {
                            const visitsData = statisticsData[category][key];
                            value = Array.isArray(visitsData) ? visitsData.length : (typeof visitsData === 'number' ? visitsData : 0);
                        } else {
                            value = statisticsData[category][key];
                        }
                    }
                    rows += `<tr><td class="date">${d.toLocaleDateString('ru-RU')}</td><td class="num">${Math.max(0, value)}</td></tr>`;
                });

                tablesHTML += `
                <div class="section">
                    <div class="section-title">${label}</div>
                    <table class="stat-table">
                        <thead>
                            <tr><th>–î–∞—Ç–∞</th><th class="num">–ó–Ω–∞—á–µ–Ω–∏–µ</th></tr>
                        </thead>
                        <tbody>
                            ${rows}
                        </tbody>
                    </table>
                </div>`;
            });

            const html = `
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Äî –¶–µ–Ω—Ç—Ä –ö–∏–Ω–æ‚Ñ¢</title>
    <style>
        body { font-family: Arial, Helvetica, sans-serif; background:#fff; color:#222; padding:20px; }
        .header { text-align:center; margin-bottom:25px; }
        .title { font-size:24px; font-weight:700; }
        .subtitle { color:#666; margin-top:6px; }
        .controls { text-align:center; margin-bottom:20px; }
        .btn { display:inline-block; background:#000; color:#fff; border:none; padding:10px 16px; border-radius:6px; cursor:pointer; margin:0 6px; }
        .btn.secondary { background:#666; }
        .section { margin:22px 0; }
        .section-title { font-weight:700; margin-bottom:10px; }
        .stat-table { width:100%; border-collapse:collapse; background:#fff; }
        .stat-table th { background:#111; color:#fff; text-align:left; padding:10px; }
        .stat-table td { padding:10px; border-bottom:1px solid #eee; }
        .num { text-align:right; }
        .date { white-space:nowrap; }
        @media print { .controls { display:none !important; } }
    </style>
    </head>
    <body>
        <div class="controls">
            <button class="btn" onclick="window.print()">–ü–µ—á–∞—Ç—å</button>
            <button class="btn secondary" onclick="window.close()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
        <div class="header">
            <div class="title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Äî –¶–µ–Ω—Ç—Ä –ö–∏–Ω–æ‚Ñ¢</div>
            <div class="subtitle">–ü–µ—Ä–∏–æ–¥: ${periodText} ¬∑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ: ${nowStr}</div>
        </div>
        ${tablesHTML}
    </body>
</html>`;

            const blob = new Blob([html], { type: 'text/html;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞_${new Date().toISOString().slice(0,10)}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            setTimeout(() => URL.revokeObjectURL(url), 200);
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏)
        function generateTestData() {
            const today = new Date();
            const testData = {
                visits: {},
                orders: {},
                catalog: {},
                newArrivals: {},
                kinoshlep: {},
                registrations: {}
            };

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞—á–∏–Ω–∞—è —Å 30 –∏—é–ª—è
            const startDate = new Date('2024-07-30');
            const daysDiff = Math.floor((today - startDate) / (1000 * 60 * 60 * 24));
            
            for (let i = 0; i <= daysDiff; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                const dateStr = date.toISOString().split('T')[0];
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π
                const uniqueVisitors = [];
                const visitorCount = Math.floor(Math.random() * 50) + 30;
                for (let j = 0; j < visitorCount; j++) {
                    uniqueVisitors.push(`visitor_${Math.random().toString(36).substr(2, 9)}`);
                }
                testData.visits[dateStr] = uniqueVisitors;
                
                testData.orders[dateStr] = Math.floor(Math.random() * 15) + 3;
                testData.catalog[dateStr] = Math.floor(Math.random() * 35) + 15;
                testData.newArrivals[dateStr] = Math.floor(Math.random() * 25) + 10;
                testData.kinoshlep[dateStr] = Math.floor(Math.random() * 8) + 1;
                testData.registrations[dateStr] = Math.floor(Math.random() * 5) + 1;
            }

            localStorage.setItem('statisticsData', JSON.stringify(testData));
            statisticsData = testData;
        }

        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
        function forceInitChart() {
            console.log('–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞...');
            initStatisticsChart();
        }



        function updateOrderStatus(orderId, newStatus) {
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const orderIndex = orders.findIndex(order => order.id === orderId);
            
            if (orderIndex !== -1) {
                orders[orderIndex].status = newStatus;
                
                // –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω", –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —Ç—Ä–µ–∫–∏–Ω–≥–∞
                if (newStatus === '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω') {
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–∫–∞–∑—ã —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Å–µ–∫—Ü–∏—é —Ç—Ä–µ–∫–∏–Ω–≥–∞
                    setTimeout(() => loadOrders(), 100);
                }
                
                localStorage.setItem('orders', JSON.stringify(orders));
                console.log(`–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ ${orderId} –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ${newStatus}`);
            }
        }

        function updateTrackingNumber(orderId, trackingNumber) {
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const orderIndex = orders.findIndex(order => order.id === orderId);
            
            if (orderIndex !== -1) {
                orders[orderIndex].trackingNumber = trackingNumber;
                localStorage.setItem('orders', JSON.stringify(orders));
            }
        }

        function updateTrackingLink(orderId, trackingLink) {
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const orderIndex = orders.findIndex(order => order.id === orderId);
            
            if (orderIndex !== -1) {
                orders[orderIndex].trackingLink = trackingLink;
                localStorage.setItem('orders', JSON.stringify(orders));
            }
        }

        function confirmTracking(orderId) {
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const orderIndex = orders.findIndex(order => order.id === orderId);
            
            if (orderIndex !== -1) {
                const order = orders[orderIndex];
                if (order.trackingLink) {
                    // –°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —Ç—Ä–µ–∫–∏–Ω–≥–∞ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–∫–∞–∑—ã
                    orders[orderIndex].trackingConfirmed = true;
                    localStorage.setItem('orders', JSON.stringify(orders));
                    loadOrders(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    console.log(`–¢—Ä–µ–∫–∏–Ω–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω –¥–ª—è –∑–∞–∫–∞–∑–∞ ${orderId}`);
                } else {
                    console.log('–°—Å—ã–ª–∫–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞');
                }
            }
        }

        function expandTrackingSection(orderId) {
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const orderIndex = orders.findIndex(order => order.id === orderId);
            
            if (orderIndex !== -1) {
                // –£–±–∏—Ä–∞–µ–º —Ñ–ª–∞–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–∫–∞–∑—ã
                orders[orderIndex].trackingConfirmed = false;
                localStorage.setItem('orders', JSON.stringify(orders));
                loadOrders(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞ –∏–∑ localStorage
        function getProductData(productId) {
            // –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ (–∫–ª—é—á–∏ product_${id})
            const productData = localStorage.getItem(`product_${productId}`);
            if (productData) {
                try {
                    const product = JSON.parse(productData);
                    return product;
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏:', error);
                }
            }
            
            // –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏, –∏—â–µ–º –≤ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            const oldProducts = JSON.parse(localStorage.getItem('products') || '[]');
            const product = oldProducts.find(p => p.id === parseInt(productId));
            
            if (product) {
                return product;
            }
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ —Ç–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω
            return {
                id: parseInt(productId),
                name: '–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω',
                category: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                price: 0,
                images: []
            };
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        let currentFilter = 'all';
        let lastViewedOrderId = null;
        let currentPage = 1;
        const ordersPerPage = 6;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–∞–∫–∞–∑–∞—Ö
        function initOrderNotifications() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–∞–∫–∞–∑–∞—Ö...');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑ –∏–∑ localStorage
            const savedLastViewed = localStorage.getItem('lastViewedOrderId');
            if (savedLastViewed) {
                lastViewedOrderId = parseInt(savedLastViewed);
                console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑ –∏–∑ localStorage: ${lastViewedOrderId}`);
            } else {
                // –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤ 0 (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã –∫–∞–∫ –Ω–æ–≤—ã–µ)
                lastViewedOrderId = 0;
                localStorage.setItem('lastViewedOrderId', lastViewedOrderId);
                console.log('–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑ –≤ 0 (–≤—Å–µ –∑–∞–∫–∞–∑—ã –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –∫–∞–∫ –Ω–æ–≤—ã–µ)');
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
            setInterval(checkNewOrders, 10000);
            console.log('–¢–∞–π–º–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∑–∞–ø—É—â–µ–Ω (–∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥)');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            checkNewOrders();
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤
        function checkNewOrders() {
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const lastViewed = parseInt(localStorage.getItem('lastViewedOrderId') || '0');
            
            // –ù–∞—Ö–æ–¥–∏–º –Ω–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã (—Å ID –±–æ–ª—å—à–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–≥–æ)
            const newOrders = orders.filter(order => order.id > lastViewed);
            
            const notificationBadge = document.getElementById('ordersNotification');
            if (newOrders.length > 0) {
                notificationBadge.textContent = newOrders.length;
                notificationBadge.style.display = 'flex';
                console.log(`–ù–∞–π–¥–µ–Ω–æ ${newOrders.length} –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤`);
            } else {
                notificationBadge.style.display = 'none';
            }
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤
        function filterOrders(filter) {
            currentFilter = filter;
            currentPage = 1; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –Ω–∞ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏ —Å–º–µ–Ω–µ —Ñ–∏–ª—å—Ç—Ä–∞
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É —Ñ–∏–ª—å—Ç—Ä–∞
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
            loadOrders();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
        function loadOrders() {
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const ordersList = document.getElementById('ordersList');
            const paginationContainer = document.getElementById('ordersPagination');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –∑–∞–∫–∞–∑—ã –ø–æ —Å—Ç–∞—Ç—É—Å—É
            let filteredOrders = orders;
            if (currentFilter !== 'all') {
                filteredOrders = orders.filter(order => order.status === currentFilter);
            }
            
            if (filteredOrders.length === 0) {
                const filterText = currentFilter === 'all' ? '–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç' : 
                                 `–ó–∞–∫–∞–∑–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "${currentFilter}" –Ω–µ—Ç`;
                ordersList.innerHTML = `<p style="color: #888; text-align: center;">${filterText}</p>`;
                paginationContainer.innerHTML = '';
                return;
            }

            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∑–∞–∫–∞–∑—ã –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)
            filteredOrders.sort((a, b) => new Date(b.date) - new Date(a.date));

            // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
            const totalPages = Math.ceil(filteredOrders.length / ordersPerPage);
            const startIndex = (currentPage - 1) * ordersPerPage;
            const endIndex = startIndex + ordersPerPage;
            const paginatedOrders = filteredOrders.slice(startIndex, endIndex);

            ordersList.innerHTML = paginatedOrders.map(order => `
                <div class="order-item">
                    <div class="order-header">
                        <div class="order-info">
                            <h4>–ó–∞–∫–∞–∑ #${order.orderNumber}</h4>
                            <p>–î–∞—Ç–∞: ${new Date(order.date).toLocaleDateString('ru-RU')}</p>
                            <p>Email: ${order.userEmail}</p>
                            <p>–°—É–º–º–∞: ${order.total.toLocaleString()} ‚ÇΩ</p>
                            ${order.userProfile ? `
                                <div class="user-profile-info">
                                    <h5>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:</h5>
                                    <p>–§–ò–û: ${order.userProfile.lastName || ''} ${order.userProfile.firstName || ''} ${order.userProfile.middleName || ''}</p>
                                    <p>–¢–µ–ª–µ—Ñ–æ–Ω: ${order.userProfile.phone || ''}</p>
                                    <p>–ê–¥—Ä–µ—Å: ${order.userProfile.postalCode || ''}, ${order.userProfile.country || ''}, ${order.userProfile.city || ''}, ${order.userProfile.street || ''}, ${order.userProfile.house || ''}${order.userProfile.apartment ? ', –∫–≤. ' + order.userProfile.apartment : ''}</p>
                                    ${order.userProfile.messenger ? `<p>–ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä: ${order.userProfile.messenger}</p>` : ''}
                                </div>
                            ` : ''}
                        </div>
                        <div class="order-status-controls">
                            <select class="status-select" onchange="updateOrderStatus(${order.id}, this.value)">
                                <option value="–í —Å–±–æ—Ä–∫–µ" ${order.status === '–í —Å–±–æ—Ä–∫–µ' ? 'selected' : ''}>–í —Å–±–æ—Ä–∫–µ</option>
                                <option value="–û—Ç–ø—Ä–∞–≤–ª–µ–Ω" ${order.status === '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' ? 'selected' : ''}>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω</option>
                                <option value="–î–æ—Å—Ç–∞–≤–ª–µ–Ω" ${order.status === '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' ? 'selected' : ''}>–î–æ—Å—Ç–∞–≤–ª–µ–Ω</option>
                            </select>
                            ${order.status === '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' ? `
                                <div class="tracking-section ${order.trackingConfirmed ? 'collapsed' : 'show'}" data-order-id="${order.id}">
                                    ${order.trackingConfirmed ? `
                                        <button class="expand-btn" onclick="expandTrackingSection(${order.id})">+</button>
                                    ` : ''}
                                    <div class="tracking-inputs">
                                        <input type="text" class="tracking-input" placeholder="–¢—Ä–µ–∫ –Ω–æ–º–µ—Ä (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" 
                                               value="${order.trackingNumber || ''}" 
                                               onchange="updateTrackingNumber(${order.id}, this.value)">
                                        <input type="text" class="tracking-input" placeholder="–°—Å—ã–ª–∫–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è" 
                                               value="${order.trackingLink || ''}" 
                                               onchange="updateTrackingLink(${order.id}, this.value)">
                                        <button class="confirm-btn" onclick="confirmTracking(${order.id})">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    <div class="order-items">
                        ${order.items.map(item => {
                            // –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                            const productData = getProductData(item.id);
                            const productImage = productData.images && productData.images.length > 0 ? productData.images[0] : null;
                            
                            return `
                            <div class="order-item-detail">
                                <div class="item-image">
                                    ${productImage ? 
                                        `<img src="${productImage}" alt="${item.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 4px;">` :
                                        `<div class="item-number">${item.id}</div>`
                                    }
                                </div>
                                <div class="item-details">
                                    <div class="item-name">${item.name}</div>
                                    <div class="item-info">–†–∞–∑–º–µ—Ä: ${item.size}</div>
                                    <div class="item-info">–¶–≤–µ—Ç: ${item.color}</div>
                                    <div class="item-info">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${item.quantity}</div>
                                    <div class="item-info">–¶–µ–Ω–∞: ${item.price.toLocaleString()} ‚ÇΩ</div>
                                </div>
                            </div>
                        `;
                        }).join('')}
                    </div>
                </div>
            `).join('');

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é
            generatePagination(totalPages, currentPage);
        }

        // –§—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
        function generatePagination(totalPages, currentPage) {
            const paginationContainer = document.getElementById('ordersPagination');
            
            if (totalPages <= 1) {
                paginationContainer.innerHTML = '';
                return;
            }

            let paginationHTML = '';
            
            // –ö–Ω–æ–ø–∫–∞ "–ü—Ä–µ–¥—ã–¥—É—â–∞—è"
            paginationHTML += `<button class="pagination-btn" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>–ü—Ä–µ–¥—ã–¥—É—â–∞—è</button>`;
            
            // –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                    paginationHTML += `<button class="pagination-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
                } else if (i === currentPage - 2 || i === currentPage + 2) {
                    paginationHTML += `<span class="pagination-btn" style="cursor: default;">...</span>`;
                }
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–°–ª–µ–¥—É—é—â–∞—è"
            paginationHTML += `<button class="pagination-btn" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>–°–ª–µ–¥—É—é—â–∞—è</button>`;
            
            paginationContainer.innerHTML = paginationHTML;
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function changePage(page) {
            currentPage = page;
            loadOrders();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –≤–∫–ª–∞–¥–∫–∏ –∑–∞–∫–∞–∑–æ–≤
        function showTab(tabName) {
            console.log('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É:', tabName);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName).classList.add('active');
            
            // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≥—Ä–∞—Ñ–∏–∫
            if (tabName === 'statistics') {
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è canvas
                setTimeout(() => {
                    console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...');
                    initStatisticsChart();
                }, 100);
            }
            
            // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∑–∞–∫–∞–∑—ã, –∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –∏ —Å–∫—Ä—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (tabName === 'orders') {
                setTimeout(() => {
                    console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...');
                    loadOrders();
                    // –°–∫—Ä—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑
                    hideOrderNotification();
                    console.log('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–∫–∞–∑–∞—Ö —Å–∫—Ä—ã—Ç–æ');
                }, 100);
            }
            
            // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ç–æ–≤–∞—Ä—ã, –∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
            if (tabName === 'products') {
                setTimeout(() => {
                    console.log('–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...');
                    loadProducts();
                }, 100);
            }
            
            // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ–±—Ä–∞—â–µ–Ω–∏—è, –∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞—â–µ–Ω–∏–π –∏ —Å–∫—Ä—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (tabName === 'appeals') {
                setTimeout(() => {
                    console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π...');
                    loadAppeals();
                    // –°–∫—Ä—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –æ–±—Ä–∞—â–µ–Ω–∏–µ
                    hideAppealsNotification();
                    console.log('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –æ–±—Ä–∞—â–µ–Ω–∏—è—Ö —Å–∫—Ä—ã—Ç–æ');
                }, 100);
            }
            
            // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ—Ç—á–µ—Ç—ã, –∑–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç—á–µ—Ç—ã
            if (tabName === 'reports') {
                setTimeout(() => {
                    console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç—á–µ—Ç–æ–≤...');
                    loadReports();
                }, 100);
            }
        }

        // –°–∫—Ä—ã—Ç–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–∫–∞–∑–∞—Ö
        function hideOrderNotification() {
            const notificationBadge = document.getElementById('ordersNotification');
            notificationBadge.style.display = 'none';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            if (orders.length > 0) {
                const maxOrderId = Math.max(...orders.map(order => order.id));
                localStorage.setItem('lastViewedOrderId', maxOrderId);
                lastViewedOrderId = maxOrderId;
                console.log(`–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ, –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑: ${maxOrderId}`);
            }
        }

        // ===== –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –¢–û–í–ê–†–ê–ú–ò =====

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤
        let editingProductId = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
        function initProducts() {
            console.log('–§—É–Ω–∫—Ü–∏—è initProducts –≤—ã–∑–≤–∞–Ω–∞');
            
            // –ü—Ä–æ—Å—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–æ–≤–∞—Ä—ã, –Ω–µ —Å–æ–∑–¥–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ
            loadProducts();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
        function showAddProductForm() {
            editingProductId = null;
            document.getElementById('productFormTitle').textContent = '–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä';
            clearProductForm();
            document.getElementById('productFormContainer').style.display = 'block';
            console.log('–§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –æ—Ç–∫—Ä—ã—Ç–∞, editingProductId:', editingProductId);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
        function showEditProductForm(productId) {
            console.log('–ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ —Å ID:', productId);
            editingProductId = productId;
            document.getElementById('productFormTitle').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä';
            
            const productData = localStorage.getItem(`product_${productId}`);
            if (productData) {
                try {
                    const product = JSON.parse(productData);
                    console.log('–ù–∞–π–¥–µ–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä:', product);
                    console.log('–ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞...');
                    fillProductForm(product);
                    document.getElementById('productFormContainer').style.display = 'block';
                    console.log('–§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–∫—Ä—ã—Ç–∞');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–æ–≤–∞—Ä–∞:', error);
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–æ–≤–∞—Ä–∞!');
                }
            } else {
                console.error('–¢–æ–≤–∞—Ä —Å ID', productId, '–Ω–µ –Ω–∞–π–¥–µ–Ω!');
                alert('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω!');
            }
        }

        // –°–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É —Ç–æ–≤–∞—Ä–∞
        function hideProductForm() {
            document.getElementById('productFormContainer').style.display = 'none';
            editingProductId = null;
            clearProductForm();
        }

        // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É —Ç–æ–≤–∞—Ä–∞
        function clearProductForm() {
            document.getElementById('productId').value = '';
            document.getElementById('productArticle').value = '';
            document.getElementById('productName').value = '';
            document.getElementById('productDescription').value = '';
            document.getElementById('productPrice').value = '';
            document.getElementById('productCategory').value = '';
            document.getElementById('productMaterial').value = '';
            document.getElementById('productSeason').value = '';
            document.getElementById('productStyle').value = '';
            document.getElementById('productCountry').value = '';
            document.getElementById('productSizes').value = '';
            document.getElementById('productColors').value = '';
            document.getElementById('productImages').value = '';
            document.getElementById('productWashing').value = '';
            document.getElementById('productComposition').value = '';
            document.getElementById('productCare').value = '';
            
            // –û—á–∏—â–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ —Ü–≤–µ—Ç–æ–≤
            document.querySelectorAll('#sizesContainer .option-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelectorAll('#colorsContainer .option-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // –û—á–∏—â–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            document.querySelectorAll('.category-checkboxes input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            for (let i = 1; i <= 4; i++) {
                const previewContainer = document.getElementById(`imagePreview${i}`);
                if (previewContainer) {
                    previewContainer.innerHTML = '';
                }
                const fileInput = document.getElementById(`imageUpload${i}`);
                if (fileInput) {
                    fileInput.value = '';
                }
            }
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º editingProductId –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Ñ–æ—Ä–º—ã
            editingProductId = null;
        }

        // –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞
        function fillProductForm(product) {
            console.log('–ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É —Ç–æ–≤–∞—Ä–æ–º:', product);
            
            try {
                document.getElementById('productId').value = product.id;
                document.getElementById('productArticle').value = product.article;
                document.getElementById('productName').value = product.name;
                document.getElementById('productDescription').value = product.description;
                document.getElementById('productPrice').value = product.price;
                document.getElementById('productCategory').value = product.category;
                document.getElementById('productMaterial').value = product.material;
                document.getElementById('productSeason').value = product.season;
                document.getElementById('productStyle').value = product.style;
                document.getElementById('productCountry').value = product.country;
                document.getElementById('productSizes').value = product.sizes.join(', ');
                document.getElementById('productColors').value = product.colors.join(', ');
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –∫–∞–∫ JSON, —á—Ç–æ–±—ã –Ω–µ –ª–æ–º–∞—Ç—å data URL (—Ç–∞–º –µ—Å—Ç—å –∑–∞–ø—è—Ç—ã–µ)
            document.getElementById('productImages').value = JSON.stringify(product.images);
                document.getElementById('productWashing').value = product.washing;
                document.getElementById('productComposition').value = product.composition;
                document.getElementById('productCare').value = product.care;
                
                console.log('–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–ª–µ–π:', error);
            }
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –∫–Ω–æ–ø–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–≤
            document.querySelectorAll('#sizesContainer .option-btn').forEach(btn => {
                btn.classList.remove('selected');
                if (product.sizes.includes(btn.dataset.value)) {
                    btn.classList.add('selected');
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ —Ä–∞–∑–º–µ—Ä–æ–≤
            updateHiddenInput('productSizes', '#sizesContainer .option-btn.selected');
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –∫–Ω–æ–ø–∫–∏ —Ü–≤–µ—Ç–æ–≤
            document.querySelectorAll('#colorsContainer .option-btn').forEach(btn => {
                btn.classList.remove('selected');
                if (product.colors.includes(btn.dataset.value)) {
                    btn.classList.add('selected');
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ —Ü–≤–µ—Ç–æ–≤
            updateHiddenInput('productColors', '#colorsContainer .option-btn.selected');
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            const categories = Array.isArray(product.category) ? product.category : (product.category ? product.category.split(',').map(c => c.trim()) : []);
            document.querySelectorAll('.category-checkboxes input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = categories.includes(checkbox.value);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            updateHiddenInput('productCategory', '.category-checkboxes input[type="checkbox"]:checked');
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            const images = Array.isArray(product.images) ? product.images : (product.images ? product.images.split(',').map(img => img.trim()) : []);
            for (let i = 1; i <= 4; i++) {
                const previewContainer = document.getElementById(`imagePreview${i}`);
                if (previewContainer && images[i-1] && images[i-1] !== '') {
                    previewContainer.innerHTML = `
                        <img src="${images[i-1]}" alt="Preview ${i}">
                        <button type="button" class="remove-image" onclick="removeSingleImage(${i})">√ó</button>
                    `;
                } else if (previewContainer) {
                    previewContainer.innerHTML = '';
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
            updateImagesHiddenInput();
        }

                // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä
        function saveProduct() {
            try {
                console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞...');
                console.log('editingProductId:', editingProductId);
                
                const productData = {
                    id: parseInt(document.getElementById('productId').value),
                    article: document.getElementById('productArticle').value,
                    name: document.getElementById('productName').value,
                    description: document.getElementById('productDescription').value,
                    price: parseInt(document.getElementById('productPrice').value),
                    category: document.getElementById('productCategory').value,
                    material: document.getElementById('productMaterial').value,
                    season: document.getElementById('productSeason').value,
                    style: document.getElementById('productStyle').value,
                    country: document.getElementById('productCountry').value,
                    sizes: document.getElementById('productSizes').value ? document.getElementById('productSizes').value.split(',').map(s => s.trim()).filter(s => s) : [],
                    colors: document.getElementById('productColors').value ? document.getElementById('productColors').value.split(',').map(s => s.trim()).filter(s => s) : [],
                // –ß–∏—Ç–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Å–∫—Ä—ã—Ç–æ–≥–æ –ø–æ–ª—è (JSON). –§–æ–ª–±—ç–∫: –µ—Å–ª–∏ –ø–æ–ø–∞–¥–µ—Ç —Å—Ç—Ä–æ–∫–∞ –±–µ–∑ JSON, –∑–∞–≤–µ—Ä–Ω–µ–º –µ—ë –≤ –º–∞—Å—Å–∏–≤
                images: (function(){
                    const raw = document.getElementById('productImages').value;
                    if (!raw) return [];
                    try {
                        const parsed = JSON.parse(raw);
                        return Array.isArray(parsed) ? parsed : (typeof parsed === 'string' ? [parsed] : []);
                    } catch (_) {
                        // –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç —á–µ—Ä–µ–∑ join(','): –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º, —á—Ç–æ–±—ã –Ω–µ –ª–æ–º–∞—Ç—å base64. –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤.
                        return [];
                    }
                })(),
                    washing: document.getElementById('productWashing').value,
                    composition: document.getElementById('productComposition').value,
                    care: document.getElementById('productCare').value
                };
                
                console.log('–î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', productData);

                // –í–∞–ª–∏–¥–∞—Ü–∏—è
                if (!productData.id || !productData.name || !productData.price) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: ID, –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω–∞');
                    return;
                }

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä –æ—Ç–¥–µ–ª—å–Ω–æ
                try {
                    if (editingProductId !== null) {
                        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–æ–≤–∞—Ä–∞
                        localStorage.setItem(`product_${editingProductId}`, JSON.stringify(productData));
                        console.log('–¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω:', productData);
                    } else {
                        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–æ–≤–∞—Ä —Å —Ç–∞–∫–∏–º ID
                        if (localStorage.getItem(`product_${productData.id}`)) {
                            alert('–¢–æ–≤–∞—Ä —Å —Ç–∞–∫–∏–º ID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!');
                            return;
                        }
                        localStorage.setItem(`product_${productData.id}`, JSON.stringify(productData));
                        console.log('–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω:', productData);
                    }
                } catch (error) {
                    if (error.name === 'QuotaExceededError') {
                        alert('–û—à–∏–±–∫–∞: –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–∞! –£–¥–∞–ª–∏—Ç–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–æ–≤–∞—Ä—ã –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.');
                        return;
                    } else {
                        throw error;
                    }
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ ID —Ç–æ–≤–∞—Ä–æ–≤
                updateProductsList();

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö
                updateProductsForSelection();

                hideProductForm();
                loadProducts();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä localStorage –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                checkStorageSize();
                
                alert(editingProductId !== null ? '–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!' : '–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞: ' + error.message);
            }
        }

        // –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä
        function deleteProduct(productId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')) {
                localStorage.removeItem(`product_${productId}`);
                updateProductsList();
                updateProductsForSelection();
                loadProducts();
                alert('–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
        function loadProducts() {
            console.log('–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...');
            const products = getAllProducts();
            const productsList = document.getElementById('productsList');
            
            console.log('–ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤:', products.length);
            
            if (products.length === 0) {
                console.log('–¢–æ–≤–∞—Ä–æ–≤ –Ω–µ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ');
                productsList.innerHTML = '<p style="color: #888; text-align: center; grid-column: 1 / -1;">–¢–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
                return;
            }

            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∞ —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
            function renderProductsList(products) {
                return products.map(product => `
                    <div class="product-item">
                        <div class="product-header">
                            <div class="product-info">
                                <h4>
                                    ${product.name}
                                </h4>
                                <p><strong>ID:</strong> ${product.id}</p>
                                <p><strong>–ê—Ä—Ç–∏–∫—É–ª:</strong> ${product.article}</p>
                                <p><strong>–¶–µ–Ω–∞:</strong> ${product.price.toLocaleString()} ‚ÇΩ</p>
                                <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${product.category}</p>
                            </div>
                            <div class="product-actions">
                                <button class="edit-product-btn" onclick="showEditProductForm(${product.id})">
                                    ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                                <button class="delete-product-btn" onclick="deleteProduct(${product.id})">
                                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </div>
                        </div>
                        <div class="product-details">
                            <h5>–î–µ—Ç–∞–ª–∏ —Ç–æ–≤–∞—Ä–∞:</h5>
                            <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${product.description}</p>
                            <p><strong>–ú–∞—Ç–µ—Ä–∏–∞–ª:</strong> ${product.material}</p>
                            <p><strong>–°–µ–∑–æ–Ω:</strong> ${product.season}</p>
                            <p><strong>–°—Ç–∏–ª—å:</strong> ${product.style}</p>
                            <p><strong>–°—Ç—Ä–∞–Ω–∞:</strong> ${product.country}</p>
                            <p><strong>–†–∞–∑–º–µ—Ä—ã:</strong> ${product.sizes.join(', ')}</p>
                            <p><strong>–¶–≤–µ—Ç–∞:</strong> ${product.colors.join(', ')}</p>
                            <p><strong>–°—Ç–∏—Ä–∫–∞:</strong> ${product.washing}</p>
                            <p><strong>–°–æ—Å—Ç–∞–≤:</strong> ${product.composition}</p>
                            <p><strong>–£—Ö–æ–¥:</strong> ${product.care}</p>
                            <div class="product-images">
                                <h5>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</h5>
                                ${product.images.map((img, index) => {
                                    if (img && img.trim() !== '' && isValidImageData(img)) {
                                        return `
                                    <div class="product-image-preview">
                                                <img src="${img}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ${index + 1}" style="max-width: 100px; max-height: 100px; object-fit: cover; border-radius: 4px;" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                                <span style="color: #999; display: none;">–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–æ</span>
                                    </div>
                                        `;
                                    } else {
                                        return `
                                            <div class="product-image-preview">
                                                <span style="color: #999;">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span>
                                            </div>
                                        `;
                                    }
                                }).join('')}
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            productsList.innerHTML = renderProductsList(products);
            
            console.log('–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω');
        }





        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            console.log('–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –Ω–∞—á–∏–Ω–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é...');
            
            try {
                console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤...');
                initProducts();
                console.log('–¢–æ–≤–∞—Ä—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
                
                console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Ñ–æ—Ä–º—ã...');
                initProductFormHandlers();
                console.log('–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ–æ—Ä–º—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
                
                console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ' + error.message);
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Ñ–æ—Ä–º—ã —Ç–æ–≤–∞—Ä–∞
        function initProductFormHandlers() {
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ä–∞–∑–º–µ—Ä–æ–≤
            const sizeButtons = document.querySelectorAll('#sizesContainer .option-btn');
            sizeButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    updateHiddenInput('productSizes', '#sizesContainer .option-btn.selected');
                });
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ü–≤–µ—Ç–æ–≤
            const colorButtons = document.querySelectorAll('#colorsContainer .option-btn');
            colorButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    updateHiddenInput('productColors', '#colorsContainer .option-btn.selected');
                });
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            const categoryCheckboxes = document.querySelectorAll('.category-checkboxes input[type="checkbox"]');
            categoryCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    updateHiddenInput('productCategory', '.category-checkboxes input[type="checkbox"]:checked');
                });
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (4 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –±–ª–æ–∫–∞)
            for (let i = 1; i <= 4; i++) {
                const imageUploadArea = document.getElementById(`imageUploadArea${i}`);
                const imageUpload = document.getElementById(`imageUpload${i}`);

                if (imageUploadArea && imageUpload) {
                    imageUploadArea.addEventListener('click', () => imageUpload.click());
                    
                    imageUpload.addEventListener('change', (e) => {
                        handleSingleImage(e.target.files[0], i);
                    });
                }
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ –ø–æ–ª—è
        function updateHiddenInput(inputId, selector) {
            const selectedElements = document.querySelectorAll(selector);
            const values = Array.from(selectedElements).map(element => {
                // –î–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º value, –¥–ª—è –∫–Ω–æ–ø–æ–∫ - data-value
                return element.value || element.dataset.value;
            });
            document.getElementById(inputId).value = values.join(', ');
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–∂–∞—Ç–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function compressImage(file, maxWidth = 1920, quality = 0.9) {
            return new Promise((resolve, reject) => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = function() {
                    // –í—ã—á–∏—Å–ª—è–µ–º –Ω–æ–≤—ã–µ —Ä–∞–∑–º–µ—Ä—ã
                    let { width, height } = img;
                    if (width > maxWidth) {
                        height = (height * maxWidth) / width;
                        width = maxWidth;
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    
                    // –†–∏—Å—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ base64 —Å —Å–∂–∞—Ç–∏–µ–º
                    const compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
                    resolve(compressedDataUrl);
                };
                
                img.onerror = reject;
                img.src = URL.createObjectURL(file);
            });
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ —Ñ–∞–π–ª —Å —Å–∂–∞—Ç–∏–µ–º
        async function handleSingleImage(file, imageIndex) {
            if (file && file.type.startsWith('image/')) {
                try {
                    // –°–∂–∏–º–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                    const compressedImageUrl = await compressImage(file);
                    
                // –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
                const timestamp = Date.now() + imageIndex;
                const fileName = `product_${timestamp}_${file.name}`;
                const filePath = `images/${fileName}`;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ
                const imageInfo = {
                    path: filePath,
                    name: fileName,
                    size: file.size,
                    type: file.type,
                        timestamp: timestamp,
                        compressedSize: compressedImageUrl.length
                };
                localStorage.setItem(`image_${timestamp}`, JSON.stringify(imageInfo));
                
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é —Å–∂–∞—Ç–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    const previewContainer = document.getElementById(`imagePreview${imageIndex}`);
                    previewContainer.innerHTML = `
                        <img src="${compressedImageUrl}" alt="Preview ${imageIndex}" style="width: 100%; height: 100%; object-fit: cover;">
                        <button type="button" class="remove-image" onclick="removeSingleImage(${imageIndex})">√ó</button>
                    `;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ
                    updateImagesHiddenInput();
                    
                    console.log(`‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ${imageIndex} —Å–∂–∞—Ç–æ: ${(file.size/1024/1024).toFixed(2)}MB ‚Üí ${(compressedImageUrl.length*0.75/1024/1024).toFixed(2)}MB`);
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∂–∞—Ç–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', error);
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ' + error.message);
                }
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function removeSingleImage(imageIndex) {
            const previewContainer = document.getElementById(`imagePreview${imageIndex}`);
            previewContainer.innerHTML = '';
            
            // –û—á–∏—â–∞–µ–º input —Ñ–∞–π–ª–∞
            const fileInput = document.getElementById(`imageUpload${imageIndex}`);
            fileInput.value = '';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ
            updateImagesHiddenInput();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ –ø–æ–ª—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ - —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–∂–∞—Ç—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function updateImagesHiddenInput() {
            const hiddenInput = document.getElementById('productImages');
            const images = [];
            
            for (let i = 1; i <= 4; i++) {
                const previewContainer = document.getElementById(`imagePreview${i}`);
                const img = previewContainer.querySelector('img');
                if (img && img.src) {
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–∂–∞—Ç–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é
                    images.push(img.src);
                } else {
                    images.push(''); // –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                }
            }
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ –∫–∞–∫ JSON, —á—Ç–æ–±—ã –∑–∞–ø—è—Ç—ã–µ –≤ data URL –Ω–µ –ª–æ–º–∞–ª–∏ —Ñ–æ—Ä–º–∞—Ç
            hiddenInput.value = JSON.stringify(images);
        }

        // –û—á–∏—Å—Ç–∫–∞ localStorage
        function clearStorage() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ? –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ —Ç–æ–≤–∞—Ä—ã, –∑–∞–∫–∞–∑—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É!')) {
                try {
                    // –û—á–∏—â–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
                    const productIds = JSON.parse(localStorage.getItem('productIds') || '[]');
                    productIds.forEach(id => {
                        localStorage.removeItem(`product_${id}`);
                    });
                    localStorage.removeItem('productIds');
                    
                    // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
                    localStorage.removeItem('products');
                    
                    // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    clearOldImages();
                    
                    alert('–¢–æ–≤–∞—Ä—ã –æ—á–∏—â–µ–Ω—ã! –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ.');
                    loadProducts();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Ç–æ–≤–∞—Ä–æ–≤:', error);
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Ç–æ–≤–∞—Ä–æ–≤: ' + error.message);
                }
            }
        }

        // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ localStorage
        function clearOldImages() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ localStorage? –≠—Ç–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç –º–µ—Å—Ç–æ –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.')) {
                try {
                    let clearedCount = 0;
                    const keysToRemove = [];
                    
                    // –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –∫–ª—é—á–∏ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
                    for (let i = 0; i < localStorage.length; i++) {
                        const key = localStorage.key(i);
                        if (key && key.startsWith('image_')) {
                            keysToRemove.push(key);
                        }
                    }
                    
                    // –£–¥–∞–ª—è–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏
                    keysToRemove.forEach(key => {
                        localStorage.removeItem(key);
                        clearedCount++;
                    });
                    
                    console.log(`üóëÔ∏è –û—á–∏—â–µ–Ω–æ ${clearedCount} —Å—Ç–∞—Ä—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ localStorage`);
                    alert(`‚úÖ –û—á–∏—â–µ–Ω–æ ${clearedCount} —Å—Ç–∞—Ä—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π! –ú–µ—Å—Ç–æ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ.`);
                    checkStorageSize();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Å—Ç–∞—Ä—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:', error);
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Å—Ç–∞—Ä—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ' + error.message);
                }
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ localStorage
        function checkStorageSize() {
            try {
                let totalSize = 0;
                const storageInfo = {};
                
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    const value = localStorage.getItem(key);
                    const size = new Blob([value]).size;
                    totalSize += size;
                    
                    if (key.startsWith('product_')) {
                        storageInfo.products = (storageInfo.products || 0) + size;
                    } else if (key.startsWith('image_')) {
                        storageInfo.images = (storageInfo.images || 0) + size;
                    } else {
                        storageInfo.other = (storageInfo.other || 0) + size;
                    }
                }
                
                const totalMB = (totalSize / 1024 / 1024).toFixed(2);
                const productsMB = ((storageInfo.products || 0) / 1024 / 1024).toFixed(2);
                const imagesMB = ((storageInfo.images || 0) / 1024 / 1024).toFixed(2);
                const otherMB = ((storageInfo.other || 0) / 1024 / 1024).toFixed(2);
                
                console.log(`üìä –†–∞–∑–º–µ—Ä localStorage: ${totalMB}MB (–¢–æ–≤–∞—Ä—ã: ${productsMB}MB, –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${imagesMB}MB, –û—Å—Ç–∞–ª—å–Ω–æ–µ: ${otherMB}MB)`);
                
                // –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –ø—Ä–µ–≤—ã—à–∞–µ—Ç 8MB
                if (totalSize > 8 * 1024 * 1024) {
                    console.warn(`‚ö†Ô∏è localStorage –ø–æ—á—Ç–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω: ${totalMB}MB`);
                    alert(`‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ! localStorage –ø–æ—á—Ç–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω (${totalMB}MB). –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ.`);
                }
                
                return { totalSize, storageInfo };
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ä–∞–∑–º–µ—Ä–∞ localStorage:', error);
                return null;
            }
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ base64)
        function isValidImageData(dataUrl) {
            if (!dataUrl || typeof dataUrl !== 'string') {
                return false;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ data URL
            if (!dataUrl.startsWith('data:image/')) {
                return false;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É (base64 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª–∏–Ω–Ω—ã–º)
            const base64Part = dataUrl.split(',')[1];
            if (!base64Part || base64Part.length < 100) {
                return false;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ base64 —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã
            const base64Regex = /^[A-Za-z0-9+/]*={0,2}$/;
            if (!base64Regex.test(base64Part)) {
                return false;
            }
            
            return true;
        }

        // –û—á–∏—Å—Ç–∫–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —Ç–æ–≤–∞—Ä–∞—Ö
        function cleanCorruptedImages() {
            try {
                let cleanedCount = 0;
                const productIds = JSON.parse(localStorage.getItem('productIds') || '[]');
                
                productIds.forEach(productId => {
                    const productKey = `product_${productId}`;
                    const productData = localStorage.getItem(productKey);
                    
                    if (productData) {
                        try {
                            const product = JSON.parse(productData);
                            
                            if (product.images && Array.isArray(product.images)) {
                                const originalLength = product.images.length;
                                product.images = product.images.filter(img => isValidImageData(img));
                                const newLength = product.images.length;
                                
                                if (newLength < originalLength) {
                                    cleanedCount += (originalLength - newLength);
                                    console.log(`üßπ –û—á–∏—â–µ–Ω–æ ${originalLength - newLength} –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —Ç–æ–≤–∞—Ä–µ ${productId}`);
                                    
                                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—á–∏—â–µ–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä
                                    localStorage.setItem(productKey, JSON.stringify(product));
                                }
                            }
                        } catch (e) {
                            console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ç–æ–≤–∞—Ä–∞ ${productId}:`, e);
                        }
                    }
                });
                
                if (cleanedCount > 0) {
                    console.log(`‚úÖ –û—á–∏—â–µ–Ω–æ ${cleanedCount} –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π`);
                    alert(`‚úÖ –û—á–∏—â–µ–Ω–æ ${cleanedCount} –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —Ç–æ–≤–∞—Ä–∞—Ö!`);
                }
                
                return cleanedCount;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:', error);
                return 0;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏)
        function clearOldData() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–æ–≤ (–∫–ª—é—á "products")?')) {
                try {
                    localStorage.removeItem('products');
                    alert('–°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã!');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö:', error);
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö: ' + error.message);
                }
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ ID —Ç–æ–≤–∞—Ä–æ–≤
        function updateProductsList() {
            const productIds = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('product_')) {
                    const id = key.replace('product_', '');
                    productIds.push(parseInt(id));
                }
            }
            localStorage.setItem('productIds', JSON.stringify(productIds));
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤
        function getAllProducts() {
            const productIds = JSON.parse(localStorage.getItem('productIds') || '[]');
            const products = [];
            
            productIds.forEach(id => {
                const productData = localStorage.getItem(`product_${id}`);
                if (productData) {
                    try {
                        const product = JSON.parse(productData);
                        
                        // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                        if (product.images && Array.isArray(product.images)) {
                            product.images = product.images.filter(img => isValidImageData(img));
                        }
                        
                        products.push(product);
                    } catch (error) {
                        console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–æ–≤–∞—Ä–∞ ${id}:`, error);
                    }
                }
            });
            
            return products;
        }

        // ===== –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –û–ë–†–ê–©–ï–ù–ò–Ø–ú–ò =====

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏–π
        let currentAppealsFilter = 'new';
        let lastViewedAppealId = 0;

        // –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π
        function loadAppeals() {
            console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π...');
            
            // –ü–æ–ª—É—á–∞–µ–º –æ–±—Ä–∞—â–µ–Ω–∏—è –∏–∑ localStorage
            const appeals = JSON.parse(localStorage.getItem('contactForms') || '[]');
            
            // –†–∞–∑–¥–µ–ª—è–µ–º –Ω–∞ –Ω–æ–≤—ã–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ
            const newAppeals = appeals.filter(appeal => !appeal.status || appeal.status === 'new');
            const processedAppeals = appeals.filter(appeal => appeal.status === 'processed');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
            document.getElementById('newCount').textContent = newAppeals.length;
            document.getElementById('processedCount').textContent = processedAppeals.length;
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ–±—Ä–∞—â–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
            renderAppeals();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            updateAppealsNotifications();
            
            console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–π: ${appeals.length} (–Ω–æ–≤—ã—Ö: ${newAppeals.length}, –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö: ${processedAppeals.length})`);
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏–π
        function renderAppeals() {
            console.log('renderAppeals –≤—ã–∑–≤–∞–Ω–∞');
            const appeals = JSON.parse(localStorage.getItem('contactForms') || '[]');
            const appealsList = document.getElementById('appealsList');
            
            if (!appealsList) {
                console.error('appealsList –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏
            appealsList.style.display = 'flex';
            appealsList.style.flexDirection = 'column';
            appealsList.style.gap = '20px';
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –æ–±—Ä–∞—â–µ–Ω–∏—è –ø–æ —Ç–µ–∫—É—â–µ–º—É —Ñ–∏–ª—å—Ç—Ä—É
            let filteredAppeals = appeals;
            if (currentAppealsFilter === 'new') {
                filteredAppeals = appeals.filter(appeal => !appeal.status || appeal.status === 'new');
            } else if (currentAppealsFilter === 'processed') {
                filteredAppeals = appeals.filter(appeal => appeal.status === 'processed');
            }
            
            if (filteredAppeals.length === 0) {
                const statusText = currentAppealsFilter === 'new' ? '–ù–æ–≤—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç' : '–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç';
                appealsList.innerHTML = `<div class="no-appeals">${statusText}</div>`;
                return;
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)
            filteredAppeals.sort((a, b) => new Date(b.timestamp || b.date) - new Date(a.timestamp || a.date));
            
            appealsList.innerHTML = filteredAppeals.map(appeal => `
                <div class="appeal-item" data-appeal-id="${appeal.id}" style="background: #333; border-radius: 8px; padding: 20px; border-left: 4px solid #007bff; margin-bottom: 20px;">
                    <div class="appeal-header" style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                        <div class="appeal-info" style="flex: 1;">
                            <h4 style="color: #ffffff; margin-bottom: 5px; font-size: 18px;">–û–±—Ä–∞—â–µ–Ω–∏–µ #${appeal.id}</h4>
                            <p style="color: #cccccc; margin: 3px 0; font-size: 14px;">–û—Ç: ${appeal.name} ${appeal.surname}</p>
                            <p style="color: #cccccc; margin: 3px 0; font-size: 14px;">Email: ${appeal.email}</p>
                            <p style="color: #cccccc; margin: 3px 0; font-size: 14px;">–¢–µ–º–∞: ${appeal.topic}</p>
                            <p style="color: #cccccc; margin: 3px 0; font-size: 14px;">–î–∞—Ç–∞: ${new Date(appeal.timestamp || appeal.date).toLocaleString('ru-RU')}</p>
                        </div>
                        <div class="appeal-status-controls" style="display: flex; flex-direction: column; gap: 10px; align-items: flex-end;">
                            <select class="status-select" onchange="updateAppealStatus(${appeal.id}, this.value)">
                                <option value="new" ${(!appeal.status || appeal.status === 'new') ? 'selected' : ''}>–ù–æ–≤—ã–µ –∑–∞—è–≤–∫–∏</option>
                                <option value="processed" ${appeal.status === 'processed' ? 'selected' : ''}>–û–±—Ä–∞–±–æ—Ç–∞–Ω</option>
                            </select>
                        </div>
                    </div>
                    <div class="appeal-message" style="background: #444; border: 1px solid #555; border-radius: 5px; padding: 15px; color: #cccccc; font-size: 14px; line-height: 1.5; margin-top: 15px;">${appeal.message}</div>
                </div>
            `).join('');
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π
        function filterAppeals(filter) {
            currentAppealsFilter = filter;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É —Ñ–∏–ª—å—Ç—Ä–∞
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è
            renderAppeals();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è
        function updateAppealStatus(appealId, newStatus) {
            console.log(`–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è ${appealId} –Ω–∞ ${newStatus}`);
            
            const appeals = JSON.parse(localStorage.getItem('contactForms') || '[]');
            const appealIndex = appeals.findIndex(appeal => appeal.id === appealId);
            
            if (appealIndex !== -1) {
                appeals[appealIndex].status = newStatus;
                appeals[appealIndex].processedDate = newStatus === 'processed' ? new Date().toISOString() : null;
                
                localStorage.setItem('contactForms', JSON.stringify(appeals));
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –æ–±—Ä–∞—â–µ–Ω–∏—è
                loadAppeals();
                
                console.log(`–°—Ç–∞—Ç—É—Å –æ–±—Ä–∞—â–µ–Ω–∏—è ${appealId} –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ ${newStatus}`);
            } else {
                console.error(`–û–±—Ä–∞—â–µ–Ω–∏–µ —Å ID ${appealId} –Ω–µ –Ω–∞–π–¥–µ–Ω–æ`);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–æ–≤—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏—è—Ö
        function updateAppealsNotifications() {
            const appeals = JSON.parse(localStorage.getItem('contactForms') || '[]');
            const newAppeals = appeals.filter(appeal => !appeal.status || appeal.status === 'new');
            
            const notificationBadge = document.getElementById('appealsNotification');
            
            if (newAppeals.length > 0) {
                // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π ID —Å—Ä–µ–¥–∏ –Ω–æ–≤—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π
                const maxAppealId = Math.max(...newAppeals.map(appeal => appeal.id));
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–≤—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
                if (maxAppealId > lastViewedAppealId) {
                    notificationBadge.textContent = newAppeals.length;
                    notificationBadge.style.display = 'inline-block';
                } else {
                    notificationBadge.style.display = 'none';
                }
            } else {
                notificationBadge.style.display = 'none';
            }
        }

        // –°–∫—Ä—ã—Ç–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –æ–±—Ä–∞—â–µ–Ω–∏—è—Ö
        function hideAppealsNotification() {
            const notificationBadge = document.getElementById('appealsNotification');
            notificationBadge.style.display = 'none';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –æ–±—Ä–∞—â–µ–Ω–∏–µ
            const appeals = JSON.parse(localStorage.getItem('contactForms') || '[]');
            if (appeals.length > 0) {
                const maxAppealId = Math.max(...appeals.map(appeal => appeal.id));
                localStorage.setItem('lastViewedAppealId', maxAppealId);
                lastViewedAppealId = maxAppealId;
                console.log(`–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ, –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –æ–±—Ä–∞—â–µ–Ω–∏–µ: ${maxAppealId}`);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –æ–±—Ä–∞—â–µ–Ω–∏—è—Ö
        function initAppealsNotifications() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π ID
            lastViewedAppealId = parseInt(localStorage.getItem('lastViewedAppealId')) || 0;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            updateAppealsNotifications();
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏–π
            setTimeout(() => {
                const appealsList = document.getElementById('appealsList');
                if (appealsList) {
                    appealsList.style.display = 'flex';
                    appealsList.style.flexDirection = 'column';
                    appealsList.style.gap = '20px';
                }
            }, 100);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(updateAppealsNotifications, 30000);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –æ–±—Ä–∞—â–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function initAppeals() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –æ–±—Ä–∞—â–µ–Ω–∏–π...');
            loadAppeals();
            initAppealsNotifications();
        }

        // ===== –°–ò–°–¢–ï–ú–ê –û–¢–ß–ï–¢–û–í =====
        
        let currentReportsFilter = '1'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 1 –¥–µ–Ω—å

        // –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç—á–µ—Ç–æ–≤
        function loadReports() {
            console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç—á–µ—Ç–æ–≤...');
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            console.log('–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤:', orders.length);
            
            const filteredOrders = filterOrdersByDate(orders, currentReportsFilter);
            console.log('–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤:', filteredOrders.length);
            
            renderReportsTable(filteredOrders);
            renderReportsSummary(filteredOrders);
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ –¥–∞—Ç–µ
        function filterOrdersByDate(orders, days) {
            const now = new Date();
            const filterDate = new Date(now.getTime() - (days * 24 * 60 * 60 * 1000));
            
            return orders.filter(order => {
                const orderDate = new Date(order.date);
                return orderDate >= filterDate;
            });
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
        function filterReports(days) {
            currentReportsFilter = days;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É —Ñ–∏–ª—å—Ç—Ä–∞
            document.querySelectorAll('.reports-filters .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${days}"]`).classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
            loadReports();
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–∞–±–ª–∏—Ü—ã –æ—Ç—á–µ—Ç–æ–≤
        function renderReportsTable(orders) {
            console.log('üîÑ renderReportsTable –≤—ã–∑–≤–∞–Ω–∞ —Å', orders.length, '–∑–∞–∫–∞–∑–∞–º–∏');
            console.log('üìä –î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–æ–≤:', orders);
            
            const tbody = document.getElementById('reportsTableBody');
            if (!tbody) {
                console.error('‚ùå reportsTableBody –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }

            if (orders.length === 0) {
                tbody.innerHTML = '<tr><td colspan="10" style="text-align: center; padding: 40px; color: #888;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</td></tr>';
                console.log('‚ÑπÔ∏è –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è');
                return;
            }

            // –ü–æ–ª—É—á–∞–µ–º –∞—Ä—Ç–∏–∫—É–ª: –∏–∑ item.article, –∏–Ω–∞—á–µ –∏–∑ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–∞
            function resolveArticle(item) {
                if (item.article) return item.article;
                try {
                    const prodRaw = localStorage.getItem(`product_${item.id}`);
                    if (prodRaw) {
                        const prod = JSON.parse(prodRaw);
                        return prod.article || '';
                    }
                } catch (e) {}
                return '';
            }

            tbody.innerHTML = orders.map((order, orderIndex) => {
                    const customerName = order.userProfile ? 
                        `${order.userProfile.lastName || ''} ${order.userProfile.firstName || ''} ${order.userProfile.middleName || ''}`.trim() : 
                        '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    
                    const customerEmail = order.userEmail || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                
                // –ë–µ—Ä–µ–º —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏–∑ –∑–∞–∫–∞–∑–∞
                    let deliveryCost = (typeof order.shipping === 'number' ? order.shipping : (typeof order.deliveryPrice === 'number' ? order.deliveryPrice : order.deliveryCost));
                    if (typeof deliveryCost !== 'number') {
                        const itemsTotal = order.items.reduce((sum, it) => sum + (it.price * it.quantity), 0);
                        if (typeof order.total === 'number') {
                            const diff = order.total - itemsTotal;
                            deliveryCost = diff > 0 ? diff : 0;
                        } else {
                            deliveryCost = 0;
                        }
                    }
                
                // –†–∞—Å—á–µ—Ç —Å–∫–∏–¥–∫–∏ –∏ –∏—Ç–æ–≥–æ–≤–æ–π —Ü–µ–Ω—ã
                const itemsTotal = order.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                let discount = 0;
                let discountText = '–ù–µ—Ç';
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã
                let productDiscounts = 0;
                const productDiscountItems = [];
                
                order.items.forEach(item => {
                    const discounts = JSON.parse(localStorage.getItem('discounts') || '[]');
                    const activeDiscount = discounts.find(discount => 
                        discount.productId === item.id.toString() && 
                        new Date(discount.startDate) <= new Date(order.date) && 
                        new Date(discount.endDate) >= new Date(order.date)
                    );
                    
                    if (activeDiscount) {
                        let itemDiscount = 0;
                        if (activeDiscount.type === 'percentage') {
                            itemDiscount = Math.round(item.price * (activeDiscount.value / 100) * item.quantity);
                        } else {
                            itemDiscount = Math.min(activeDiscount.value * item.quantity, item.price * item.quantity);
                        }
                        productDiscounts += itemDiscount;
                        productDiscountItems.push(`${item.name} (-${itemDiscount.toLocaleString()} ‚ÇΩ)`);
                    }
                });
                
                // –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ —Å–∫–∏–¥–∫—É
                if (order.promoCode && order.discount !== undefined) {
                    discount += order.discount;
                    if (order.discountType === 'percent') {
                        discountText = `${order.promoCode} (-${order.discount}%)`;
                    } else {
                        discountText = `${order.promoCode} (-${order.discount.toLocaleString()} ‚ÇΩ)`;
                    }
                } else if (order.promoCode) {
                    // –ï—Å–ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥ –µ—Å—Ç—å, –Ω–æ —Å–∫–∏–¥–∫–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–æ–¥
                    discountText = order.promoCode;
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã –∫ –æ–±—â–µ–π —Å–∫–∏–¥–∫–µ
                discount += productDiscounts;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å–∫–∏–¥–∫–∏, –µ—Å–ª–∏ –µ—Å—Ç—å —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã
                if (productDiscountItems.length > 0) {
                    if (discountText === '–ù–µ—Ç') {
                        discountText = productDiscountItems.join(', ');
                    } else {
                        discountText += ', ' + productDiscountItems.join(', ');
                    }
                }
                
                // –ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —Å–∫–∏–¥–æ–∫ (–∫–∞–∫ –≤ –∫–æ—Ä–∑–∏–Ω–µ)
                const totalOrderPrice = itemsTotal + deliveryCost - discount;
                
                // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ
                const totalQuantity = order.items.reduce((sum, item) => sum + item.quantity, 0);
                
                // –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ
                const itemsList = order.items.map(item => {
                    const article = resolveArticle(item) || '–ù–µ —É–∫–∞–∑–∞–Ω';
                    return `${item.name} (${article}) - ${item.quantity} —à—Ç.`;
                }).join('<br>');

                    return `
                        <tr>
                            <td>${new Date(order.date).toLocaleDateString('ru-RU')}</td>
                        <td>${itemsList}</td>
                        <td>${totalQuantity}</td>
                            <td>${customerName}<br><small class="small">${customerEmail}</small></td>
                            <td class="num">${deliveryCost.toLocaleString('ru-RU')} ‚ÇΩ</td>
                        <td>${discountText}</td>
                        <td class="num">${totalOrderPrice.toLocaleString('ru-RU')} ‚ÇΩ</td>
                        </tr>
                    `;
                }).join('');
            
            console.log('‚úÖ –¢–∞–±–ª–∏—Ü–∞ –æ—Ç—á–µ—Ç–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
            console.log('üìã –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π HTML:', tbody.innerHTML.substring(0, 500) + '...');
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–≤–æ–¥–∫–∏ –æ—Ç—á–µ—Ç–æ–≤
        function renderReportsSummary(orders) {
            const summary = document.getElementById('reportsSummary');
            if (!summary) return;

            const totalOrders = orders.length;
            const totalItems = orders.reduce((sum, order) => sum + order.items.length, 0);
            const totalRevenue = orders.reduce((sum, order) => {
                const itemsTotal = order.items.reduce((itemSum, item) => itemSum + (item.price * item.quantity), 0);
                let deliveryCost = (typeof order.shipping === 'number' ? order.shipping : (typeof order.deliveryPrice === 'number' ? order.deliveryPrice : order.deliveryCost));
                if (typeof deliveryCost !== 'number') {
                    if (typeof order.total === 'number') {
                        const diff = order.total - itemsTotal;
                        deliveryCost = diff > 0 ? diff : 0;
                    } else {
                        deliveryCost = 0;
                    }
                }
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã
                let productDiscounts = 0;
                order.items.forEach(item => {
                    const discounts = JSON.parse(localStorage.getItem('discounts') || '[]');
                    const activeDiscount = discounts.find(discount => 
                        discount.productId === item.id.toString() && 
                        new Date(discount.startDate) <= new Date(order.date) && 
                        new Date(discount.endDate) >= new Date(order.date)
                    );
                    
                    if (activeDiscount) {
                        if (activeDiscount.type === 'percentage') {
                            productDiscounts += Math.round(item.price * (activeDiscount.value / 100) * item.quantity);
                        } else {
                            productDiscounts += Math.min(activeDiscount.value * item.quantity, item.price * item.quantity);
                        }
                    }
                });
                
                // –£—á–∏—Ç—ã–≤–∞–µ–º –≤—Å–µ —Å–∫–∏–¥–∫–∏ –≤ –∏—Ç–æ–≥–æ–≤–æ–π —Å—É–º–º–µ (–ø—Ä–æ–º–æ–∫–æ–¥ + —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã)
                const promoDiscount = order.discount || 0;
                const totalDiscount = promoDiscount + productDiscounts;
                return sum + itemsTotal + deliveryCost - totalDiscount;
            }, 0);

            summary.innerHTML = `
                <h4>–°–≤–æ–¥–∫–∞ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</h4>
                <div class="summary-stats">
                    <div class="summary-stat">
                        <div class="summary-stat-value">${totalOrders}</div>
                        <div class="summary-stat-label">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value">${totalItems}</div>
                        <div class="summary-stat-label">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value">${totalRevenue.toLocaleString()} ‚ÇΩ</div>
                        <div class="summary-stat-label">–ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂</div>
                    </div>
                </div>
            `;
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ HTML —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—á–∞—Ç–∏
        function exportToExcel() {
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const filteredOrders = filterOrdersByDate(orders, currentReportsFilter);
            
            if (filteredOrders.length === 0) {
                alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞');
                return;
            }

            // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è Excel
            const excelData = [];
            
            // –ó–∞–≥–æ–ª–æ–≤–∫–∏
            excelData.push([
                '–î–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏',
                '–¢–æ–≤–∞—Ä—ã –≤ –∑–∞–∫–∞–∑–µ',
                '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ',
                '–§–ò–û –ø–æ–∫—É–ø–∞—Ç–µ–ª—è',
                'Email –ø–æ–∫—É–ø–∞—Ç–µ–ª—è',
                '–î–æ—Å—Ç–∞–≤–∫–∞ (‚ÇΩ)',
                '–ü—Ä–æ–º–æ–∫–æ–¥',
                '–ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ (‚ÇΩ)'
            ]);

            // –î–∞–Ω–Ω—ã–µ
            filteredOrders.forEach(order => {
                    const customerName = order.userProfile ? 
                        `${order.userProfile.lastName || ''} ${order.userProfile.firstName || ''} ${order.userProfile.middleName || ''}`.trim() : 
                        '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    
                    const customerEmail = order.userEmail || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    const deliveryCost = (typeof order.shipping === 'number' ? order.shipping : (typeof order.deliveryPrice === 'number' ? order.deliveryPrice : order.deliveryCost)) || 0;
                
                // –†–∞—Å—á–µ—Ç —Å–∫–∏–¥–∫–∏ –∏ –∏—Ç–æ–≥–æ–≤–æ–π —Ü–µ–Ω—ã
                const itemsTotal = order.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                let discount = 0;
                let discountText = '–ù–µ—Ç';
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã
                let productDiscounts = 0;
                const productDiscountItems = [];
                
                order.items.forEach(item => {
                    const discounts = JSON.parse(localStorage.getItem('discounts') || '[]');
                    const activeDiscount = discounts.find(discount => 
                        discount.productId === item.id.toString() && 
                        new Date(discount.startDate) <= new Date(order.date) && 
                        new Date(discount.endDate) >= new Date(order.date)
                    );
                    
                    if (activeDiscount) {
                        let itemDiscount = 0;
                        if (activeDiscount.type === 'percentage') {
                            itemDiscount = Math.round(item.price * (activeDiscount.value / 100) * item.quantity);
                        } else {
                            itemDiscount = Math.min(activeDiscount.value * item.quantity, item.price * item.quantity);
                        }
                        productDiscounts += itemDiscount;
                        productDiscountItems.push(`${item.name} (-${itemDiscount.toLocaleString()} ‚ÇΩ)`);
                    }
                });
                
                // –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ —Å–∫–∏–¥–∫—É
                if (order.promoCode && order.discount !== undefined) {
                    discount += order.discount;
                    if (order.discountType === 'percent') {
                        discountText = `${order.promoCode} (-${order.discount}%)`;
                    } else {
                        discountText = `${order.promoCode} (-${order.discount.toLocaleString()} ‚ÇΩ)`;
                    }
                } else if (order.promoCode) {
                    // –ï—Å–ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥ –µ—Å—Ç—å, –Ω–æ —Å–∫–∏–¥–∫–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–æ–¥
                    discountText = order.promoCode;
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã –∫ –æ–±—â–µ–π —Å–∫–∏–¥–∫–µ
                discount += productDiscounts;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å–∫–∏–¥–∫–∏, –µ—Å–ª–∏ –µ—Å—Ç—å —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã
                if (productDiscountItems.length > 0) {
                    if (discountText === '–ù–µ—Ç') {
                        discountText = productDiscountItems.join(', ');
                    } else {
                        discountText += ', ' + productDiscountItems.join(', ');
                    }
                }
                
                // –ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —Å–∫–∏–¥–æ–∫ (–∫–∞–∫ –≤ –∫–æ—Ä–∑–∏–Ω–µ)
                const totalOrderPrice = itemsTotal + deliveryCost - discount;
                
                // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ
                const totalQuantity = order.items.reduce((sum, item) => sum + item.quantity, 0);
                
                // –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ
                const itemsList = order.items.map(item => {
                    // –ü–æ–ª—É—á–∞–µ–º –∞—Ä—Ç–∏–∫—É–ª: –∏–∑ item.article, –∏–Ω–∞—á–µ –∏–∑ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–∞
                    let article = item.article || '';
                    if (!article) {
                        try {
                            const prodRaw = localStorage.getItem(`product_${item.id}`);
                            if (prodRaw) {
                                const prod = JSON.parse(prodRaw);
                                article = prod.article || '';
                            }
                        } catch (e) {}
                    }
                    if (!article) article = '–ù–µ —É–∫–∞–∑–∞–Ω';
                    
                    return `${item.name} (${article}) - ${item.quantity} —à—Ç.`;
                }).join('; ');

                    excelData.push([
                        new Date(order.date).toLocaleDateString('ru-RU'),
                    itemsList,
                    totalQuantity,
                        customerName,
                        customerEmail,
                        deliveryCost,
                    discountText,
                    totalOrderPrice
                    ]);
                });

            // –°–æ–∑–¥–∞–µ–º HTML —Ç–∞–±–ª–∏—Ü—É —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–ª—è Excel
            const currentDate = new Date().toLocaleDateString('ru-RU').replace(/\./g, '-');
            const fileName = `–æ—Ç—á–µ—Ç_–ø–æ_–ø—Ä–æ–¥–∞–∂–∞–º_${currentDate}.html`;
            
            // –°–æ–∑–¥–∞–µ–º HTML —Å CSS —Å—Ç–∏–ª—è–º–∏ –¥–ª—è Excel
            const htmlContent = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 20px;
            background: #ffffff;
        }
        
        .print-controls {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .print-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin: 0 10px;
            transition: background 0.3s;
        }
        
        .print-btn:hover {
            background: #0056b3;
        }
        
        .print-btn.secondary {
            background: #6c757d;
        }
        
        .print-btn.secondary:hover {
            background: #545b62;
        }
        
        .report-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .report-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .report-date {
            font-size: 16px;
            color: #666;
        }
        
        .summary-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #e9ecef;
            border-radius: 8px;
        }
        
        .summary-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }
        
        .summary-stats {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }
        
        .summary-stat {
            text-align: center;
            min-width: 120px;
        }
        
        .summary-stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #28a745;
            margin-bottom: 5px;
        }
        
        .summary-stat-label {
            font-size: 14px;
            color: #666;
        }
        
        .table-container {
            overflow-x: auto;
            margin-bottom: 30px;
        }
        
        .reports-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            background: #ffffff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .reports-table th {
            background: #495057;
            color: #ffffff;
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            border: 1px solid #6c757d;
            white-space: nowrap;
        }
        
        .reports-table td {
            padding: 12px;
            border: 1px solid #dee2e6;
            color: #333;
            vertical-align: top;
            background: #ffffff;
            word-wrap: break-word;
            white-space: normal;
        }
        
        .reports-table tbody tr:nth-child(even) td {
            background: #f8f9fa;
        }
        
        .reports-table tbody tr:hover td {
            background: #e9ecef;
        }
        
        .reports-table td.num, .reports-table th.num {
            text-align: right;
            white-space: nowrap;
        }
        
        .reports-table td.small {
            color: #6c757d;
            font-size: 12px;
        }
        
        .date-cell {
            font-weight: 500;
            color: #495057;
        }
        
        .price-cell {
            font-weight: 600;
            color: #28a745;
        }
        
        .discount-cell {
            color: #dc3545;
            font-weight: 500;
        }
        
        .footer {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            text-align: center;
            color: #666;
            font-size: 14px;
        }

        /* ===== –°–¢–ò–õ–ò –î–õ–Ø –†–ê–ó–î–ï–õ–ê –ö–û–ù–¢–ï–ù–¢–ê ===== */
        .content-container {
            background: #2a2a2a;
            border-radius: 10px;
            padding: 20px;
        }

        .content-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .content-header p {
            color: #cccccc;
            font-size: 16px;
            margin-top: 10px;
        }

        .content-filters {
            display: flex !important;
            gap: 10px !important;
            margin-bottom: 80px !important;
            flex-wrap: nowrap !important;
            align-items: center !important;
            justify-content: center !important;
            overflow-x: auto !important;
            padding: 10px 0 !important;
        }

        .content-filters .filter-btn {
            background: #2a2a2a !important;
            border: 2px solid #444 !important;
            color: #ffffff !important;
            padding: 12px 15px !important;
            border-radius: 8px !important;
            cursor: pointer !important;
            font-size: 12px !important;
            font-weight: bold !important;
            transition: all 0.3s ease !important;
            text-transform: uppercase !important;
            letter-spacing: 0.5px !important;
            min-width: 120px !important;
            text-align: center !important;
            white-space: nowrap !important;
            flex-shrink: 0 !important;
        }

        .content-filters .filter-btn:hover {
            background: #333 !important;
            border-color: #666 !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3) !important;
        }

        .content-filters .filter-btn.active {
            background: #000000 !important;
            border-color: #ffffff !important;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3) !important;
        }

        .content-filters .filter-btn:hover {
            background: #333 !important;
            border-color: #666 !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3) !important;
        }

        .content-section {
            background: #333 !important;
            border-radius: 12px !important;
            padding: 40px !important;
            border-left: 4px solid #007bff !important;
            margin-top: 50px !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
        }

        .content-buttons {
            display: flex !important;
            flex-direction: column !important;
            gap: 15px !important;
            margin-top: 50px !important;
            align-items: center !important;
            max-width: 400px !important;
            margin-left: auto !important;
            margin-right: auto !important;
        }

        .content-btn {
            background: #2a2a2a !important;
            color: #ffffff !important;
            border: 2px solid #444 !important;
            padding: 30px 20px !important;
            border-radius: 10px !important;
            cursor: pointer !important;
            font-size: 18px !important;
            font-weight: bold !important;
            transition: all 0.3s ease !important;
            text-transform: uppercase !important;
            letter-spacing: 1px !important;
            min-height: 80px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
            width: 100% !important;
            margin-bottom: 15px !important;
        }

        .content-btn:hover {
            background: #333 !important;
            border-color: #666 !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3) !important;
        }

        .content-btn:active {
            transform: translateY(0) !important;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        @media (max-width: 768px) {
            .content-sections {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .content-section {
                padding: 15px !important;
            }

            .content-btn {
                padding: 20px 25px !important;
                font-size: 16px !important;
                min-height: 60px !important;
            }
        }

        /* ===== –°–¢–ò–õ–ò –î–õ–Ø –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê –ö–û–ù–¢–ï–ù–¢–ê ===== */
        .content-modal {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            background: rgba(0, 0, 0, 0.8) !important;
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
            z-index: 999999 !important;
            animation: contentModalFadeIn 0.3s ease !important;
        }

        .content-modal .modal-content {
            background: white !important;
            border-radius: 10px !important;
            width: 90% !important;
            max-width: 600px !important;
            max-height: 85vh !important;
            overflow-y: auto !important;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3) !important;
            animation: contentModalSlideIn 0.3s ease !important;
            position: relative !important;
            top: 0 !important;
            transform: none !important;
            padding: 0 !important;
        }

        @keyframes contentModalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes contentModalSlideIn {
            from { 
                opacity: 0; 
                transform: scale(0.9) translateY(-20px); 
            }
            to { 
                opacity: 1; 
                transform: scale(1) translateY(0); 
            }
        }

        .content-modal .modal-header {
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            padding: 30px 30px 20px 30px !important;
            border-bottom: 1px solid #e0e0e0 !important;
        }

        .content-modal .modal-header h3 {
            color: #000000 !important;
            margin: 0 !important;
            font-size: 24px !important;
            font-weight: bold !important;
        }

        .content-modal .modal-close {
            background: none !important;
            border: none !important;
            color: #000000 !important;
            font-size: 28px !important;
            cursor: pointer !important;
            padding: 0 !important;
            width: 35px !important;
            height: 35px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            border-radius: 50% !important;
            transition: background 0.3s !important;
        }

        .content-modal .modal-close:hover {
            background: #f0f0f0 !important;
        }

        .content-modal .modal-body {
            padding: 30px !important;
        }

        .content-modal .content-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
        }

        .content-modal .content-info p {
            color: #000000;
            margin: 5px 0;
            font-size: 14px;
        }

        /* –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Å—Ç–∏–ª–∏ - –Ω–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∏–∂–µ */

        .content-modal .image-upload-area {
            border: 2px dashed #e0e0e0;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
            margin-bottom: 15px;
        }

        .content-modal .image-upload-area:hover {
            border-color: #000000;
            background: #f0f0f0;
        }

        .content-modal .upload-placeholder {
            color: #000000;
        }

        .content-modal .upload-icon {
            font-size: 48px;
            display: block;
            margin-bottom: 10px;
        }

        .content-modal .image-preview {
            position: relative;
            margin-top: 15px;
            border-radius: 8px;
            overflow: hidden;
            min-height: 100px;
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
        }

        .content-modal .image-preview img {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
        }

        .content-modal .remove-image {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .content-modal .content-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .content-modal .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .content-modal .form-group label {
            color: #000000;
            font-weight: 500;
            font-size: 14px;
        }

        .content-modal .form-group input,
        .content-modal .form-group textarea {
            background: #ffffff;
            border: 1px solid #e0e0e0;
            color: #000000;
            padding: 12px;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .content-modal .form-group input:focus,
        .content-modal .form-group textarea:focus {
            outline: none;
            border-color: #000000;
        }

        .content-modal .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .content-modal .modal-footer {
            display: flex !important;
            justify-content: center !important;
            gap: 15px !important;
            padding: 20px 30px 30px 30px !important;
            border-top: 1px solid #e0e0e0 !important;
        }

        .content-modal .btn-primary,
        .content-modal .btn-secondary {
            padding: 12px 24px !important;
            border: none !important;
            border-radius: 5px !important;
            font-size: 16px !important;
            font-weight: 500 !important;
            cursor: pointer !important;
            transition: all 0.3s !important;
            text-transform: none !important;
            letter-spacing: normal !important;
        }

        .content-modal .btn-primary {
            background: #000000 !important;
            color: #ffffff !important;
        }

        .content-modal .btn-primary:hover {
            background: #333333 !important;
            transform: none !important;
            box-shadow: none !important;
        }

        .content-modal .btn-secondary {
            background: #ffffff !important;
            color: #000000 !important;
            border: 1px solid #000000 !important;
        }

        .content-modal .btn-secondary:hover {
            background: #f8f9fa !important;
            transform: none !important;
            box-shadow: none !important;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤—ã—à–µ */

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
        @media (max-width: 768px) {
            .content-modal .modal-content {
                width: 95%;
                margin: 10px;
            }

            .content-modal .modal-header,
            .content-modal .modal-body,
            .content-modal .modal-footer {
                padding: 15px;
            }

            .content-modal .modal-footer {
                flex-direction: column;
            }

            .content-modal .btn-primary,
            .content-modal .btn-secondary {
                width: 100%;
            }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—á–∞—Ç–∏ */
        @media print {
            body {
                margin: 0;
                padding: 15px;
                background: white;
            }
            
            .print-controls {
                display: none !important;
            }
            
            .report-header {
                background: white !important;
                border: 2px solid #333;
                margin-bottom: 20px;
            }
            
            .summary-section {
                background: #f0f0f0 !important;
                border: 1px solid #ccc;
                margin-bottom: 20px;
            }
            
            .reports-table {
                box-shadow: none;
                border: 2px solid #333;
            }
            
            .reports-table th {
                background: #333 !important;
                color: white !important;
                border: 1px solid #000;
            }
            
            .reports-table td {
                border: 1px solid #000;
                background: white !important;
            }
            
            .reports-table tbody tr:nth-child(even) td {
                background: #f9f9f9 !important;
            }
            
            .reports-table tbody tr:hover td {
                background: white !important;
            }
            
            .footer {
                background: white !important;
                border: 1px solid #ccc;
                margin-top: 20px;
            }
            
            .price-cell {
                color: #000 !important;
                font-weight: bold;
            }
            
            .discount-cell {
                color: #000 !important;
                font-weight: bold;
            }
            
            .date-cell {
                color: #000 !important;
                font-weight: bold;
            }
            
            /* –†–∞–∑—Ä—ã–≤—ã —Å—Ç—Ä–∞–Ω–∏—Ü */
            .reports-table {
                page-break-inside: auto;
            }
            
            .reports-table tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }
            
            .reports-table thead {
                display: table-header-group;
            }
            
            .reports-table tfoot {
                display: table-footer-group;
            }
        }
    </style>
</head>
<body>
    <div class="print-controls">
        <button class="print-btn" onclick="window.print()">üñ®Ô∏è –ü–µ—á–∞—Ç—å –æ—Ç—á–µ—Ç–∞</button>
        <button class="print-btn secondary" onclick="window.close()">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
        <button class="print-btn secondary" onclick="window.history.back()">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
    </div>
    
    <div class="report-header">
        <div class="report-title">–û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</div>
        <div class="report-date">–ü–µ—Ä–∏–æ–¥: ${getFilterPeriodText()}</div>
    </div>
    
    <div class="summary-section">
        <div class="summary-title">–°–≤–æ–¥–∫–∞ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</div>
        <div class="summary-stats">
            <div class="summary-stat">
                <div class="summary-stat-value">${filteredOrders.length}</div>
                <div class="summary-stat-label">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</div>
            </div>
            <div class="summary-stat">
                <div class="summary-stat-value">${filteredOrders.reduce((sum, order) => sum + order.items.reduce((itemSum, item) => itemSum + item.quantity, 0), 0)}</div>
                <div class="summary-stat-label">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</div>
            </div>
            <div class="summary-stat">
                <div class="summary-stat-value">${filteredOrders.reduce((sum, order) => {
                    const itemsTotal = order.items.reduce((itemSum, item) => itemSum + (item.price * item.quantity), 0);
                    let deliveryCost = (typeof order.shipping === 'number' ? order.shipping : (typeof order.deliveryPrice === 'number' ? order.deliveryPrice : order.deliveryCost)) || 0;
                    const discount = order.discount || 0;
                    return sum + itemsTotal + deliveryCost - discount;
                }, 0).toLocaleString()} ‚ÇΩ</div>
                <div class="summary-stat-label">–ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂</div>
            </div>
        </div>
    </div>
    
    <div class="table-container">
        <table class="reports-table">
            <thead>
                <tr>
                    <th>–î–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏</th>
                    <th>–¢–æ–≤–∞—Ä—ã –≤ –∑–∞–∫–∞–∑–µ</th>
                    <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                    <th>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å</th>
                    <th class="num">–î–æ—Å—Ç–∞–≤–∫–∞ (‚ÇΩ)</th>
                    <th>–ü—Ä–æ–º–æ–∫–æ–¥</th>
                    <th class="num">–ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ (‚ÇΩ)</th>
                </tr>
            </thead>
            <tbody>
                ${filteredOrders.map(order => {
                    const customerName = order.userProfile ? 
                        `${order.userProfile.lastName || ''} ${order.userProfile.firstName || ''} ${order.userProfile.middleName || ''}`.trim() : 
                        '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    
                    const customerEmail = order.userEmail || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    const deliveryCost = (typeof order.shipping === 'number' ? order.shipping : (typeof order.deliveryPrice === 'number' ? order.deliveryPrice : order.deliveryCost)) || 0;
                    
                    // –†–∞—Å—á–µ—Ç —Å–∫–∏–¥–∫–∏ –∏ –∏—Ç–æ–≥–æ–≤–æ–π —Ü–µ–Ω—ã
                    const itemsTotal = order.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                    let discount = 0;
                    let discountText = '–ù–µ—Ç';
                    
                    // –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–∫–∏–¥–∫—É
                    if (order.promoCode && order.discount !== undefined) {
                        discount = order.discount;
                        if (order.discountType === 'percent') {
                            discountText = `${order.promoCode} (-${order.discount}%)`;
                        } else {
                            discountText = `${order.promoCode} (-${order.discount.toLocaleString()} ‚ÇΩ)`;
                        }
                    } else if (order.promoCode) {
                        discountText = order.promoCode;
                    }
                    
                    // –ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ —Å —É—á–µ—Ç–æ–º —Å–∫–∏–¥–∫–∏
                    const totalOrderPrice = itemsTotal + deliveryCost - discount;
                    
                    // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ
                    const totalQuantity = order.items.reduce((sum, item) => sum + item.quantity, 0);
                    
                    // –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ
                    const itemsList = order.items.map(item => {
                        let article = item.article || '';
                        if (!article) {
                            try {
                                const prodRaw = localStorage.getItem(`product_${item.id}`);
                                if (prodRaw) {
                                    const prod = JSON.parse(prodRaw);
                                    article = prod.article || '';
                                }
                            } catch (e) {}
                        }
                        if (!article) article = '–ù–µ —É–∫–∞–∑–∞–Ω';
                        
                        return `${item.name} (${article}) - ${item.quantity} —à—Ç.`;
                    }).join('<br>');

                    return `
                        <tr>
                            <td class="date-cell">${new Date(order.date).toLocaleDateString('ru-RU')}</td>
                            <td>${itemsList}</td>
                            <td>${totalQuantity}</td>
                            <td>${customerName}<br><small class="small">${customerEmail}</small></td>
                            <td class="num">${deliveryCost.toLocaleString('ru-RU')} ‚ÇΩ</td>
                            <td class="discount-cell">${discountText}</td>
                            <td class="num price-cell">${totalOrderPrice.toLocaleString('ru-RU')} ‚ÇΩ</td>
                        </tr>
                    `;
                }).join('')}
            </tbody>
        </table>
    </div>
    
    <div class="footer">
        <p>–û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω: ${new Date().toLocaleString('ru-RU')}</p>
        <p>–¶–µ–Ω—Ç—Ä –ö–∏–Ω–æ‚Ñ¢ - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥–∞–∂–∞–º–∏</p>
    </div>
</body>
</html>`;

            // –°–æ–∑–¥–∞–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
            const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8;' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', fileName);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –ø–µ—Ä–∏–æ–¥–∞ —Ñ–∏–ª—å—Ç—Ä–∞
        function getFilterPeriodText() {
            const periods = {
                '1': '1 –¥–µ–Ω—å',
                '7': '–ù–µ–¥–µ–ª—è',
                '30': '–ú–µ—Å—è—Ü',
                '365': '–ì–æ–¥'
            };
            return periods[currentReportsFilter] || '–í—Å–µ –≤—Ä–µ–º—è';
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel —Ñ–æ—Ä–º–∞—Ç (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        function exportToExcelFormat() {
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const filteredOrders = filterOrdersByDate(orders, currentReportsFilter);
            
            if (filteredOrders.length === 0) {
                alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞');
                return;
            }

            // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è Excel —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
            const excelData = [];
            
            // –ó–∞–≥–æ–ª–æ–≤–∫–∏
            excelData.push([
                '–î–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏',
                '–¢–æ–≤–∞—Ä—ã –≤ –∑–∞–∫–∞–∑–µ',
                '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ',
                '–§–ò–û –ø–æ–∫—É–ø–∞—Ç–µ–ª—è',
                'Email –ø–æ–∫—É–ø–∞—Ç–µ–ª—è',
                '–î–æ—Å—Ç–∞–≤–∫–∞ (‚ÇΩ)',
                '–ü—Ä–æ–º–æ–∫–æ–¥',
                '–ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ (‚ÇΩ)'
            ]);

            // –î–∞–Ω–Ω—ã–µ
            filteredOrders.forEach(order => {
                const customerName = order.userProfile ? 
                    `${order.userProfile.lastName || ''} ${order.userProfile.firstName || ''} ${order.userProfile.middleName || ''}`.trim() : 
                    '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                
                const customerEmail = order.userEmail || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                const deliveryCost = (typeof order.shipping === 'number' ? order.shipping : (typeof order.deliveryPrice === 'number' ? order.deliveryPrice : order.deliveryCost)) || 0;
                
                // –†–∞—Å—á–µ—Ç —Å–∫–∏–¥–∫–∏ –∏ –∏—Ç–æ–≥–æ–≤–æ–π —Ü–µ–Ω—ã (–∫–∞–∫ –≤ HTML –≤–µ—Ä—Å–∏–∏)
                const itemsTotal = order.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                let discount = 0;
                let discountText = '–ù–µ—Ç';
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã
                let productDiscounts = 0;
                const productDiscountItems = [];
                
                order.items.forEach(item => {
                    const discounts = JSON.parse(localStorage.getItem('discounts') || '[]');
                    const activeDiscount = discounts.find(discount => 
                        discount.productId === item.id.toString() && 
                        new Date(discount.startDate) <= new Date(order.date) && 
                        new Date(discount.endDate) >= new Date(order.date)
                    );
                    
                    if (activeDiscount) {
                        let itemDiscount = 0;
                        if (activeDiscount.type === 'percentage') {
                            itemDiscount = Math.round(item.price * (activeDiscount.value / 100) * item.quantity);
                        } else {
                            itemDiscount = Math.min(activeDiscount.value * item.quantity, item.price * item.quantity);
                        }
                        productDiscounts += itemDiscount;
                        productDiscountItems.push(`${item.name} (-${itemDiscount.toLocaleString()} ‚ÇΩ)`);
                    }
                });
                
                // –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ —Å–∫–∏–¥–∫—É
                if (order.promoCode && order.discount !== undefined) {
                    discount += order.discount;
                    if (order.discountType === 'percent') {
                        discountText = `${order.promoCode} (-${order.discount}%)`;
                    } else {
                        discountText = `${order.promoCode} (-${order.discount.toLocaleString()} ‚ÇΩ)`;
                    }
                } else if (order.promoCode) {
                    discountText = order.promoCode;
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã –∫ –æ–±—â–µ–π —Å–∫–∏–¥–∫–µ
                discount += productDiscounts;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å–∫–∏–¥–∫–∏, –µ—Å–ª–∏ –µ—Å—Ç—å —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã
                if (productDiscountItems.length > 0) {
                    if (discountText === '–ù–µ—Ç') {
                        discountText = productDiscountItems.join(', ');
                    } else {
                        discountText += ', ' + productDiscountItems.join(', ');
                    }
                }
                
                // –ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —Å–∫–∏–¥–æ–∫
                const totalOrderPrice = itemsTotal + deliveryCost - discount;
                
                // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ
                const totalQuantity = order.items.reduce((sum, item) => sum + item.quantity, 0);
                
                // –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ
                const itemsList = order.items.map(item => {
                    let article = item.article || '';
                    if (!article) {
                        try {
                            const prodRaw = localStorage.getItem(`product_${item.id}`);
                            if (prodRaw) {
                                const prod = JSON.parse(prodRaw);
                                article = prod.article || '';
                            }
                        } catch (e) {}
                    }
                    if (!article) article = '–ù–µ —É–∫–∞–∑–∞–Ω';
                    
                    return `${item.name} (${article}) - ${item.quantity} —à—Ç.`;
                }).join('; ');

                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –¥–ª—è Excel (DD.MM.YYYY)
                const orderDate = new Date(order.date);
                const formattedDate = `${orderDate.getDate().toString().padStart(2, '0')}.${(orderDate.getMonth() + 1).toString().padStart(2, '0')}.${orderDate.getFullYear()}`;

                excelData.push([
                    formattedDate,
                    itemsList,
                    totalQuantity,
                    customerName,
                    customerEmail,
                    deliveryCost,
                    discountText,
                    totalOrderPrice
                ]);
            });

            // –°–æ–∑–¥–∞–µ–º XLSX —Ñ–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
            const currentDate = new Date().toLocaleDateString('ru-RU').replace(/\./g, '-');
            const fileName = `–æ—Ç—á–µ—Ç_–ø–æ_–ø—Ä–æ–¥–∞–∂–∞–º_${currentDate}.xls`;
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–≤–æ–¥–∫—É
            const totalOrders = filteredOrders.length;
            const totalItems = filteredOrders.reduce((sum, order) => sum + order.items.reduce((itemSum, item) => itemSum + item.quantity, 0), 0);
            const totalRevenue = filteredOrders.reduce((sum, order) => {
                const itemsTotal = order.items.reduce((itemSum, item) => itemSum + (item.price * item.quantity), 0);
                let deliveryCost = (typeof order.shipping === 'number' ? order.shipping : (typeof order.deliveryPrice === 'number' ? order.deliveryPrice : order.deliveryCost)) || 0;
                const discount = order.discount || 0;
                return sum + itemsTotal + deliveryCost - discount;
            }, 0);

            // –°–æ–∑–¥–∞–µ–º HTML —Ç–∞–±–ª–∏—Ü—É –¥–ª—è Excel —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
            const htmlContent = `
<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>–û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin-bottom: 20px;
        }
        th {
            background-color: #4472C4;
            color: white;
            font-weight: bold;
            text-align: center;
            padding: 8px;
            border: 1px solid #000000;
        }
        td {
            padding: 6px;
            border: 1px solid #000000;
            text-align: left;
            vertical-align: top;
        }
        .number {
            text-align: right;
            mso-number-format: "#,##0";
        }
        .date {
            text-align: center;
            mso-number-format: "dd.mm.yyyy";
        }
        .currency {
            text-align: right;
            mso-number-format: "#,##0 ‚ÇΩ";
        }
        .summary-table {
            margin-bottom: 30px;
        }
        .summary-table th {
            background-color: #28a745;
            font-size: 14px;
            padding: 10px;
        }
        .summary-table td {
            font-size: 14px;
            padding: 10px;
            font-weight: bold;
        }
        .summary-value {
            text-align: center;
            font-size: 16px;
            color: #28a745;
        }
        .summary-label {
            text-align: center;
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>
    <!-- –°–≤–æ–¥–∫–∞ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º -->
    <table class="summary-table">
        <thead>
            <tr>
                <th colspan="3">–°–í–û–î–ö–ê –ü–û –ü–†–û–î–ê–ñ–ê–ú</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="summary-label">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</td>
                <td class="summary-label">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</td>
                <td class="summary-label">–ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂</td>
            </tr>
            <tr>
                <td class="summary-value">${totalOrders}</td>
                <td class="summary-value">${totalItems}</td>
                <td class="summary-value">${totalRevenue.toLocaleString()} ‚ÇΩ</td>
            </tr>
        </tbody>
    </table>

    <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∑–∞–∫–∞–∑–æ–≤ -->
    <table>
        <thead>
            <tr>
                <th>–î–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏</th>
                <th>–¢–æ–≤–∞—Ä—ã –≤ –∑–∞–∫–∞–∑–µ</th>
                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                <th>–§–ò–û –ø–æ–∫—É–ø–∞—Ç–µ–ª—è</th>
                <th>Email –ø–æ–∫—É–ø–∞—Ç–µ–ª—è</th>
                <th>–î–æ—Å—Ç–∞–≤–∫–∞ (‚ÇΩ)</th>
                <th>–ü—Ä–æ–º–æ–∫–æ–¥</th>
                <th>–ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ (‚ÇΩ)</th>
            </tr>
        </thead>
        <tbody>
            ${excelData.slice(1).map(row => `
                <tr>
                    <td class="date">${row[0]}</td>
                    <td>${row[1]}</td>
                    <td class="number">${row[2]}</td>
                    <td>${row[3]}</td>
                    <td>${row[4]}</td>
                    <td class="currency">${row[5]}</td>
                    <td>${row[6]}</td>
                    <td class="currency">${row[7]}</td>
                </tr>
            `).join('')}
        </tbody>
    </table>
</body>
</html>`;

            // –°–æ–∑–¥–∞–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
            const blob = new Blob([htmlContent], { type: 'application/vnd.ms-excel;charset=utf-8' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', fileName);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –æ—Ç—á–µ—Ç–æ–≤
        function initReports() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –æ—Ç—á–µ—Ç–æ–≤...');
            loadReports();
        }

        // ===== –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ö–û–ù–¢–ï–ù–¢–û–ú =====

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        function openContentModal(page, element) {
            console.log(`–û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è: ${page} - ${element}`);
            
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –µ—Å–ª–∏ –µ—Å—Ç—å
            const oldModal = document.getElementById('contentModal');
            if (oldModal) {
                oldModal.remove();
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Ç–æ–≤–∞—Ä–æ–º –≤ –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è—Ö
            const isNewArrivalsProduct = page === 'new-arrivals' && element.startsWith('product');
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ –æ–ø–∏—Å–∞–Ω–∏—è
            const showTextFields = !(page === 'about' || page === 'help');
            
            let modalHTML;
            
            if (isNewArrivalsProduct) {
                // –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–æ–≤–∞—Ä–æ–≤
                modalHTML = `
                    <div class="content-modal" id="contentModal" style="position: fixed !important; top: 0 !important; left: 0 !important; width: 100vw !important; height: 100vh !important; background: rgba(0, 0, 0, 0.8) !important; display: flex !important; justify-content: center !important; align-items: center !important; z-index: 999999 !important;">
                        <div class="modal-content" style="background: white !important; border-radius: 10px !important; width: 90% !important; max-width: 600px !important; max-height: 85vh !important; overflow-y: auto !important; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3) !important; padding: 0 !important;">
                            <div class="modal-header" style="display: flex !important; justify-content: space-between !important; align-items: center !important; padding: 30px 30px 20px 30px !important; border-bottom: 1px solid #e0e0e0 !important;">
                                <h3 style="color: #000000 !important; margin: 0 !important; font-size: 24px !important; font-weight: bold !important;">–í—ã–±–æ—Ä —Ç–æ–≤–∞—Ä–∞</h3>
                                <button class="modal-close" onclick="closeContentModal()" style="background: none !important; border: none !important; color: #000000 !important; font-size: 28px !important; cursor: pointer !important; padding: 0 !important; width: 35px !important; height: 35px !important; display: flex !important; align-items: center !important; justify-content: center !important; border-radius: 50% !important;">√ó</button>
                            </div>
                            <div class="modal-body" style="padding: 30px !important;">
                                <div class="content-info" style="background: #f8f9fa; border: 1px solid #e0e0e0; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
                                    <p style="color: #000000; font-size: 14px; margin: 5px 0;"><strong>–°—Ç—Ä–∞–Ω–∏—Ü–∞:</strong> ${getPageName(page)}</p>
                                    <p style="color: #000000; font-size: 14px; margin: 5px 0;"><strong>–≠–ª–µ–º–µ–Ω—Ç:</strong> ${getElementName(element)}</p>
                                </div>
                                <div class="content-form">
                                    <div class="form-group" style="margin-bottom: 20px;">
                                        <label style="color: #000000; font-weight: bold; display: block; margin-bottom: 10px;">1. –í–´–ë–û–† –¢–û–í–ê–†–ê:</label>
                                        <select id="productSelect" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 5px; font-size: 16px; background: #ffffff; color: #000000; margin-bottom: 15px;">
                                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä –∏–∑ —Å–ø–∏—Å–∫–∞</option>
                                        </select>
                                    </div>
                                    <div class="product-preview" id="productPreview" style="position: relative; margin-top: 15px; border-radius: 8px; overflow: hidden; min-height: 200px; background: #f8f9fa; border: 1px solid #e0e0e0; padding: 20px; text-align: center;">
                                        <div style="color: #666; font-size: 16px;">
                                            <span style="font-size: 48px; display: block; margin-bottom: 10px;">üì¶</span>
                                            <p>–ü—Ä–µ–≤—å—é —Ç–æ–≤–∞—Ä–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer" style="display: flex !important; justify-content: center !important; gap: 15px !important; padding: 20px 30px 30px 30px !important; border-top: 1px solid #e0e0e0 !important;">
                                <button class="btn-secondary" onclick="closeContentModal()" style="padding: 12px 24px !important; border: 1px solid #000000 !important; border-radius: 5px !important; font-size: 16px !important; font-weight: 500 !important; cursor: pointer !important; background: #ffffff !important; color: #000000 !important;">–û—Ç–º–µ–Ω–∞</button>
                                <button class="btn-primary" onclick="saveProductContent('${page}', '${element}')" style="padding: 12px 24px !important; border: none !important; border-radius: 5px !important; font-size: 16px !important; font-weight: 500 !important; cursor: pointer !important; background: #000000 !important; color: #ffffff !important;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                            </div>
                        </div>
                    </div>
                `;
            } else if (page === 'transitions') {
                // –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
                modalHTML = `
                    <div class="content-modal" id="contentModal" style="position: fixed !important; top: 0 !important; left: 0 !important; width: 100vw !important; height: 100vh !important; background: rgba(0, 0, 0, 0.8) !important; display: flex !important; justify-content: center !important; align-items: center !important; z-index: 999999 !important;">
                        <div class="modal-content" style="background: white !important; border-radius: 10px !important; width: 90% !important; max-width: 600px !important; max-height: 85vh !important; overflow-y: auto !important; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3) !important; padding: 0 !important;">
                            <div class="modal-header" style="display: flex !important; justify-content: space-between !important; align-items: center !important; padding: 30px 30px 20px 30px !important; border-bottom: 1px solid #e0e0e0 !important;">
                                <h3 style="color: #000000 !important; margin: 0 !important; font-size: 24px !important; font-weight: bold !important;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞</h3>
                                <button class="modal-close" onclick="closeContentModal()" style="background: none !important; border: none !important; color: #000000 !important; font-size: 28px !important; cursor: pointer !important; padding: 0 !important; width: 35px !important; height: 35px !important; display: flex !important; align-items: center !important; justify-content: center !important; border-radius: 50% !important;">√ó</button>
                            </div>
                            <div class="modal-body" style="padding: 30px !important;">
                                <div class="content-info" style="background: #f8f9fa; border: 1px solid #e0e0e0; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
                                    <p style="color: #000000; font-size: 14px; margin: 5px 0;"><strong>–°—Ç—Ä–∞–Ω–∏—Ü–∞:</strong> ${getPageName(page)}</p>
                                    <p style="color: #000000; font-size: 14px; margin: 5px 0;"><strong>–≠–ª–µ–º–µ–Ω—Ç:</strong> ${getElementName(element)}</p>
                                </div>
                                <div class="content-form">
                                    <div class="form-group" style="margin-bottom: 20px;">
                                        <label style="color: #000000; font-weight: bold; display: block; margin-bottom: 10px;">1. –ó–ê–ì–†–£–ó–ö–ê –§–û–¢–û:</label>
                                        <div class="image-upload-area" id="contentImageUploadArea" style="border: 2px dashed #e0e0e0; border-radius: 8px; padding: 30px; text-align: center; cursor: pointer; background: #f8f9fa; margin-bottom: 15px;">
                                            <input type="file" id="contentImageUpload" accept="image/*" style="display: none;">
                                            <div class="upload-placeholder" style="color: #000000;">
                                                <span class="upload-icon" style="font-size: 48px; display: block; margin-bottom: 10px;">üì∑</span>
                                                <p>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>
                                                <p style="font-size: 12px; color: #666; margin-top: 10px;">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: ${getRecommendedImageSize(page, element)}</p>
                                            </div>
                                        </div>
                                        <div class="image-preview" id="contentImagePreview" style="position: relative; margin-top: 15px; border-radius: 8px; overflow: hidden; min-height: 100px; background: #f8f9fa; border: 1px solid #e0e0e0;"></div>
                                        <input type="hidden" id="contentImageUrl" name="contentImageUrl">
                                    </div>
                                    <div class="form-group" style="margin-bottom: 20px;">
                                        <label style="color: #000000; font-weight: bold; display: block; margin-bottom: 10px;">2. –û–ì–õ–ê–í–õ–ï–ù–ò–ï:</label>
                                        <input type="text" id="contentTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: TELEGRAM, VK MARKET, –ö–ò–ù–û–®–Å–ü)" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 5px; font-size: 16px; background: #ffffff; color: #000000;">
                                    </div>
                                    <div class="form-group" style="margin-bottom: 20px;">
                                        <label style="color: #000000; font-weight: bold; display: block; margin-bottom: 10px;">3. –°–°–´–õ–ö–ê –î–õ–Ø –ü–ï–†–ï–•–û–î–ê:</label>
                                        <input type="url" id="contentLink" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: https://t.me/example)" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 5px; font-size: 16px; background: #ffffff; color: #000000;">
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer" style="display: flex !important; justify-content: center !important; gap: 15px !important; padding: 20px 30px 30px 30px !important; border-top: 1px solid #e0e0e0 !important;">
                                <button class="btn-secondary" onclick="closeContentModal()" style="padding: 12px 24px !important; border: 1px solid #000000 !important; border-radius: 5px !important; font-size: 16px !important; font-weight: 500 !important; cursor: pointer !important; background: #ffffff !important; color: #000000 !important;">–û—Ç–º–µ–Ω–∞</button>
                                <button class="btn-primary" onclick="saveTransitionsContent('${page}', '${element}')" style="padding: 12px 24px !important; border: none !important; border-radius: 5px !important; font-size: 16px !important; font-weight: 500 !important; cursor: pointer !important; background: #000000 !important; color: #ffffff !important;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                // –û–±—ã—á–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
                modalHTML = `
                    <div class="content-modal" id="contentModal" style="position: fixed !important; top: 0 !important; left: 0 !important; width: 100vw !important; height: 100vh !important; background: rgba(0, 0, 0, 0.8) !important; display: flex !important; justify-content: center !important; align-items: center !important; z-index: 999999 !important;">
                        <div class="modal-content" style="background: white !important; border-radius: 10px !important; width: 90% !important; max-width: 600px !important; max-height: 85vh !important; overflow-y: auto !important; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3) !important; padding: 0 !important;">
                            <div class="modal-header" style="display: flex !important; justify-content: space-between !important; align-items: center !important; padding: 30px 30px 20px 30px !important; border-bottom: 1px solid #e0e0e0 !important;">
                                <h3 style="color: #000000 !important; margin: 0 !important; font-size: 24px !important; font-weight: bold !important;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h3>
                                <button class="modal-close" onclick="closeContentModal()" style="background: none !important; border: none !important; color: #000000 !important; font-size: 28px !important; cursor: pointer !important; padding: 0 !important; width: 35px !important; height: 35px !important; display: flex !important; align-items: center !important; justify-content: center !important; border-radius: 50% !important;">√ó</button>
                            </div>
                            <div class="modal-body" style="padding: 30px !important;">
                                <div class="content-info" style="background: #f8f9fa; border: 1px solid #e0e0e0; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
                                    <p style="color: #000000; font-size: 14px; margin: 5px 0;"><strong>–°—Ç—Ä–∞–Ω–∏—Ü–∞:</strong> ${getPageName(page)}</p>
                                    <p style="color: #000000; font-size: 14px; margin: 5px 0;"><strong>–≠–ª–µ–º–µ–Ω—Ç:</strong> ${getElementName(element)}</p>
                                </div>
                                <div class="content-form">
                                    <div class="form-group" style="margin-bottom: 20px;">
                                        <label style="color: #000000; font-weight: bold; display: block; margin-bottom: 10px;">1. –ó–ê–ì–†–£–ó–ö–ê –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø:</label>
                                        <div class="image-upload-area" id="contentImageUploadArea" style="border: 2px dashed #e0e0e0; border-radius: 8px; padding: 30px; text-align: center; cursor: pointer; background: #f8f9fa; margin-bottom: 15px;">
                                            <input type="file" id="contentImageUpload" accept="image/*" style="display: none;">
                                            <div class="upload-placeholder" style="color: #000000;">
                                                <span class="upload-icon" style="font-size: 48px; display: block; margin-bottom: 10px;">üì∑</span>
                                                <p>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>
                                                <p style="font-size: 12px; color: #666; margin-top: 10px;">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: ${getRecommendedImageSize(page, element)}</p>
                                            </div>
                                        </div>
                                        <div class="image-preview" id="contentImagePreview" style="position: relative; margin-top: 15px; border-radius: 8px; overflow: hidden; min-height: 100px; background: #f8f9fa; border: 1px solid #e0e0e0;"></div>
                                        <input type="hidden" id="contentImageUrl" name="contentImageUrl">
                                    </div>
                                    ${showTextFields ? `
                                    <div class="form-group" style="margin-bottom: 20px;">
                                        <label style="color: #000000; font-weight: bold; display: block; margin-bottom: 10px;">2. –û–ì–õ–ê–í–õ–ï–ù–ò–ï:</label>
                                        <input type="text" id="contentTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 5px; font-size: 16px; background: #ffffff; color: #000000;">
                                    </div>
                                    <div class="form-group" style="margin-bottom: 20px;">
                                        <label style="color: #000000; font-weight: bold; display: block; margin-bottom: 10px;">3. –û–ü–ò–°–ê–ù–ò–ï:</label>
                                        <textarea id="contentDescription" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ" rows="4" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 5px; font-size: 16px; background: #ffffff; color: #000000; resize: vertical; min-height: 100px;"></textarea>
                                    </div>
                                    ` : ''}
                                </div>
                            </div>
                            <div class="modal-footer" style="display: flex !important; justify-content: center !important; gap: 15px !important; padding: 20px 30px 30px 30px !important; border-top: 1px solid #e0e0e0 !important;">
                                <button class="btn-secondary" onclick="closeContentModal()" style="padding: 12px 24px !important; border: 1px solid #000000 !important; border-radius: 5px !important; font-size: 16px !important; font-weight: 500 !important; cursor: pointer !important; background: #ffffff !important; color: #000000 !important;">–û—Ç–º–µ–Ω–∞</button>
                                <button class="btn-primary" onclick="saveContent('${page}', '${element}')" style="padding: 12px 24px !important; border: none !important; border-radius: 5px !important; font-size: 16px !important; font-weight: 500 !important; cursor: pointer !important; background: #000000 !important; color: #ffffff !important;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                            </div>
                        </div>
                    </div>
                `;
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            setupContentImageUpload();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
            loadContentData(page, element);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closeContentModal() {
            const modal = document.getElementById('contentModal');
            if (modal) {
                modal.remove();
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function getPageName(page) {
            const pageNames = {
                'main': '–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞',
                'new-arrivals': '–ù–æ–≤—ã–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è',
                'catalog': '–ö–∞—Ç–∞–ª–æ–≥',
                'about': '–û –Ω–∞—Å',
                'help': '–ü–æ–º–æ—â—å',
                'transitions': '–ü–µ—Ä–µ—Ö–æ–¥—ã'
            };
            return pageNames[page] || page;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function getRecommendedImageSize(page, element) {
            // –ë–∞–Ω–Ω–µ—Ä—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–µ)
            if (page === 'main' && (element === 'banner1' || element === 'banner2' || element === 'banner3')) {
                return '1920√ó1080px';
            }
            
            // –ë–∞–Ω–Ω–µ—Ä—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–û –Ω–∞—Å" (–ø–æ–ª–æ–≤–∏–Ω–∞ —ç–∫—Ä–∞–Ω–∞)
            if (page === 'about' && element === 'banner') {
                return '960√ó1080px';
            }
            
            // –ë–∞–Ω–Ω–µ—Ä—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–ü–æ–º–æ—â—å" (–ø–æ–ª–æ–≤–∏–Ω–∞ —ç–∫—Ä–∞–Ω–∞)
            if (page === 'help' && element === 'banner') {
                return '960√ó1080px';
            }
            
            // –ë–∞–Ω–Ω–µ—Ä –∫–∞—Ç–∞–ª–æ–≥–∞
            if (page === 'catalog' && element === 'hero') {
                return '1920√ó1080px';
            }
            
            // –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ (–ø–µ—Ä–µ—Ö–æ–¥—ã)
            if (page === 'transitions' && (element === 'block1' || element === 'block2' || element === 'block3')) {
                return '466√ó400px';
            }
            
            // –ë–∞–Ω–Ω–µ—Ä 4 (–Ω–∏–∂–Ω–∏–π –±–ª–æ–∫)
            if (page === 'main' && element === 'banner4') {
                return '1920√ó1080px';
            }
            
            // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
            return '1920√ó1080px';
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞
        function getElementName(element) {
            const elementNames = {
                'banner1': '–ë–∞–Ω–Ω–µ—Ä 1',
                'banner2': '–ë–∞–Ω–Ω–µ—Ä 2',
                'banner3': '–ë–∞–Ω–Ω–µ—Ä 3',
                'banner4': '–ë–∞–Ω–Ω–µ—Ä 4 (–ù–∏–∂–Ω–∏–π)',
                'banner': '–ë–∞–Ω–Ω–µ—Ä',
                'hero': '–ë–∞–Ω–Ω–µ—Ä –∫–∞—Ç–∞–ª–æ–≥–∞',
                'block1': '–ë–ª–æ–∫ 1',
                'block2': '–ë–ª–æ–∫ 2',
                'block3': '–ë–ª–æ–∫ 3',
                'product1': '–¢–æ–≤–∞—Ä 1',
                'product2': '–¢–æ–≤–∞—Ä 2',
                'product3': '–¢–æ–≤–∞—Ä 3',
                'product4': '–¢–æ–≤–∞—Ä 4'
            };
            return elementNames[element] || element;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫
        function loadProductSelect() {
            const productSelect = document.getElementById('productSelect');
            if (!productSelect) return;

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
            updateProductsForSelection();

            // –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ localStorage
            const products = JSON.parse(localStorage.getItem('products') || '[]');
            console.log('–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤:', products.length);
            
            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
            productSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä –∏–∑ —Å–ø–∏—Å–∫–∞</option>';
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä—ã –≤ —Å–ø–∏—Å–æ–∫
            products.forEach(product => {
                const option = document.createElement('option');
                option.value = product.id;
                option.textContent = `${product.name} (${product.price} ‚ÇΩ)`;
                productSelect.appendChild(option);
            });

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è
            productSelect.addEventListener('change', function() {
                const selectedProductId = this.value;
                console.log('–í—ã–±—Ä–∞–Ω —Ç–æ–≤–∞—Ä ID:', selectedProductId);
                if (selectedProductId) {
                    showProductPreview(selectedProductId);
                } else {
                    clearProductPreview();
                }
            });
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–≤—å—é —Ç–æ–≤–∞—Ä–∞
        function showProductPreview(productId) {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–µ—Ä–µ–¥ –ø–æ–∏—Å–∫–æ–º
            updateProductsForSelection();
            
            const products = JSON.parse(localStorage.getItem('products') || '[]');
            console.log('–ò—â–µ–º —Ç–æ–≤–∞—Ä —Å ID:', productId, '–≤ —Å–ø–∏—Å–∫–µ –∏–∑', products.length, '—Ç–æ–≤–∞—Ä–æ–≤');
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º productId –≤ —á–∏—Å–ª–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            const numericId = parseInt(productId);
            const product = products.find(p => p.id === numericId);
            
            console.log('–ù–∞–π–¥–µ–Ω —Ç–æ–≤–∞—Ä:', product);
            
            const previewContainer = document.getElementById('productPreview');
            
            if (!product || !previewContainer) {
                console.error('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }

            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ –∑–∞–≥–ª—É—à–∫—É
            const imageUrl = product.images && product.images.length > 0 && product.images[0] ? product.images[0] : 'placeholder.jpg';
            
            previewContainer.innerHTML = `
                <div style="background: white; border-radius: 8px; padding: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="text-align: center; margin-bottom: 15px;">
                        <img src="${imageUrl}" alt="${product.name}" style="width: 100%; max-width: 200px; height: 150px; object-fit: cover; border-radius: 8px; border: 1px solid #e0e0e0;">
                    </div>
                    <h4 style="color: #000; font-size: 18px; font-weight: bold; margin: 0 0 10px 0; text-align: center;">${product.name}</h4>
                    <p style="color: #e74c3c; font-size: 20px; font-weight: bold; text-align: center; margin: 0;">${product.price.toLocaleString()} ‚ÇΩ</p>
                </div>
            `;
        }

        // –û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–µ–≤—å—é —Ç–æ–≤–∞—Ä–∞
        function clearProductPreview() {
            const previewContainer = document.getElementById('productPreview');
            if (previewContainer) {
                previewContainer.innerHTML = `
                    <div style="color: #666; font-size: 16px;">
                        <span style="font-size: 48px; display: block; margin-bottom: 10px;">üì¶</span>
                        <p>–ü—Ä–µ–≤—å—é —Ç–æ–≤–∞—Ä–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞</p>
                    </div>
                `;
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
        function saveProductContent(page, element) {
            const productSelect = document.getElementById('productSelect');
            const selectedProductId = productSelect ? productSelect.value : '';
            
            if (!selectedProductId) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä');
                return;
            }

            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–µ
            const products = JSON.parse(localStorage.getItem('products') || '[]');
            console.log('–ò—â–µ–º —Ç–æ–≤–∞—Ä –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è, ID:', selectedProductId);
            console.log('–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã:', products.length);
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º productId –≤ —á–∏—Å–ª–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            const numericId = parseInt(selectedProductId);
            const selectedProduct = products.find(p => p.id === numericId);
            
            console.log('–ù–∞–π–¥–µ–Ω —Ç–æ–≤–∞—Ä –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', selectedProduct);
            
            if (!selectedProduct) {
                console.error('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ');
                alert('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }

            // –ü–†–û–°–¢–û–ï –°–û–•–†–ê–ù–ï–ù–ò–ï - —Ç–æ–ª—å–∫–æ ID —Ç–æ–≤–∞—Ä–∞ –≤ pageContent
            const pageContent = JSON.parse(localStorage.getItem('pageContent') || '{}');
            if (!pageContent.newArrivals) {
                pageContent.newArrivals = {};
            }
            pageContent.newArrivals[element] = selectedProductId;
            localStorage.setItem('pageContent', JSON.stringify(pageContent));
            
            console.log(`‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω —Ç–æ–≤–∞—Ä ${selectedProductId} –¥–ª—è ${element}`);
            console.log('üìä –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π pageContent:', pageContent);
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeContentModal();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Ç–æ–≤–∞—Ä–µ
        function loadProductData(page, element) {
            const pageContent = JSON.parse(localStorage.getItem('pageContent') || '{}');
            const newArrivals = pageContent.newArrivals || {};
            const productId = newArrivals[element];
            
            console.log('–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞ –¥–ª—è', element, ':', productId);
            
            if (productId) {
                const productSelect = document.getElementById('productSelect');
                if (productSelect) {
                    productSelect.value = productId;
                    showProductPreview(productId);
                }
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö
        function updateProductsForSelection() {
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ localStorage
            const products = [];
            const productIds = JSON.parse(localStorage.getItem('productIds') || '[]');
            
            productIds.forEach(id => {
                const productData = localStorage.getItem(`product_${id}`);
                if (productData) {
                    try {
                        products.push(JSON.parse(productData));
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ —Ç–æ–≤–∞—Ä–∞:', error);
                    }
                }
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
            localStorage.setItem('products', JSON.stringify(products));
            console.log('–û–±–Ω–æ–≤–ª–µ–Ω —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞:', products.length, '—Ç–æ–≤–∞—Ä–æ–≤');
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        function setupContentImageUpload() {
            const imageUploadArea = document.getElementById('contentImageUploadArea');
            const imageUpload = document.getElementById('contentImageUpload');

            if (imageUploadArea && imageUpload) {
                imageUploadArea.addEventListener('click', () => imageUpload.click());
                
                imageUpload.addEventListener('change', (e) => {
                    handleContentImage(e.target.files[0]);
                });
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ–∞–π–ª–∞ –≤ base64 –±–µ–∑ —Å–∂–∞—Ç–∏—è
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function() {
                    resolve(reader.result);
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        async function handleContentImage(file) {
            if (file && file.type.startsWith('image/')) {
                try {
                    // –°–∂–∏–º–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –≤—ã—Å–æ–∫–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º –¥–ª—è –±–∞–Ω–Ω–µ—Ä–æ–≤
                    const compressedImageUrl = await compressImage(file, 1920, 0.9);
                    
                    // –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
                    const timestamp = Date.now();
                    const fileName = `content_${timestamp}_${file.name}`;
                    const filePath = `images/${fileName}`;
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ
                    const imageInfo = {
                        path: filePath,
                        name: fileName,
                        size: file.size,
                        type: file.type,
                        timestamp: timestamp,
                        compressedSize: compressedImageUrl.length
                    };
                    localStorage.setItem(`content_image_${timestamp}`, JSON.stringify(imageInfo));
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é
                    const previewContainer = document.getElementById('contentImagePreview');
                    previewContainer.innerHTML = `
                        <img src="${compressedImageUrl}" alt="Content Preview" style="width: 100%; height: 100%; object-fit: cover;">
                        <button type="button" class="remove-image" onclick="removeContentImage()">√ó</button>
                    `;
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ
                    const hiddenImageInput = document.getElementById('contentImageUrl');
                    if (hiddenImageInput) {
                        hiddenImageInput.value = compressedImageUrl;
                        console.log('‚úÖ –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ:', hiddenImageInput.id, '–∑–Ω–∞—á–µ–Ω–∏–µ:', compressedImageUrl.substring(0, 50) + '...');
                    } else {
                        console.error('‚ùå –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ contentImageUrl –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!');
                    }
                    
                    console.log(`‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å–∂–∞—Ç–æ: ${(file.size/1024/1024).toFixed(2)}MB ‚Üí ${(compressedImageUrl.length*0.75/1024/1024).toFixed(2)}MB`);
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞:', error);
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ' + error.message);
                }
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        function removeContentImage() {
            const previewContainer = document.getElementById('contentImagePreview');
            if (previewContainer) {
                previewContainer.innerHTML = '';
            }
            
            const hiddenImageInput = document.getElementById('contentImageUrl');
            if (hiddenImageInput) {
                hiddenImageInput.value = '';
                console.log('‚úÖ –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –æ—á–∏—â–µ–Ω–æ');
            } else {
                console.error('‚ùå –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ contentImageUrl –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏!');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        function loadContentData(page, element) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Ç–æ–≤–∞—Ä–æ–º –≤ –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è—Ö
            const isNewArrivalsProduct = page === 'new-arrivals' && element.startsWith('product');
            
            if (isNewArrivalsProduct) {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤
                loadProductSelect();
                loadProductData(page, element);
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–º
            if (page === 'transitions') {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
                loadTransitionsData(page, element);
                return;
            }
            
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ pageContent –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
            const pageContent = JSON.parse(localStorage.getItem('pageContent') || '{}');
            const contentData = pageContent[page] ? pageContent[page][element] || {} : {};
            
            console.log(`–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è ${page}.${element}:`, contentData);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—Ç (–Ω–µ –¥–ª—è about –∏ help)
            const titleElement = document.getElementById('contentTitle');
            const descriptionElement = document.getElementById('contentDescription');
            
            if (titleElement) {
                titleElement.value = contentData.title || '';
            }
            if (descriptionElement) {
                descriptionElement.value = contentData.description || '';
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å
            if (contentData.image) {
                const previewContainer = document.getElementById('contentImagePreview');
                previewContainer.innerHTML = `
                    <img src="${contentData.image}" alt="Content Preview" style="width: 100%; height: 100%; object-fit: cover;">
                    <button type="button" class="remove-image" onclick="removeContentImage()">√ó</button>
                `;
                
                // –°–æ–∑–¥–∞–µ–º —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                let hiddenImageInput = document.getElementById('contentImageUrl');
                if (!hiddenImageInput) {
                    hiddenImageInput = document.createElement('input');
                    hiddenImageInput.type = 'hidden';
                    hiddenImageInput.id = 'contentImageUrl';
                    document.getElementById('contentModal').appendChild(hiddenImageInput);
                }
                hiddenImageInput.value = contentData.image;
            } else {
                // –û—á–∏—â–∞–µ–º –ø—Ä–µ–≤—å—é –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ—Ç
                const previewContainer = document.getElementById('contentImagePreview');
                previewContainer.innerHTML = '';
                
                // –£–¥–∞–ª—è–µ–º —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –µ—Å–ª–∏ –µ—Å—Ç—å
                const existingInput = document.getElementById('contentImageUrl');
                if (existingInput) {
                    existingInput.remove();
                }
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
        function loadTransitionsData(page, element) {
            const pageContent = JSON.parse(localStorage.getItem('pageContent') || '{}');
            const contentData = pageContent[page] ? pageContent[page][element] || {} : {};
            
            console.log(`–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –¥–ª—è ${page}.${element}:`, contentData);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            const titleElement = document.getElementById('contentTitle');
            if (titleElement) {
                titleElement.value = contentData.title || '';
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Å—ã–ª–∫—É
            const linkElement = document.getElementById('contentLink');
            if (linkElement) {
                linkElement.value = contentData.link || '';
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å
            if (contentData.image) {
                const previewContainer = document.getElementById('contentImagePreview');
                previewContainer.innerHTML = `
                    <img src="${contentData.image}" alt="Content Preview" style="width: 100%; height: 100%; object-fit: cover;">
                    <button type="button" class="remove-image" onclick="removeContentImage()">√ó</button>
                `;
                
                // –°–æ–∑–¥–∞–µ–º —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                let hiddenImageInput = document.getElementById('contentImageUrl');
                if (!hiddenImageInput) {
                    hiddenImageInput = document.createElement('input');
                    hiddenImageInput.type = 'hidden';
                    hiddenImageInput.id = 'contentImageUrl';
                    document.getElementById('contentModal').appendChild(hiddenImageInput);
                }
                hiddenImageInput.value = contentData.image;
            } else {
                // –û—á–∏—â–∞–µ–º –ø—Ä–µ–≤—å—é –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ—Ç
                const previewContainer = document.getElementById('contentImagePreview');
                previewContainer.innerHTML = '';
                
                // –£–¥–∞–ª—è–µ–º —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –µ—Å–ª–∏ –µ—Å—Ç—å
                const existingInput = document.getElementById('contentImageUrl');
                if (existingInput) {
                    existingInput.remove();
                }
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        function saveContent(page, element) {
            console.log('üöÄ –§—É–Ω–∫—Ü–∏—è saveContent –≤—ã–∑–≤–∞–Ω–∞!');
            console.log('–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:', page, element);
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–æ–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ –æ–ø–∏—Å–∞–Ω–∏—è (–¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü about –∏ help –∏—Ö –Ω–µ—Ç)
                const titleElement = document.getElementById('contentTitle');
                const descriptionElement = document.getElementById('contentDescription');
                const title = titleElement ? titleElement.value : '';
                const description = descriptionElement ? descriptionElement.value : '';
                const imageInput = document.getElementById('contentImageUrl');
                const image = imageInput ? imageInput.value : '';
                
                console.log('üîç –û—Ç–ª–∞–¥–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:');
                console.log('- –°—Ç—Ä–∞–Ω–∏—Ü–∞:', page);
                console.log('- –≠–ª–µ–º–µ–Ω—Ç:', element);
                console.log('- –ó–∞–≥–æ–ª–æ–≤–æ–∫:', title);
                console.log('- –û–ø–∏—Å–∞–Ω–∏–µ:', description);
                console.log('- –≠–ª–µ–º–µ–Ω—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω:', !!imageInput);
                console.log('- ID —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', imageInput ? imageInput.id : '–Ω–µ –Ω–∞–π–¥–µ–Ω');
                console.log('- URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', image ? image.substring(0, 50) + '...' : '–ø—É—Å—Ç–æ');
                console.log('- –î–ª–∏–Ω–∞ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', image ? image.length : 0);
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–æ–º–µ—Ä –±–∞–Ω–Ω–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–ª–µ–º–µ–Ω—Ç–∞
            let number = '';
            if (element === 'banner1') number = '001';
            else if (element === 'banner2') number = '002';
            else if (element === 'banner3') number = '003';
            else if (element === 'banner4') number = '004';
            else if (element === 'hero') number = '001'; // –î–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞
            else number = '001'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
            
            const contentData = {
                number: number,
                title: title,
                description: description,
                image: image,
                lastUpdated: new Date().toISOString()
            };

            // –ü–æ–ª—É—á–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ pageContent
            const pageContent = JSON.parse(localStorage.getItem('pageContent') || '{}');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
            if (!pageContent[page]) {
                pageContent[page] = {};
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç–∞
            pageContent[page][element] = contentData;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
            const pageContentString = JSON.stringify(pageContent);
            const dataSizeMB = (pageContentString.length * 2) / 1024 / 1024; // –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞–∑–º–µ—Ä –≤ MB
            
            console.log(`üìä –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${dataSizeMB.toFixed(2)}MB`);
            
            if (dataSizeMB > 5) {
                console.warn('‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–≤—ã—à–∞–µ—Ç 5MB!');
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—Ä–∞—Ç–Ω–æ –≤ localStorage
            try {
                localStorage.setItem('pageContent', pageContentString);
                console.log(`‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω: ${page}.${element}`, contentData);
                console.log('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π pageContent:', pageContent);
            } catch (storageError) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage:', storageError);
                throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.');
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('–ö–æ–Ω—Ç–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeContentModal();
            
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: ' + error.message);
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
        function saveTransitionsContent(page, element) {
            console.log('üöÄ –§—É–Ω–∫—Ü–∏—è saveTransitionsContent –≤—ã–∑–≤–∞–Ω–∞!');
            console.log('–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:', page, element);
            
            try {
                const titleElement = document.getElementById('contentTitle');
                const linkElement = document.getElementById('contentLink');
                const imageInput = document.getElementById('contentImageUrl');
                
                const title = titleElement ? titleElement.value : '';
                const link = linkElement ? linkElement.value : '';
                const image = imageInput ? imageInput.value : '';
                
                console.log('üîç –û—Ç–ª–∞–¥–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤:');
                console.log('- –ó–∞–≥–æ–ª–æ–≤–æ–∫:', title);
                console.log('- –°—Å—ã–ª–∫–∞:', link);
                console.log('- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ:', !!imageInput);
                console.log('- URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', image ? image.substring(0, 50) + '...' : '–ø—É—Å—Ç–æ');
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–æ–º–µ—Ä –±–ª–æ–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–ª–µ–º–µ–Ω—Ç–∞
            let number = '';
            if (element === 'block1') number = '15';
            else if (element === 'block2') number = '16';
            else if (element === 'block3') number = '17';
            else number = '15'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
            
            const contentData = {
                number: number,
                title: title,
                link: link,
                image: image,
                lastUpdated: new Date().toISOString()
            };

            // –ü–æ–ª—É—á–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ pageContent
            const pageContent = JSON.parse(localStorage.getItem('pageContent') || '{}');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
            if (!pageContent[page]) {
                pageContent[page] = {};
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç–∞
            pageContent[page][element] = contentData;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
            const pageContentString = JSON.stringify(pageContent);
            const dataSizeMB = (pageContentString.length * 2) / 1024 / 1024; // –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞–∑–º–µ—Ä –≤ MB
            
            console.log(`üìä –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${dataSizeMB.toFixed(2)}MB`);
            
            if (dataSizeMB > 5) {
                console.warn('‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–≤—ã—à–∞–µ—Ç 5MB!');
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—Ä–∞—Ç–Ω–æ –≤ localStorage
            try {
                localStorage.setItem('pageContent', pageContentString);
                console.log(`‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: ${page}.${element}`, contentData);
                console.log('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π pageContent:', pageContent);
            } catch (storageError) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage:', storageError);
                throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.');
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('–ö–æ–Ω—Ç–µ–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeContentModal();
            
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: ' + error.message);
            }
        }

        // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 6px;
                color: white;
                font-weight: 500;
                z-index: 10000;
                background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#17a2b8'};
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        function filterContent(filter) {
            console.log(`–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞: ${filter}`);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            const contentSections = [
                'mainContent',
                'new-arrivalsContent',
                'catalogContent', 
                'aboutContent',
                'helpContent',
                'transitionsContent'
            ];
            
            contentSections.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.style.display = 'none';
                }
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å–µ–∫—Ü–∏—é
            const targetSection = document.getElementById(`${filter}Content`);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É —Ñ–∏–ª—å—Ç—Ä–∞
            document.querySelectorAll('.content-filters .filter-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.style.background = '#2a2a2a !important';
                btn.style.border = '2px solid #444 !important';
            });
            
            const activeBtn = document.querySelector(`[data-filter="${filter}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
                activeBtn.style.background = '#000000 !important';
                activeBtn.style.border = '2px solid #ffffff !important';
            }
        }

        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ü–†–û–ú–û–ö–û–î–û–í =====

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
        function initPromocodes() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤...');
            loadPromocodes();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
        function loadPromocodes() {
            const promocodes = JSON.parse(localStorage.getItem('promocodes') || '[]');
            renderPromocodesTable(promocodes);
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
        function renderPromocodesTable(promocodes) {
            const tbody = document.getElementById('promocodesTableBody');
            if (!tbody) return;

            tbody.innerHTML = '';

            promocodes.forEach(promocode => {
                const row = document.createElement('tr');
                const isExpired = new Date(promocode.endDate) < new Date();
                const statusClass = isExpired ? 'status-expired' : 'status-active';
                const statusText = isExpired ? '–ò—Å—Ç–µ–∫' : '–ê–∫—Ç–∏–≤–µ–Ω';
                const discountText = promocode.type === 'percentage' ? `${promocode.value}%` : `${promocode.value} ‚ÇΩ`;

                row.innerHTML = `
                    <td><strong>${promocode.code}</strong></td>
                    <td>${promocode.type === 'percentage' ? '–ü—Ä–æ—Ü–µ–Ω—Ç' : '–†—É–±–ª–∏'}</td>
                    <td>${discountText}</td>
                    <td>${formatDate(promocode.startDate)}</td>
                    <td>${formatDate(promocode.endDate)}</td>
                    <td>${promocode.usageCount || 0}</td>
                    <td class="${statusClass}">${statusText}</td>
                    <td>
                        <button class="action-btn delete" onclick="deletePromocode('${promocode.id}')">üóëÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
        function filterPromocodes(filter) {
            const promocodes = JSON.parse(localStorage.getItem('promocodes') || '[]');
            let filteredPromocodes = promocodes;

            if (filter === 'active') {
                filteredPromocodes = promocodes.filter(p => new Date(p.endDate) >= new Date());
            } else if (filter === 'expired') {
                filteredPromocodes = promocodes.filter(p => new Date(p.endDate) < new Date());
            }

            renderPromocodesTable(filteredPromocodes);

            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.querySelectorAll('.promocodes-filters .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è –ø—Ä–æ–º–æ–∫–æ–¥–∞
        function openPromocodeModal(promocodeId = null) {
            const isEdit = promocodeId !== null;
            const promocode = isEdit ? JSON.parse(localStorage.getItem('promocodes') || '[]').find(p => p.id === promocodeId) : null;

            const modalHTML = `
                <div class="modal" id="promocodeModal" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.8); display: flex; justify-content: center; align-items: center; z-index: 9999;">
                    <div class="modal-content" style="background: white; border-radius: 10px; width: 90%; max-width: 500px; padding: 30px;">
                        <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="margin: 0; color: #000;">${isEdit ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥' : '–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥'}</h3>
                            <button onclick="closePromocodeModal()" style="background: none; border: none; font-size: 24px; cursor: pointer;">√ó</button>
                        </div>
                        <form id="promocodeForm">
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; color: #000;">–ö–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞:</label>
                                <input type="text" id="promocodeCode" value="${promocode ? promocode.code : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; text-transform: uppercase;" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; color: #000;">–¢–∏–ø —Å–∫–∏–¥–∫–∏:</label>
                                <select id="promocodeType" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="percentage" ${promocode && promocode.type === 'percentage' ? 'selected' : ''}>–ü—Ä–æ—Ü–µ–Ω—Ç (%)</option>
                                    <option value="fixed" ${promocode && promocode.type === 'fixed' ? 'selected' : ''}>–†—É–±–ª–∏ (‚ÇΩ)</option>
                                </select>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; color: #000;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∏–¥–∫–∏:</label>
                                <input type="number" id="promocodeValue" value="${promocode ? promocode.value : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; color: #000;">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è:</label>
                                <input type="datetime-local" id="promocodeStartDate" value="${promocode ? promocode.startDate.slice(0, 16) : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; color: #000;">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è:</label>
                                <input type="datetime-local" id="promocodeEndDate" value="${promocode ? promocode.endDate.slice(0, 16) : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            </div>
                            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 30px;">
                                <button type="button" onclick="closePromocodeModal()" style="padding: 12px 24px; border: 1px solid #ddd; background: white; border-radius: 5px; cursor: pointer; font-weight: bold;">–û–¢–ú–ï–ù–ê</button>
                                <button type="submit" style="padding: 12px 24px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">–°–û–•–†–ê–ù–ò–¢–¨ –ü–†–û–ú–û–ö–û–î</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHTML);

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã
            document.getElementById('promocodeForm').addEventListener('submit', function(e) {
                e.preventDefault();
                savePromocode(promocodeId);
            });

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –≤ –±–æ–ª—å—à–∏–µ –±—É–∫–≤—ã
            const codeInput = document.getElementById('promocodeCode');
            if (codeInput) {
                codeInput.addEventListener('input', function() {
                    this.value = this.value.toUpperCase();
                });
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
        function savePromocode(promocodeId = null) {
            const isEdit = promocodeId !== null;
            const promocodes = JSON.parse(localStorage.getItem('promocodes') || '[]');

            const promocodeData = {
                id: isEdit ? promocodeId : Date.now().toString(),
                code: document.getElementById('promocodeCode').value.toUpperCase(),
                type: document.getElementById('promocodeType').value,
                value: parseFloat(document.getElementById('promocodeValue').value),
                startDate: document.getElementById('promocodeStartDate').value,
                endDate: document.getElementById('promocodeEndDate').value,
                usageCount: isEdit ? promocodes.find(p => p.id === promocodeId)?.usageCount || 0 : 0,
                createdAt: isEdit ? promocodes.find(p => p.id === promocodeId)?.createdAt : new Date().toISOString()
            };

            if (isEdit) {
                const index = promocodes.findIndex(p => p.id === promocodeId);
                promocodes[index] = promocodeData;
            } else {
                promocodes.push(promocodeData);
            }

            localStorage.setItem('promocodes', JSON.stringify(promocodes));
            closePromocodeModal();
            loadPromocodes();
            showNotification(isEdit ? '–ü—Ä–æ–º–æ–∫–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω!' : '–ü—Ä–æ–º–æ–∫–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω!', 'success');
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
        function editPromocode(promocodeId) {
            openPromocodeModal(promocodeId);
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
        function deletePromocode(promocodeId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥?')) {
                const promocodes = JSON.parse(localStorage.getItem('promocodes') || '[]');
                const filteredPromocodes = promocodes.filter(p => p.id !== promocodeId);
                localStorage.setItem('promocodes', JSON.stringify(filteredPromocodes));
                loadPromocodes();
                showNotification('–ü—Ä–æ–º–æ–∫–æ–¥ —É–¥–∞–ª–µ–Ω!', 'success');
            }
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞
        function closePromocodeModal() {
            const modal = document.getElementById('promocodeModal');
            if (modal) modal.remove();
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–æ–º–æ–∫–æ–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        function createTestPromocode() {
            const testPromocode = {
                id: Date.now().toString(),
                code: 'TEST10',
                type: 'percentage',
                value: 10,
                startDate: new Date().toISOString().slice(0, 16),
                endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().slice(0, 16),
                usageCount: 0,
                createdAt: new Date().toISOString()
            };

            const promocodes = JSON.parse(localStorage.getItem('promocodes') || '[]');
            promocodes.push(testPromocode);
            localStorage.setItem('promocodes', JSON.stringify(promocodes));
            loadPromocodes();
            showNotification('–¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ TEST10 —Å–æ–∑–¥–∞–Ω!', 'success');
        }

        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –°–ö–ò–î–û–ö =====

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —Å–∫–∏–¥–æ–∫
        function initDiscounts() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —Å–∫–∏–¥–æ–∫...');
            loadDiscounts();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫–∏–¥–æ–∫
        function loadDiscounts() {
            const discounts = JSON.parse(localStorage.getItem('discounts') || '[]');
            renderDiscountsTable(discounts);
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–∫–∏–¥–æ–∫
        function renderDiscountsTable(discounts) {
            const tbody = document.getElementById('discountsTableBody');
            if (!tbody) return;

            tbody.innerHTML = '';

            discounts.forEach(discount => {
                const row = document.createElement('tr');
                const isExpired = new Date(discount.endDate) < new Date();
                const statusClass = isExpired ? 'status-expired' : 'status-active';
                const statusText = isExpired ? '–ò—Å—Ç–µ–∫–ª–∞' : '–ê–∫—Ç–∏–≤–Ω–∞';

                // –ü–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
                let productName = '–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω';
                try {
                    const product = JSON.parse(localStorage.getItem(`product_${discount.productId}`));
                    if (product && product.name) {
                        productName = product.name;
                    }
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–æ–≤–∞—Ä–∞:', e);
                }

                const discountText = discount.type === 'percentage' ? `${discount.value}%` : `${discount.value} ‚ÇΩ`;

                row.innerHTML = `
                    <td><strong>${productName}</strong></td>
                    <td>${discount.type === 'percentage' ? '–ü—Ä–æ—Ü–µ–Ω—Ç' : '–†—É–±–ª–∏'}</td>
                    <td>${discountText}</td>
                    <td>${formatDate(discount.startDate)}</td>
                    <td>${formatDate(discount.endDate)}</td>
                    <td class="${statusClass}">${statusText}</td>
                    <td>
                        <button class="action-btn delete" onclick="deleteDiscount('${discount.id}')">üóëÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–∫–∏–¥–æ–∫
        function filterDiscounts(filter) {
            const discounts = JSON.parse(localStorage.getItem('discounts') || '[]');
            let filteredDiscounts = discounts;

            if (filter === 'active') {
                filteredDiscounts = discounts.filter(d => new Date(d.endDate) >= new Date());
            } else if (filter === 'expired') {
                filteredDiscounts = discounts.filter(d => new Date(d.endDate) < new Date());
            }

            renderDiscountsTable(filteredDiscounts);

            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.querySelectorAll('.discounts-filters .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è —Å–∫–∏–¥–∫–∏
        function openDiscountModal(discountId = null) {
            const isEdit = discountId !== null;
            const discount = isEdit ? JSON.parse(localStorage.getItem('discounts') || '[]').find(d => d.id === discountId) : null;

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
            const products = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('product_')) {
                    try {
                        const product = JSON.parse(localStorage.getItem(key));
                        if (product && product.id && product.name) {
                            products.push(product);
                        }
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–æ–≤–∞—Ä–∞:', e);
                    }
                }
            }

            const productOptions = products.map(product => 
                `<option value="${product.id}" ${discount && discount.productId === product.id ? 'selected' : ''}>
                    ${product.name} (ID: ${product.id})
                </option>`
            ).join('');

            const modalHTML = `
                <div class="modal" id="discountModal" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.8); display: flex; justify-content: center; align-items: center; z-index: 9999;">
                    <div class="modal-content" style="background: white; border-radius: 10px; width: 90%; max-width: 500px; padding: 30px;">
                        <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="margin: 0; color: #000;">${isEdit ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫–∏–¥–∫—É' : '–î–æ–±–∞–≤–∏—Ç—å —Å–∫–∏–¥–∫—É'}</h3>
                            <button onclick="closeDiscountModal()" style="background: none; border: none; font-size: 24px; cursor: pointer;">√ó</button>
                        </div>
                        <form id="discountForm">
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; color: #000;">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä:</label>
                                <select id="discountProductId" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä –¥–ª—è —Å–∫–∏–¥–∫–∏</option>
                                    ${productOptions}
                                </select>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; color: #000;">–¢–∏–ø —Å–∫–∏–¥–∫–∏:</label>
                                <select id="discountType" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="percentage" ${discount && discount.type === 'percentage' ? 'selected' : ''}>–ü—Ä–æ—Ü–µ–Ω—Ç (%)</option>
                                    <option value="fixed" ${discount && discount.type === 'fixed' ? 'selected' : ''}>–†—É–±–ª–∏ (‚ÇΩ)</option>
                                </select>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; color: #000;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∏–¥–∫–∏:</label>
                                <input type="number" id="discountValue" value="${discount ? discount.value : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; color: #000;">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è:</label>
                                <input type="datetime-local" id="discountStartDate" value="${discount ? discount.startDate.slice(0, 16) : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; color: #000;">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è:</label>
                                <input type="datetime-local" id="discountEndDate" value="${discount ? discount.endDate.slice(0, 16) : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            </div>
                            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 30px;">
                                <button type="button" onclick="closeDiscountModal()" style="padding: 12px 24px; border: 1px solid #ddd; background: white; border-radius: 5px; cursor: pointer; font-weight: bold;">–û–¢–ú–ï–ù–ê</button>
                                <button type="submit" style="padding: 12px 24px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">–°–û–•–†–ê–ù–ò–¢–¨ –°–ö–ò–î–ö–£</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHTML);

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã
            document.getElementById('discountForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveDiscount(discountId);
            });
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∫–∏–¥–∫–∏
        function saveDiscount(discountId = null) {
            const isEdit = discountId !== null;
            const discounts = JSON.parse(localStorage.getItem('discounts') || '[]');

            const discountData = {
                id: isEdit ? discountId : Date.now().toString(),
                productId: document.getElementById('discountProductId').value,
                type: document.getElementById('discountType').value,
                value: parseFloat(document.getElementById('discountValue').value),
                startDate: document.getElementById('discountStartDate').value,
                endDate: document.getElementById('discountEndDate').value,
                createdAt: isEdit ? discounts.find(d => d.id === discountId)?.createdAt : new Date().toISOString()
            };

            if (isEdit) {
                const index = discounts.findIndex(d => d.id === discountId);
                discounts[index] = discountData;
            } else {
                discounts.push(discountData);
            }

            localStorage.setItem('discounts', JSON.stringify(discounts));
            closeDiscountModal();
            loadDiscounts();
            showNotification(isEdit ? '–°–∫–∏–¥–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!' : '–°–∫–∏–¥–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–∏–¥–∫–∏
        function editDiscount(discountId) {
            openDiscountModal(discountId);
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Å–∫–∏–¥–∫–∏
        function deleteDiscount(discountId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Å–∫–∏–¥–∫—É?')) {
                const discounts = JSON.parse(localStorage.getItem('discounts') || '[]');
                const filteredDiscounts = discounts.filter(d => d.id !== discountId);
                localStorage.setItem('discounts', JSON.stringify(filteredDiscounts));
                loadDiscounts();
                showNotification('–°–∫–∏–¥–∫–∞ —É–¥–∞–ª–µ–Ω–∞!', 'success');
            }
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å–∫–∏–¥–∫–∏
        function closeDiscountModal() {
            const modal = document.getElementById('discountModal');
            if (modal) modal.remove();
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π —Å–∫–∏–¥–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        function createTestDiscount() {
            // –ù–∞—Ö–æ–¥–∏–º –ø–µ—Ä–≤—ã–π —Ç–æ–≤–∞—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–∫–∏–¥–∫–∏
            let firstProduct = null;
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('product_')) {
                    try {
                        const product = JSON.parse(localStorage.getItem(key));
                        if (product && product.id && product.name) {
                            firstProduct = product;
                            break;
                        }
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–æ–≤–∞—Ä–∞:', e);
                    }
                }
            }

            if (!firstProduct) {
                showNotification('–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–∫–∏–¥–∫–∏!', 'error');
                return;
            }

            const testDiscount = {
                id: Date.now().toString(),
                productId: firstProduct.id.toString(),
                type: 'percentage',
                value: 15,
                startDate: new Date().toISOString().slice(0, 16),
                endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().slice(0, 16),
                createdAt: new Date().toISOString()
            };

            const discounts = JSON.parse(localStorage.getItem('discounts') || '[]');
            discounts.push(testDiscount);
            localStorage.setItem('discounts', JSON.stringify(discounts));
            loadDiscounts();
            showNotification(`–¢–µ—Å—Ç–æ–≤–∞—è —Å–∫–∏–¥–∫–∞ 15% —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ "${firstProduct.name}"!`, 'success');
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—Ç—ã
        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('ru-RU', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

    </script>
    <script src="js/supabase-store.js"></script>

    <form id="loginForm">
      <input type="email" id="email" placeholder="email" required>
      <input type="password" id="password" placeholder="–ø–∞—Ä–æ–ª—å" required>
      <button>–í–æ–π—Ç–∏</button>
    </form>
    <button id="logoutBtn" style="display:none">–í—ã–π—Ç–∏</button>

    <input type="text"   id="name"  placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
    <input type="number" id="price" placeholder="–¶–µ–Ω–∞">
    <input type="file"   id="files" accept="image/*" multiple>
    <button id="saveBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä</button>

    <script>
    const $ = (id) => document.getElementById(id);

    async function refreshAuthUI() {
      const u = await Store.currentUser();
      $('loginForm').style.display = u ? 'none' : '';
      $('logoutBtn').style.display = u ? '' : 'none';
    }
    $('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      try { await Store.login($('email').value, $('password').value); await refreshAuthUI(); alert('–í–æ—à—ë–ª'); }
      catch(err){ alert(err.message); }
    });
    $('logoutBtn').addEventListener('click', async () => { await Store.logout(); await refreshAuthUI(); });

    $('saveBtn').addEventListener('click', async () => {
      try {
        const files = $('files').files;
        const urls  = files.length ? await Store.uploadImages(files) : [];
        const product = {
          name:  $('name').value || '–ë–µ–∑ –∏–º–µ–Ω–∏',
          price: Number($('price').value || 0),
          images: urls.length ? urls : [Store.PLACEHOLDER]
        };
        const id = await Store.saveProduct(product);
        alert('–¢–æ–≤–∞—Ä —Å–æ—Ö—Ä–∞–Ω—ë–Ω, id=' + id);
      } catch (e) { alert('–û—à–∏–±–∫–∞: ' + e.message); }
    });

    document.addEventListener('DOMContentLoaded', refreshAuthUI);
    </script>
</body>
</html> 